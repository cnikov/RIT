id,tree
semgrep-unverified-ssl-context-copy,AND(OR(ssl._create_unverified_context(...);ssl._create_default_https_context=ssl._create_unverified_context))
semgrep-javascript-confirm-copy,(confirm(...))
semgrep-eval-detected-copy-javascript,"AND(NOT(eval(""...""));eval(...))"
semgrep-insecure-urlopen-copy,"OR(urllib.request.urlopen(""=~/[Hh][Tt][Tt][Pp]://.*/"",...);$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\nurllib.request.urlopen($URL,...)\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\nurllib.request.urlopen($URL,...)\n)"
semgrep-dangerous-subprocess-use-tainted-env-args-copy,()
semgrep-manual-defaultdict-set-create-copy,"OR($DICT={}\n...\nfor$KEY,$VALUEin$OTHERDICT.items():\n...\nif$KEYnotin$DICT:\n...\n$DICT[$KEY]=set()\n...\n$DICT[$KEY].add(...)\n;$DICT={}\n...\nfor$KEY,$VALUEin$OTHERDICT.items():\n...\n$DICT.setdefault($KEY,set()).add(...)\n)"
semgrep-open-never-closed-copy,AND($F=open(...)\n...\n$F.close()\n;$F=io.open(...)\n...\n$F.close()\n;$F=tarfile.open(...)\n...\n$F.close()\n;$F=ZipFile.open(...)\n...\n$F.close()\n;$F=tempfile.TemporaryFile(...)\n...\n$F.close()\n;$F=tempfile.NamedTemporaryFile(...)\n...\n$F.close()\n;$F=tempfile.SpooledTemporaryFile(...)\n...\n$F.close()\n;$F=open(...)\n...\ntry:\n...\nfinally:\n$F.close()\n;$F=io.open(...)\n...\ntry:\n...\nfinally:\n$F.close()\n;$F=tarfile.open(...)\n...\ntry:\n...\nfinally:\n$F.close()\n;$F=ZipFile.open(...)\n...\ntry:\n...\nfinally:\n$F.close()\n;$F=tempfile.TemporaryFile(...)\n...\ntry:\n...\nfinally:\n$F.close()\n;$F=tempfile.NamedTemporaryFile(...)\n...\ntry:\n...\nfinally:\n$F.close()\n;$F=tempfile.SpooledTemporaryFile(...)\n...\ntry:\n...\nfinally:\n$F.close()\n;OR($F=open(...);$F=io.open(...);$F=tarfile.open(...);$F=ZipFile.open(...);$F=tempfile.TemporaryFile(...);$F=tempfile.NamedTemporaryFile(...);$F=tempfile.SpooledTemporaryFile(...)))
semgrep-tainted-code-exec-copy,()
semgrep-hardcoded-tmp-path-copy,"(open(""=~/^\/tmp.*/"",...))"
semgrep-request-session-http-in-with-context-copy,()
semgrep-avoid-v-html-copy,(r:<[^<>]*v-html=)
semgrep-pass-body-range-copy,(for$Xin$Y:\npass\n)
semgrep-code-string-concat-copy,()
semgrep-insecure-request-object-ftp-copy,"OR(urllib.request.Request(""=~/^[Ff][Tt][Pp]://.*/"",...);$URL=""=~/^[Ff][Tt][Pp]://.*/""\n...\nurllib.request.Request($URL,...)\n;def$FUNC(...,$URL=""=~/^[Ff][Tt][Pp]://.*/"",...):\n...\nurllib.request.Request($URL,...))"
semgrep-detect-replaceall-sanitization-copy,"AND(OR($STR.$FUNC('<';'&lt;');$STR.$FUNC('>';'&gt;');$STR.$FUNC('""';'&quot;');$STR.$FUNC(""'"",'&apos;');$STR.$FUNC('&';'&amp;')))"
semgrep-dom-based-xss-copy,OR(document.write(<...document.location.$W...>);document.write(<...location.$W...>))
semgrep-insecure-urlopener-open-ftp-copy,"OR(urllib.request.URLopener(...).open(""=~/[Ff][Tt][Pp]://.*/"",...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.open(""=~/[Ff][Tt][Pp]://.*/"",...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.open(""=~/[Ff][Tt][Pp]://.*/"",...)..)\n...\n);$OPENERDIRECTOR.open(""=~/[Ff][Tt][Pp]://.*/"",...));AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$URL=""=~/[Ff][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.open($URL,...)\n..\n;$OPENERDIRECTOR=urllib.request.URLopener($URL=""=~/[Ff][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.open($URL,...)\n..)\n...\n);$URL=""=~/[Ff][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.open($URL,...)\n);$URL=""=~/[Ff][Tt][Pp]://.*/""\n...\nurllib.request.URLopener(...).open($URL,...)\n;AND(OR(def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\nurllib.request.URLopener(...).open($URL,...)..\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR.open($URL,...)..\n;def$FUNC(urllib.request.URLopener(...).open($URL,...)..,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR.open($URL,...)..,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n...\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",urllib.request.URLopener(...).open($URL,...)..):\n...\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..):\n...\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",$OPENERDIRECTOR.open($URL,...)..):\n...\n);OR(urllib.request.URLopener(...).open($URL,...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.open($URL,...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.open($URL,...)..)\n...\n);$OPENERDIRECTOR.open($URL,...)))))"
semgrep-pass-body-fn-copy,"AND(def__init__(self,...):\n...\n;class$A:\n...\n;def$X(...):\npass\n)"
semgrep-insecure-createnodesfrommarkup-copy,"AND(OR(createNodesFromMarkup(...);$X.createNodesFromMarkup(...));NOT(createNodesFromMarkup(""..."",...));NOT($X.createNodesFromMarkup(""..."",...)))"
semgrep-detect-non-literal-require-copy-javascript,()
semgrep-tainted-pickle-deserialization-copy,()
semgrep-suppressed-exception-handling-finally-break-copy,AND(OR(try:\n...\nexcept$EXCEPTION:\n...\nfinally:\n...\nbreak\n;try:\n...\nexcept$EXCEPTION:\n...\nfinally:\n...\ncontinue\n;try:\n...\nexcept$EXCEPTION:\n...\nfinally:\n...\nreturn...\n;try:\n...\nreturn...\nfinally:\n...\nreturn...\n))
semgrep-use-defusedcsv-copy,AND(csv.writer(...);NOT(defusedcsv.writer(...)))
semgrep-psycopg-sqli-copy,"AND(OR(AND($CUR.$METHOD(...,$QUERY,...);OR(;;;;);$QUERY+=""...""\n...\n;$QUERY=""...""+""...""\n...\n;$QUERY='...'.format()\n...\n;$QUERY='...'%()\n...\n);$CUR.$METHOD(...,$X+$Y,...);$CUR.$METHOD(...,'...'.format(...),...);$CUR.$METHOD(...,'...'%(...),...);$CUR.$METHOD(...,f'...{$USERINPUT}...';...));OR(;);NOT($CUR.$METHOD(...,""...""+""..."",...));NOT($CUR.$METHOD(...,'...'.format(),...));NOT($CUR.$METHOD(...,'...'%(),...)))"
semgrep-unsafe-dynamic-method-copy,AND(OR($OBJ[$X](...);$Y=$OBJ[$X]\n...\n$Y(...)\n);for(...){...}\n;$SMTH.forEach(...)\n;$SMTH.map(...)\n;$SMTH.reduce(...)\n;$SMTH.reduceRight(...)\n;if(<...$OBJ.hasOwnProperty(...)...>){\n...\n}\n...\n)
semgrep-python-logger-credential-disclosure-copy,"AND($LOGGER_OBJ.$LOGGER_CALL($FORMAT_STRING,...)\n)"
semgrep-disabled-cert-validation-copy,"AND(OR(urllib3.PoolManager(...,cert_reqs=$REQS,...);urllib3.ProxyManager(...,cert_reqs=$REQS,...);urllib3.HTTPSConnectionPool(...,cert_reqs=$REQS,...);urllib3.connectionpool.HTTPSConnectionPool(...,cert_reqs=$REQS,...);urllib3.connection_from_url(...,cert_reqs=$REQS,...);urllib3.proxy_from_url(...,cert_reqs=$REQS,...);$CONTEXT.wrap_socket(...,cert_reqs=$REQS,...);ssl.wrap_socket(...,cert_reqs=$REQS,...)))"
semgrep-insecure-urlretrieve-ftp-copy,"OR(urllib.request.urlretrieve(""=~/^[Ff][Tt][Pp]://.*/"",...);$URL=""=~/^[Ff][Tt][Pp]://.*/""\n...\nurllib.request.urlretrieve($URL,...)\n;def$FUNC(...,$URL=""=~/^[Ff][Tt][Pp]://.*/"",...):\n...\nurllib.request.urlretrieve($URL,...))"
semgrep-unknown-value-with-script-tag-copy,"AND(OR($UNK=$ANYFUNC(...);\n...\n$OTHERFUNC(...,<...$UNK...>,$OTHERFUNC(...,<...""=~/.*<script.*/""...>,...)..);\n;$UNK=$ANYFUNC($OTHERFUNC(...,<...""=~/.*<script.*/""...>,...)..);\n...\n$OTHERFUNC(...,<...$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n$OTHERFUNC(...,<...""=~/.*<script.*/""...>,...)..\n$OTHERFUNC(...,<...$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n...\n$OTHERFUNC($OTHERFUNC(...,<...""=~/.*<script.*/""...>,...)..,<...$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n...\n$OTHERFUNC(...,<$OTHERFUNC(...,<...""=~/.*<script.*/""...>,...)..$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n...\n$OTHERFUNC(...,<...$UNK$OTHERFUNC(...,<...""=~/.*<script.*/""...>,...)..>,...);\n);OR($UNK=$ANYFUNC(...);\n...\n$OTHERFUNC(...,<...$UNK...>,$UNK..);\n;$UNK=$ANYFUNC($UNK..);\n...\n$OTHERFUNC(...,<...$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n$UNK..\n$OTHERFUNC(...,<...$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n...\n$OTHERFUNC($UNK..,<...$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n...\n$OTHERFUNC(...,<$UNK..$UNK...>,...);\n;$UNK=$ANYFUNC(...);\n...\n$OTHERFUNC(...,<...$UNK$UNK..>,...);\n);$OTHERFUNC(...,<...""=~/.*<script.*/""...>,...);$UNK)"
semgrep-sqlalchemy-sql-injection-copy,"AND(OR(def$FUNC(...,$VAR,...):\n...\n$SESSION.query(...).$SQLFUNC(""..."".$FORMATFUNC(...,$VAR,...))\n;def$FUNC(...,$VAR,...):\n...\n$SESSION.query.join(...).$SQLFUNC(""..."".$FORMATFUNC(...,$VAR,...))\n;def$FUNC(...,$VAR,...):\n...\n$SESSION.query.$SQLFUNC(""..."".$FORMATFUNC(...,$VAR,...))\n;def$FUNC(...,$VAR,...):\n...\nquery.$SQLFUNC(""..."".$FORMATFUNC(...,$VAR,...))\n))"
semgrep-insecure-urlopener-retrieve-copy,"OR(urllib.request.URLopener(...).retrieve(""=~/[Hh][Tt][Tt][Pp]://.*/"",...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.retrieve(""=~/[Hh][Tt][Tt][Pp]://.*/"",...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.retrieve(""=~/[Hh][Tt][Tt][Pp]://.*/"",...)..)\n...\n);$OPENERDIRECTOR.retrieve(""=~/[Hh][Tt][Tt][Pp]://.*/"",...));AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.retrieve($URL,...)\n..\n;$OPENERDIRECTOR=urllib.request.URLopener($URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.retrieve($URL,...)\n..)\n...\n);$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.retrieve($URL,...)\n);$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\nurllib.request.URLopener(...).retrieve($URL,...)\n;AND(OR(def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\nurllib.request.URLopener(...).retrieve($URL,...)..\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR.retrieve($URL,...)..\n;def$FUNC(urllib.request.URLopener(...).retrieve($URL,...)..,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR.retrieve($URL,...)..,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",urllib.request.URLopener(...).retrieve($URL,...)..):\n...\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..):\n...\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",$OPENERDIRECTOR.retrieve($URL,...)..):\n...\n);OR(urllib.request.URLopener(...).retrieve($URL,...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.retrieve($URL,...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.retrieve($URL,...)..)\n...\n);$OPENERDIRECTOR.retrieve($URL,...)))))"
semgrep-ssl-wrap-socket-is-deprecated-copy,(ssl.wrap_socket(...))
semgrep-use-defused-xml-copy,(importxml)
semgrep-python.requests.best-practice.use-response-json-shortcut-copy,AND(OR($RESP=requests.$METHOD(json.loads($RESP.text)..);...mportjson;...;$RESP=requests.$METHOD(json.loads($RESP.text)..);...mportjson;...);OR($RESP=requests.$METHOD(json.loads($RESP.text)..);...;$RESP=requests.$METHOD(json.loads($RESP.text)..);...);OR($RESP=requests.$METHOD(json.loads($RESP.text)..);...mportrequests;...;$RESP=requests.$METHOD(json.loads($RESP.text)..);...mportrequests;...);OR($RESP=requests.$METHOD(json.loads($RESP.text)..);...;$RESP=requests.$METHOD(json.loads($RESP.text)..);...);OR($RESP=requests.$METHOD(json.loads($RESP.text)..);...;$RESP=requests.$METHOD(json.loads($RESP.text)..);...);json.loads($RESP.text))
semgrep-wkhtmltopdf-injection-copy,"AND($WK=require('wkhtmltopdf');\nvar$INPUT=""..."";\n...\n..\n;$WK=require('wkhtmltopdf');\n$WK($INPUT,...)..\n;NOT($WK=require('wkhtmltopdf');\n$WK(""..."",...)..\n);var$INPUT=""..."";\n...\n;$WK($INPUT,...);NOT($WK(""..."",...)))"
semgrep-lazy-load-module-copy,AND(require(...);)
semgrep-use-raise-for-status-copy,AND(OR(requests.request(...);requests.get(...);requests.post(...);requests.put(...);requests.delete(...);requests.head(...);requests.patch(...));$RESP=requests.$METHOD(...)\n$RESP.raise_for_status(...)\n;requests.$METHOD(...).raise_for_status(...)\n;$RESP=requests.$METHOD(...)\nif$RESP.status_code==...:\n...\n;$RESP=requests.$METHOD(...)\nif$RESP.status_code!=...:\n...\n;$RESP=requests.$METHOD(...)\n...\nif$RESP.ok:\n...\n;$RESP=requests.$METHOD(...)\n...\nifnot$RESP.ok:\n...\n;with...:\n...\n$RESP=requests.$METHOD(...)\n...\n$RESP.raise_for_status(...)\n;with...as...:\n...\n$RESP=requests.$METHOD(...)\n...\n$RESP.raise_for_status(...)\n)
semgrep-missing-hash-with-eq-copy,"AND(classA(...):\n...\ndef__hash__(self):\n...\n...\ndef__eq__(self,$O):\n...\n;classA(...):\n...\ndef__eq__(self,$O):...\n...\n)"
semgrep-delete-where-no-execute-copy,AND($X.delete().where(...);$X.delete().where(...).execute();$C.execute(...))
semgrep-javascript-prompt-copy,"OR(prompt();prompt($X);prompt($X,$Y))"
semgrep-sqlalchemy-execute-raw-query-copy,"OR($CONNECTION.execute($SQL+...,...)\n;$CONNECTION.execute($SQL%(...),...)\n;$CONNECTION.execute($SQL.format(...),...)\n;$CONNECTION.execute(f""...{...}..."",...)\n;AND(OR($QUERY=$SQL+...\n$CONNECTION.execute($QUERY,...)\n..\n;$QUERY=$SQL+$CONNECTION.execute($QUERY,...)\n..\n...\n);$CONNECTION.execute($QUERY,...)\n);AND(OR($QUERY=$SQL%(...)\n$CONNECTION.execute($QUERY,...)\n..\n;$QUERY=$SQL%($CONNECTION.execute($QUERY,...)\n..)\n...\n);$CONNECTION.execute($QUERY,...)\n);AND(OR($QUERY=$SQL.format(...)\n$CONNECTION.execute($QUERY,...)\n..\n;$QUERY=$SQL.format($CONNECTION.execute($QUERY,...)\n..)\n...\n);$CONNECTION.execute($QUERY,...)\n);AND(OR($QUERY=f""...{...}...""\n$CONNECTION.execute($QUERY,...)\n..\n;$QUERY=f""$CONNECTION.execute($QUERY,...)\n..{...}...""\n...\n;$QUERY=f""...{$CONNECTION.execute($QUERY,...)\n..}...""\n...\n;$QUERY=f""...{...}$CONNECTION.execute($QUERY,...)\n..""\n...\n);$CONNECTION.execute($QUERY,...)\n))"
semgrep-insecure-urlretrieve-copy,"OR(urllib.request.urlretrieve(""=~/[Hh][Tt][Tt][Pp]://.*/"",...);$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\nurllib.request.urlretrieve($URL,...)\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\nurllib.request.urlretrieve($URL,...)\n)"
semgrep-use-timeout-copy,"OR(AND(NOT(requests.$W(...,timeout=$N,...));NOT(requests.$W(...,**$KWARGS));OR(requests.request(...);requests.get(...);requests.post(...);requests.put(...);requests.delete(...);requests.head(...);requests.patch(...)));AND(OR(NOT($SESSION=requests.Session(...)\n$SESSION.$W(...,timeout=$N,...)\n..\n);NOT($SESSION=requests.Session($SESSION.$W(...,timeout=$N,...)\n..)\n...\n));OR(NOT($SESSION=requests.Session(...)\n$SESSION.$W(...,**$KWARGS)\n..\n);NOT($SESSION=requests.Session($SESSION.$W(...,**$KWARGS)\n..)\n...\n));OR($SESSION=requests.Session(...)\n$SESSION.get(...)..\n;$SESSION=requests.Session(...)\n$SESSION.post(...)..\n;$SESSION=requests.Session(...)\n$SESSION.put(...)..\n;$SESSION=requests.Session(...)\n$SESSION.delete(...)..\n;$SESSION=requests.Session(...)\n$SESSION.head(...)..\n;$SESSION=requests.Session(...)\n$SESSION.patch(...)..\n;$SESSION=requests.Session($SESSION.get(...)..)\n...\n;$SESSION=requests.Session($SESSION.post(...)..)\n...\n;$SESSION=requests.Session($SESSION.put(...)..)\n...\n;$SESSION=requests.Session($SESSION.delete(...)..)\n...\n;$SESSION=requests.Session($SESSION.head(...)..)\n...\n;$SESSION=requests.Session($SESSION.patch(...)..)\n...\n);NOT($SESSION.$W(...,timeout=$N,...)\n);NOT($SESSION.$W(...,**$KWARGS)\n);OR($SESSION.get(...);$SESSION.post(...);$SESSION.put(...);$SESSION.delete(...);$SESSION.head(...);$SESSION.patch(...))))"
semgrep-detect-no-csrf-before-method-override-copy,(express.csrf();\n...\nexpress.methodOverride();\n)
semgrep-insecure-object-assign-copy,()
semgrep-dangerous-interactive-code-run-copy,"AND(OR($X.push($PAYLOAD,...)\n;$X.runsource($PAYLOAD,...)\n;$X.runcode(code.compile_command($PAYLOAD),...)\n;$PL=code.compile_command($PAYLOAD,...)\n...\n$X.runcode($PL,...)\n);OR(;);NOT($X.push(""..."",...)\n);NOT($X.runsource(""..."",...)\n);NOT($X.runcode(code.compile_command(""...""),...)\n);NOT($PL=code.compile_command(""..."",...)\n...\n$X.runcode($PL,...)\n))"
semgrep-detect-insecure-websocket-copy,(r:\bws:\/\/)
semgrep-exec-detected-copy,"AND(NOT(exec(""...""));exec(...))"
semgrep-tainted-sql-string-copy,()
semgrep-prototype-pollution-loop-copy,"AND(OR($SMTH=$SMTH[$A]\n;$SMTH=$SMTH[$A]=...\n;$SMTH=$SMTH[$A]&&$Z\n;$SMTH=$SMTH[$A]||$Z\n);OR(;;);for(var$A=$S;...;...){...}\n;for($A=$S;...;...){...}\n;$X.forEach(function$NAME($OBJ,$A,...){...})\n)"
semgrep-incorrect-autoescape-disabled-copy,"AND(jinja2.Environment(...,autoescape=$VAL,...);NOT(jinja2.Environment(...,autoescape=True,...));NOT(jinja2.Environment(...,autoescape=jinja2.select_autoescape(...),...)))"
semgrep-httpsconnection-detected-copy,OR(httplib.HTTPSConnection(...);http.client.HTTPSConnection(...);six.moves.http_client.HTTPSConnection(...))
semgrep-detect-non-literal-regexp-copy,()
semgrep-autoescape-disabled-copy,"AND(NOT(jinja2.Environment(...,autoescape=True,...));NOT(jinja2.Environment(...,autoescape=jinja2.select_autoescape(...),...));jinja2.Environment(...))"
semgrep-avoid-shelve-copy,(shelve.$FUNC(...))
semgrep-subprocess-shell-true-copy,"AND(subprocess.$FUNC(...,shell=True,...);NOT(subprocess.$FUNC(""..."",shell=True,...)))"
semgrep-detect-bracket-object-injection-copy,AND(a();b())
semgrep-detect-pseudoRandomBytes-copy,(crypto.pseudoRandomBytes)
semgrep-raw-html-join-copy,"AND(OR(AND([...,$STRING,...].join(...)\n;NOT([...,""$HARDCODED"",...].join(""..."")\n))))"
semgrep-tainted-html-response-copy,()
semgrep-eval-detected-copy,"AND(NOT(eval(""...""));eval(...))"
semgrep-unquoted-csv-writer-copy,AND(a();b())
semgrep-javascript-insecure-document-method-copy,"AND(OR($EL.innerHTML=$HTML;\n;$EL.outerHTML=$HTML;\n;document.write(...));NOT($EL.innerHTML=""..."";\n);NOT($EL.outerHTML=""..."";\n);NOT(document.write(""..."")))"
semgrep-insecure-urlopen-ftp-copy,"OR(urllib.request.urlopen(""=~/^[Ff][Tt][Pp]://.*/"",...);$URL=""=~/^[Ff][Tt][Pp]://.*/""\n...\nurllib.request.urlopen($URL,...)\n;def$FUNC(...,$URL=""=~/^[Ff][Tt][Pp]://.*/"",...):\n...\nurllib.request.urlopen($URL,...))"
semgrep-python-reverse-shell-copy,"AND(OR(pty.spawn(""$BINPATH"",...);subprocess.call([""$BINPATH"",...],...));)"
semgrepno-auth-over-http-copy,"OR(requests.$W(""=~/http:\/\/.*/"",...,auth=$X,...);$URL=""=~/http:\/\/.../""\n...\nrequests.$W($URL,...,auth=$X,...)\n)"
semgrep-path-join-resolve-traversal-copy,()
semgrep-insecure-urlopener-open-copy,"OR(urllib.request.URLopener(...).open(""=~/[Hh][Tt][Tt][Pp]://.*/"",...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.open(""=~/[Hh][Tt][Tt][Pp]://.*/"",...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.open(""=~/[Hh][Tt][Tt][Pp]://.*/"",...)..)\n...\n);$OPENERDIRECTOR.open(""=~/[Hh][Tt][Tt][Pp]://.*/"",...));AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.open($URL,...)\n..\n;$OPENERDIRECTOR=urllib.request.URLopener($URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.open($URL,...)\n..)\n...\n);$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.open($URL,...)\n);$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\nurllib.request.URLopener(...).open($URL,...)\n;AND(OR(def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\nurllib.request.URLopener(...).open($URL,...)..\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR.open($URL,...)..\n;def$FUNC(urllib.request.URLopener(...).open($URL,...)..,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR.open($URL,...)..,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",urllib.request.URLopener(...).open($URL,...)..):\n...\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..):\n...\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",$OPENERDIRECTOR.open($URL,...)..):\n...\n);OR(urllib.request.URLopener(...).open($URL,...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.open($URL,...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.open($URL,...)..)\n...\n);$OPENERDIRECTOR.open($URL,...)))))"
semgrep-raw-html-concat-copy,()
semgrep-tainted-html-string-copy-javascript,()
semgrep-javascript-debugger-copy,(debugger;)
semgrep-system-wildcard-detected-copy,AND(OR(;;;;;);r:(tar|chmod|chown|rsync)(.*?)\*)
semgrep-jquery-insecure-method-copy,"OR(AND(OR($.$METHOD($VAR,...);$(...).$METHOD($VAR,...);jQuery.$METHOD($VAR,...);jQuery(...).$METHOD($VAR,...));NOT($.$METHOD(""..."",...));NOT($(...).$METHOD(""..."",...));NOT(jQuery.$METHOD(""..."",...));NOT(jQuery(...).$METHOD(""..."",...)));AND(OR($(...).$METHOD($VAR,...);jQuery(...).$METHOD($VAR,...));NOT($(""..."",...).$METHOD(...));NOT(jQuery(""..."",...).$METHOD(...))))"
semgrep-detect-eval-with-expression-copy,()
semgrep-hardcoded-password-default-argument-copy,"(def$FUNC(...,password=""..."",...):\n...\n)"
semgrep-python.requests.best-practice.use-request-json-shortcut-copy,"AND(requests.$METHOD(...,body=json.dumps($BODY),...)mportrequests;...mportjson;...;requests.$METHOD(...,body=json.dumps($BODY),...)mportrequests;...;requests.$METHOD(...,body=json.dumps($BODY),...)mportrequests;...;requests.$METHOD(...,body=json.dumps($BODY),...))"
semgrep-detect-disable-mustache-escape-copy,($OBJ.escapeMarkup=false)
semgrep-dangerous-globals-use-copy,"AND(OR(globals().get(...);locals().get(...);globals()[...];locals()[...];AND(OR(;);OR($G.get(...);$G[...]));$FUNC.__globals__[...]);NOT(globals().get(""...""));NOT(locals().get(""...""));NOT(globals()[""...""]);NOT(locals()[""...""]);NOT($G.get(""...""));NOT($G.get[""...""]);NOT($G[""...""]);NOT($FUNC.__globals__[""...""]);globals()[...]=...;locals()[...]=...;$G[...]=...;$FUNC.__globals__[...]=...)"
semgrep-formatted-sql-query-copy,"OR($DB.execute(""...""%...);$DB.execute(""..."".format(...));$DB.execute(f""..."");AND(OR(;;);$DB.execute($SQL)))"
semgrep-avoid-cPickle-copy,"AND(cPickle.$FUNC(...);NOT(cPickle.$FUNC(""..."")))"
semgrep-tainted-html-string-copy,()
semgrep-no-set-ciphers-copy,($CONTEXT.set_ciphers(...))
semgrep-missing-autoescape-disabled-copy,"AND(NOT(jinja2.Environment(...,autoescape=$VAL,...));jinja2.Environment(...))"
semgrep-dangerous-subprocess-use-audit-copy,"OR(AND(NOT(subprocess.$FUNC(""..."",...));NOT(subprocess.$FUNC([""..."",...],...));NOT(subprocess.$FUNC((""..."",...),...));NOT(subprocess.CalledProcessError(...));NOT(subprocess.SubprocessError(...));subprocess.$FUNC(...));AND(subprocess.$FUNC(""=~/(sh|bash|ksh|csh|tcsh|zsh)/"",""-c"",...);NOT(subprocess.$FUNC(""=~/(sh|bash|ksh|csh|tcsh|zsh)/"",""-c"",""..."",...)));AND(OR(subprocess.$FUNC([""=~/(sh|bash|ksh|csh|tcsh|zsh)/"",""-c"",...],...);subprocess.$FUNC((""=~/(sh|bash|ksh|csh|tcsh|zsh)/"",""-c"",...),...));NOT(subprocess.$FUNC([""=~/(sh|bash|ksh|csh|tcsh|zsh)/"",""-c"",""..."",...],...));NOT(subprocess.$FUNC((""=~/(sh|bash|ksh|csh|tcsh|zsh)/"",""-c"",""..."",...),...)));AND(subprocess.$FUNC(""=~/(python)/"",...);NOT(subprocess.$FUNC(""=~/(python)/"",""..."",...)));AND(OR(subprocess.$FUNC([""=~/(python)/"",...],...);subprocess.$FUNC((""=~/(python)/"",...),...));NOT(subprocess.$FUNC([""=~/(python)/"",""..."",...],...));NOT(subprocess.$FUNC((""=~/(python)/"",""..."",...),...))))"
semgrep-tainted-html-response-copy-javascript,()
semgrep-avoid-bind-to-all-interfaces-copy,"OR($S=socket.socket(...)\n...\n$S.bind((""0.0.0.0"",...))\n;$S=socket.socket(...)\n...\n$S.bind((""::"",...))\n;$S=socket.socket(...)\n...\n$S.bind(("""",...))\n)"
semgrep-non-literal-import-copy,"AND(importlib.import_module($NAME,...)\n;NOT(importlib.import_module(""..."",...)\n))"
semgrep-manual-counter-create-copy,"($DICT={}\n...\nfor$KEY,$VALUEin$OTHERDICT.items():\n...\nif$KEYnotin$DICT:\n...\n$DICT[$KEY]=0\n...\n$DICT[$KEY]+=1\n)"
semgrep-javascript-alert-copy,OR(alert();alert($X))
semgrep-dangerous-interactive-code-run-audit-copy,"AND(OR($X.push($PAYLOAD,...)\n;$X.runsource($PAYLOAD,...)\n;$X.runcode(code.compile_command($PAYLOAD),...)\n;$PL=code.compile_command($PAYLOAD,...)\n...\n$X.runcode($PL,...)\n);OR(;);NOT($X.push(""..."",...)\n);NOT($X.runsource(""..."",...)\n);NOT($X.runcode(code.compile_command(""...""),...)\n);NOT($PL=code.compile_command(""..."",...)\n...\n$X.runcode($PL,...)\n))"
semgrep-avoid-dill-copy,"AND(dill.$FUNC(...);NOT(dill.$FUNC(""..."")))"
semgrep-request-session-with-http-copy,()
semgrep-dynamic-urllib-use-detected-copy,"AND(NOT(urllib.$W(""...""));NOT(urllib.request.$W(""...""));NOT($OPENER.$W(""...""));OR(urllib.urlopen(...);urllib.request.urlopen(...);urllib.urlretrieve(...);urllib.request.urlretrieve(...);AND(OR(;;;);OR($OPENER.open(...);$OPENER.retrieve(...)))))"
semgrep-sqlalchemy-sqli-copy,()
semgrep-regex_dos-copy,"AND($A=re.compile(""$B"",...)\n...\n$A.$METHOD(...)\n)"
semgrep-insecure-innerhtml-copy,"AND($EL.innerHTML=$HTML;\n;NOT($EL.innerHTML=""..."";\n))"
semgrep-tainted-eval-copy,()
semgrep-request-with-http-copy,()
semgrep-arbitrary-sleep-copy,AND(NOT(time.sleep($F(...)));OR(time.sleep($X:int)\n;time.sleep($X:float)\n))
semgrep-avoid-pickle-copy,"AND(OR(pickle.$FUNC(...);_pickle.$FUNC(...));NOT(pickle.$FUNC(""...""));NOT(_pickle.$FUNC(""..."")))"
semgrep-detect-non-literal-require-copy,AND(a();b())
semgrep-prototype-pollution-function-copy,AND(a();b())
semgrep-assigned-undefined-copy,OR(undefined=$X;;varundefined=$X;;letundefined=$X;;constundefined=$X;)
emgrep-detect-child-process-copy,()
emgrep-detect-child-process-copy-copy,()
semgrep-template-autoescape-off,(r:{%\s+autoescape\s+off\s+%})
semgrep-unspecified-open-encoding-copy,"AND(NOT(open(open(...,encoding=""..."",...)..));NOT(open(open($F,""..."",$B,""..."",...)..));OR(open(open($FILE)..);open(open($FILE,...)..);open(open($FILE,$M,...)..);open(open\(.*(?:encoding|mode)=.*\)..);open(open($FILE,$MODE,...)..);open(open($FILE,...,mode=$MODE,...)..));NOT(open(...,encoding=""..."",...));NOT(open($F,""..."",$B,""..."",...));OR(open($FILE);AND(open($FILE,...);NOT(open($FILE,$M,...));NOT(r:open\(.*(?:encoding|mode)=.*\)));AND(open($FILE,$MODE,...));AND(open($FILE,...,mode=$MODE,...))))"
semgrep-detect-buffer-noassert-copy,"AND($OBJ.$API(...,true))"
semgrep-js-open-redirect-from-function-copy,()
semgrep-jquery-insecure-selector-copy,"AND(OR($(<...window...>)\n;$(<...location...>)\n;AND($X=<...window...>;\n...\n$(<...$X...>);\n);AND($X=<...location...>;\n...\n$(<...$X...>);\n);AND(OR(;;;);OR($(<...$Y...>)\n;$(""...""+(<...$Y...>))\n;$((<...$Y...>)+""..."")\n);$JQUERY.each(function($INDEX,$Y){\n...\n})\n));NOT($(window)\n);NOT($(document)\n);NOT($(this)\n))"
semgrep-listen-eval-copy,(logging.config.listen(...))
semgrep-dangerous-annotations-usage-copy,"AND($C.__annotations__[$NAME]=$X\n;NOT($C.__annotations__[$NAME]=""...""\n);NOT($C.__annotations__[$NAME]=typing.$Y\n))"
semgrep-dangerous-interactive-code-run-tainted-env-args-copy,()
semgrep-manual-defaultdict-list-create-copy,"OR($DICT={}\n...\nfor$KEY,$VALUEin$OTHERDICT.items():\n...\nif$KEYnotin$DICT:\n...\n$DICT[$KEY]=[]\n...\n$DICT[$KEY].append(...)\n;$DICT={}\n...\nfor$KEY,$VALUEin$OTHERDICT.items():\n...\n$DICT.setdefault($KEY,[]).append(...)\n)"
semgrep-dangerous-spawn-process-copy,()
semgrep-dangerous-subprocess-use-copy,()
semgrep-detect-non-literal-fs-filename-copy,()
semgrep-insufficient-postmessage-origin-validation-copy,"OR(AND(window.addEventListener('message';$FUNC,...)\n);AND(OR(;);window.addEventListener('message';$FNAME,...)\n))"
semgrep-logging-error-without-handling-copy,AND(OR(try:\n...\nexcept...:\n...\nlogger.$FUNC(...)\n...\nraise\n..\n;try:\n...\nexcept...:\n...\nlogger.$FUNC(...)\n...\nraise$EX\n..\n;try:\n...\nexcept...:\n...\nlogger.$FUNC(...)\n...\nraise$EXfrom$EX2\n..\n;try:\nlogger.$FUNC(...)\n...\nraise\n..\nexcept...:\n...\n...\n;try:\nlogger.$FUNC(...)\n...\nraise$EX\n..\nexcept...:\n...\n...\n;try:\nlogger.$FUNC(...)\n...\nraise$EXfrom$EX2\n..\nexcept...:\n...\n...\n;try:\n...\nexceptlogger.$FUNC(...)\n...\nraise\n..:\n...\n...\n;try:\n...\nexceptlogger.$FUNC(...)\n...\nraise$EX\n..:\n...\n...\n;try:\n...\nexceptlogger.$FUNC(...)\n...\nraise$EXfrom$EX2\n..:\n...\n...\n;try:\n...\nexcept...:\nlogger.$FUNC(...)\n...\nraise\n..\n...\n;try:\n...\nexcept...:\nlogger.$FUNC(...)\n...\nraise$EX\n..\n...\n;try:\n...\nexcept...:\nlogger.$FUNC(...)\n...\nraise$EXfrom$EX2\n..\n...\n);OR();OR(logger.$FUNC(...)\n...\nraise\n;logger.$FUNC(...)\n...\nraise$EX\n;logger.$FUNC(...)\n...\nraise$EXfrom$EX2\n))
semgrep-use-defused-xmlrpc,OR(importxmlrpclib;importSimpleXMLRPCServer;importxmlrpc)
semgrep-http-not-https-connection-copy,OR(urllib3.HTTPConnectionPool(...);urllib3.connectionpool.HTTPConnectionPool(...))
semgrep-socket-shutdown-close-copy,AND($SOCK.shutdown(socket.$A)\n$SOCK.close()\n;try:\n...\nexcept...:\n...\n$SOCK.close()\n;try:\n...\nfinally:\n...\n$SOCK.close()\n)
semgrep-js-open-redirect-copy,()
semgrep-prohibit-jquery-html-copy,"AND($X.html(...)\n;NOT($X.html(""..."",...)\n))"
semgrep-manual-defaultdict-dict-create-copy,"OR($DICT={}\n...\nfor$KEY,$VALUEin$OTHERDICT.items():\n...\nif$KEYnotin$DICT:\n...\n$DICT[$KEY]={}\n...\n$DICT[$KEY].update(...)\n;$DICT={}\n...\nfor$KEY,$VALUEin$OTHERDICT.items():\n...\n$DICT.setdefault($KEY,{}).update(...)\n)"
semgrep-weak-ssl-version-copy,OR(ssl.PROTOCOL_SSLv2;ssl.PROTOCOL_SSLv3;ssl.PROTOCOL_TLSv1;ssl.PROTOCOL_TLSv1_1;pyOpenSSL.SSL.SSLv2_METHOD;pyOpenSSL.SSL.SSLv23_METHOD;pyOpenSSL.SSL.SSLv3_METHOD;pyOpenSSL.SSL.TLSv1_METHOD;pyOpenSSL.SSL.TLSv1_1_METHOD)
semgrep-insecure-urlopener-retrieve-ftp-copy,"OR(urllib.request.URLopener(...).retrieve(""=~/[Ff][Tt][Pp]://.*/"",...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.retrieve(""=~/[Ff][Tt][Pp]://.*/"",...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.retrieve(""=~/[Ff][Tt][Pp]://.*/"",...)..)\n...\n);$OPENERDIRECTOR.retrieve(""=~/[Ff][Tt][Pp]://.*/"",...));AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$URL=""=~/[Ff][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.retrieve($URL,...)\n..\n;$OPENERDIRECTOR=urllib.request.URLopener($URL=""=~/[Ff][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.retrieve($URL,...)\n..)\n...\n);$URL=""=~/[Ff][Tt][Pp]://.*/""\n...\n$OPENERDIRECTOR.retrieve($URL,...)\n);$URL=""=~/[Ff][Tt][Pp]://.*/""\n...\nurllib.request.URLopener(...).retrieve($URL,...)\n;AND(OR(def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\nurllib.request.URLopener(...).retrieve($URL,...)..\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n$OPENERDIRECTOR.retrieve($URL,...)..\n;def$FUNC(urllib.request.URLopener(...).retrieve($URL,...)..,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n...\n;def$FUNC($OPENERDIRECTOR.retrieve($URL,...)..,$URL=""=~/[Ff][Tt][Pp]://.*/"",...):\n...\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",urllib.request.URLopener(...).retrieve($URL,...)..):\n...\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",$OPENERDIRECTOR=urllib.request.URLopener(...)\n...\n..):\n...\n;def$FUNC(...,$URL=""=~/[Ff][Tt][Pp]://.*/"",$OPENERDIRECTOR.retrieve($URL,...)..):\n...\n);OR(urllib.request.URLopener(...).retrieve($URL,...);AND(OR($OPENERDIRECTOR=urllib.request.URLopener(...)\n$OPENERDIRECTOR.retrieve($URL,...)..\n;$OPENERDIRECTOR=urllib.request.URLopener($OPENERDIRECTOR.retrieve($URL,...)..)\n...\n);$OPENERDIRECTOR.retrieve($URL,...)))))"
semgrep-wildcard-postmessage-configuration-copy,"($OBJECT.postMessage(...,'*'))"
semgrep-incomplete-sanitization-copy,"AND($STR.replace(($CHAR:string),...)\n)"
semgrep-html-in-template-string-copy,AND(OR(`$HTML${$VAR}...`\n;`...${$VAR}$HTML`\n))
semgrep-prototype-pollution-assignment-copy,"AND($X[$B]=...\n;NOT($X[$B]='...'\n);$X=$SMTH[$A]\nif(<...'constructor'...>){\n...\n}\n...\n..\n;$X=$SMTH[$A]\nif(<...'__proto__'...>){\n...\n}\n...\n..\n;$X=$SMTH[$A]\nfor(var$B=$S;...;...){...}\n..\n;$X=$SMTH[$A]\nfor($B=$S;...;...){...}\n..\n;$X=$SMTH[$A]\n$X.forEach(function$NAME($OBJ,$B,...){...})\n..\n;if(<...'constructor'...>){\n...\n}\n...\n;if(<...'__proto__'...>){\n...\n}\n...\n;for(var$B=$S;...;...){...}\n;for($B=$S;...;...){...}\n;$X.forEach(function$NAME($OBJ,$B,...){...})\n)"
semgrep-insecure-request-object-copy,"OR(urllib.request.Request(""=~/[Hh][Tt][Tt][Pp]://.*/"",...);$URL=""=~/[Hh][Tt][Tt][Pp]://.*/""\n...\nurllib.request.Request($URL,...)\n;def$FUNC(...,$URL=""=~/[Hh][Tt][Tt][Pp]://.*/"",...):\n...\nurllib.request.Request($URL,...)\n)"
semgrep-mysql-sqli-copy,()
semgrep-zlib-async-loop-copy,AND(OR(;;;;;;);zlib.$METHOD(...);)
