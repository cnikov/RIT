id,pattern,pattern-not,pattern-either,metavariable-pattern,metavariable-pattern-not,metavariable-pattern-either
odoo-avoid_hardcoded_config_DEBUG,[$M.update(DEBUG=True);$M.update(DEBUG=False);$M.config['DEBUG']=True;$M.config['DEBUG']=False],*,*,*,*,*
odoo-avoid_hardcoded_config_ENV,"[$M.update(ENV=""=~/^development|production$/"");$M.config['ENV']=""=~/^development|production$/"";$M.update(ENV=""=~/^development|production$/"");$M.config['ENV']=""=~/^development|production$/""]",*,*,*,*,*
odoo-avoid_hardcoded_config_SECRET_KEY,"[$M.update(SECRET_KEY=""=~/.*/"");$M.config['SECRET_KEY']=""=~/.*/""]",*,*,*,*,*
odoo-avoid_hardcoded_config_TESTING,"[$M.config['TESTING']=True;$M.config['TESTING']=False;$M.update(TESTING=True,...);$M.update(TESTING=False,...)]",*,*,*,*,*
odoo-copy,[request.params.copy(...)],*,*,*,*,*
odoo-crypto,[md5;sha1;hmac;hashlib;cryptography;OpenSSL;des;arc4;DES;ARC4],*,*,*,*,*
odoo-cr_execute,"[$CONNECTION.execute($SQL+$VAL,...)\n;$CONNECTION.execute($SQL%$VAL,...)\n;$CONNECTION.execute($SQL.format($VAL),...)\n;cr.execute($SQL.format($VAL),...)\n;$QUERY=$SQL+$VAL\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n;$QUERY=$SQL%$VAL\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n;$QUERY=$SQL.format($VAL)\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n;$QUERY=f""$CONNECTION.execute($QUERY,...)...{...}...""\n...\n;$QUERY=f""...{$CONNECTION.execute($QUERY,...)...}...""\n...\n;$QUERY=f""...{...}$CONNECTION.execute($QUERY,...)...""\n...\n;$QUERY=f""...{...}...""\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n]",*,*,*,*,*
odoo-database-secret,"[$SECRET=$SUDO.get_param(""database.secret"")\n]",[def$FUNCTION(...):\n...\n$SECRET.encode(...)\n],*,*,*,*
odoo-detected-aws-access-key-id-value,[re:\b(A3T[A-Z0-9]|AKIA|AGPA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}\b],[re:(?i)example|sample|test|fake],*,*,*,*
odoo-detected-hardcoded-key,[-----BEGIN$TYPEPRIVATEKEY-----$KEY;-----BEGINPRIVATEKEY-----\n$KEY\n],*,*,[$TYPE:':(?i)([dr]sa|ec|openssh|encrypted)?';$KEY:'entropy'],*,*
odoo-disabling-sqli-linter,[re:pylint\s*:\s*disable.*=sql-injection],*,*,*,*,*
odoo-external-control-of-file-name-or-path,"[open($INPUT,...)]",*,*,*,"[$INPUT:':^[a-zA-Z0-9_\\-\\.""]+$']",*
odoo-false-sanitize-attributes,[re:\bsanitizes*=\s*False;re:\bsanitize\_attributes\s*=\s*False;re:\bsanitize\_form\s*=\s*False],*,*,*,*,*
odoo-handle-requests-separately-from-other-risky-modules,[re:\bfrom\s+requests\b.*\bimport\b|\brequests\.\s*[a-z]+],[re:\brequests\.exceptions],*,*,*,*
odoo-huge_tree,[huge_tree],*,*,*,*,*
odoo-jwt-hardcoded,"[importjwt;fromjwtimport$ANYTHING;def$FUNC(...,password=""..."",...):\n...\n;def$FUNC(...,pwd=""..."",...):\n...\n;def$FUNC(...,passwd=""..."",...):\n...\n;def$FUNC(...,pswd=""..."",...):\n...\n;def$FUNC(...,passwrd=""..."",...):\n...\n;def$FUNC(...,passkey=""..."",...):\n...\n;def$FUNC(...,secret=""..."",...):\n...\n;jwt.encode($X,$SECRET,...)\n;""...""\n]",*,*,*,*,*
odoo-kn64kbnw,[setattr;__getattribute__;attrgetter;resolve_attr;getattr(...)],"[for$VARin$ITERABLE$ITERABLE=[getattr(...,'...'%$VAR,......]\n......:\n...\n;for$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,'...'%$VAR,......]\n......\n;for$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,'...'%$VAR,.........:\n...\n;for$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,'...'%$VAR,.........\n;for$VARin$ITERABLE$ITERABLE=[getattr(...,$VAR,......]\n......:\n...\n;for$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,$VAR,......]\n......\n;for$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,$VAR,.........:\n...\n;for$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,$VAR,.........\n;$ITERABLE=[for$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,'...'%$VAR,......]\n.........]\n...\n;$ITERABLE=[...]\nfor$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,'...'%$VAR,......]\n.........\n;$ITERABLE=[for$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,'...'%$VAR,.........:\n......]\n...\n;$ITERABLE=[...]\nfor$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,'...'%$VAR,.........:\n......\n;$ITERABLE=[for$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,'...'%$VAR,............]\n...\n;$ITERABLE=[...]\nfor$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,'...'%$VAR,............\n;$ITERABLE=[for$VARin$ITERABLE$ITERABLE=[getattr(...,$VAR,......]\n......:\n......]\n...\n;$ITERABLE=[...]\nfor$VARin$ITERABLE$ITERABLE=[getattr(...,$VAR,......]\n......:\n......\n;$ITERABLE=[for$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,$VAR,......]\n.........]\n...\n;$ITERABLE=[...]\nfor$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,$VAR,......]\n.........\n;$ITERABLE=[for$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,$VAR,.........:\n......]\n...\n;$ITERABLE=[...]\nfor$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,$VAR,.........:\n......\n;$ITERABLE=[for$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,$VAR,............]\n...\n;$ITERABLE=[...]\nfor$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,$VAR,............\n;getattr(...,'...'%$VAR,...);getattr(...,$VAR,...)]",*,*,*,*
odoo-markup,[Markup(...)],[frommarkupsafeimport$O\n...\n],*,*,*,*
odoo-module-open,[$OBJECT.open(...);open(...);send_file(...);from_path(...)],*,*,*,*,*
odoo-qweb-eval,[re:_?qcontext;re:_?eval_context],[re:def\s[a-zA-Z0-9\_]*_qcontext;re:def\s[a-zA-Z0-9\_]*_eval_context;re:\bminimal_qcontext;re:\bminimal_eval_context],*,*,*,*
odoo-risky-module,[re:\bos\.;re:\bsys\.;re:\bzipfile\.;re:\btempfile\.;re:\btarfile\.;re:\bpathlib\.;re:\bctypes\.;re:\burllib\.],"[re:zipfile\.is\_zipfile;re:zipfile\.BadZipfile;re:zipfile\.ZIP\_DEFLATED;re:os\.path\.realpath\([^\)]+\);re:os\.path\.exists\([^\)]+\);re:os\.path\.isdir\([^\)]+\);re:os\.urandom;re:os\.path\.splitext;re:os\.sep;re:os\.path\.sep;re:os\.path\.altsep;re:os\.altsep;re:os\.walk;re:os\.path\.normpath;re:os\.path\.relpath;re:os\.path\.dirname;re:os\.path\.join;re:os\.path\.abspath;re:os\.access;re:os\.path\.isfile;re:os\.path\.basename;re:os\.path\.abspath;re:os\.path\.expanduser;re:os\.path\.expandvars;re:os\.close;re:from\s*os\.;re:os\.listdir;re:import\s*os\.;re:sys\.exit;re:import\s*sys\.;re:sys\.modules\['[^']+'\];re:from\s*sys\.;re:sys\.arg\[0\];re:sys\.stderr\(;re:sys\.stderr\.write\(""[^']+""\);re:\.join\(pathlib\.Path\([^\)]+\)\.suffixes\);pathlib.$OBJECT.suffixes;re:\(?pathlib\.Path\([^\)]+\)\.suffixes\)?;re:urllib\.parse\.quote\(request\.httprequest\.full\_path\);re:import\s*urllib\.;re:tempfile\.mkstemp;re:tempfile\.NamedTemporaryFile;re:tempfile\.TemporaryFile]",*,*,*,*
odoo-safe_eval,[eval(...);safe_eval(...);$OBJECT.safe_eval(...);def_get_eval_context(...):\n...\n],"[$OBJECT.safe_eval(...,self._get_eval_context(),...);safe_eval(...,self._get_eval_context(),...);$VAL=self.env[...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...,{...,'...':$VAL,...},...)\n;$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n]",*,*,*,*
odoo-sensitive-data-in-logs,"[try:\n...\nexceptpsycopg2.$ERRORMSGas$ERROR:\n...\nprint(...,$ERROR)\n]",*,*,*,*,*
odoo-sensitive-information-post,"[$REQUEST.post(...,data=$VALUE,...)\n]",*,*,[$VALUE:'password\\|passwd\\|key\\|pass'],*,*
odoo-sqlalchemy-execute-raw-query,"[$CONNECTION.execute($SQL+$VAL,...)\n;$CONNECTION.execute($SQL%$VAL,...)\n;$CONNECTION.execute($SQL.format($VAL),...)\n;$QUERY=$SQL+$VAL\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n;$QUERY=$SQL%$VAL\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n;$QUERY=$SQL.format($VAL)\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n;$QUERY=f""$CONNECTION.execute($QUERY,...)...{...}...""\n...\n;$QUERY=f""...{$CONNECTION.execute($QUERY,...)...}...""\n...\n;$QUERY=f""...{...}$CONNECTION.execute($QUERY,...)...""\n...\n;$QUERY=f""...{...}...""\n$CONNECTION.execute($QUERY,...)...\n;$CONNECTION.execute($QUERY,...)\n]",*,*,*,[$VAL:'self\\._tables'],*
odoo-t-raw,"[re:t-raw\=?""]",*,*,*,*,*
odoo-unescape,[re:unescape\b],*,*,*,*,*
odoo-unsafe-connection,"[http.route(...,csrf=False,...);$APP.config['WTF_CSRF_ENABLED']=False]","[http.route(...,csrf=False,...,auth='public',...);http.route(...,csrf=False,...,auth='none',...)]",*,*,*,*
odoo-unstrusted-console-output,"[$CONNECTION.$PRINT(""...""+$VALUE);$CONNECTION.$PRINT(""...""%$VALUE);$CONNECTION.error($CONTENT);$CONNECTION.log($CONTENT);$CONNECTION.debug($CONTENT);$CONNECTION.warn($CONTENT);$CONNECTION.warning($CONTENT)]",*,*,[$PRINT:':error|log|debug|warn|warning'],*,[$CONTENT:'or|log\\b|debug\\b|warn\\b|warning\\b|e\\b|err\\b|content\\b']
