id,tree
odoo-crypto,OR(md5;sha1;hmac;hashlib;cryptography;OpenSSL;des;arc4;DES;ARC4)
odoo-crypto1,OR(md5;sha1;hmac;hashlib;cryptography;OpenSSL;des;arc4;DES;ARC4)
odoo-cr_execute,"AND(OR($CONNECTION.execute($SQL+$VAL,...)\n;$CONNECTION.execute($SQL%$VAL,...)\n;$CONNECTION.execute($SQL.format($VAL),...)\n;cr.execute($SQL.format($VAL),...)\n;AND($QUERY=$SQL+$VAL\n$CONNECTION.execute($QUERY,...)\n..\n;$CONNECTION.execute($QUERY,...)\n);AND($QUERY=$SQL%$VAL\n$CONNECTION.execute($QUERY,...)\n..\n;$CONNECTION.execute($QUERY,...)\n);AND($QUERY=$SQL.format($VAL)\n$CONNECTION.execute($QUERY,...)\n..\n;$CONNECTION.execute($QUERY,...)\n);AND(OR($QUERY=f""$CONNECTION.execute($QUERY,...)\n..{...}...""\n...\n;$QUERY=f""...{$CONNECTION.execute($QUERY,...)\n..}...""\n...\n;$QUERY=f""...{...}$CONNECTION.execute($QUERY,...)\n..""\n...\n;$QUERY=f""...{...}...""\n$CONNECTION.execute($QUERY,...)\n..\n);$CONNECTION.execute($QUERY,...)\n)))"
odoo-database-secret,"AND($SECRET=$SUDO.get_param(""database.secret"")\n;def$FUNCTION(...):\n...\n$SECRET.encode(...)\n)"
odoo-jwt-hardcoded,"AND(OR(importjwt;fromjwtimport$ANYTHING;def$FUNC(...,password=""..."",...):\n...\n;def$FUNC(...,pwd=""..."",...):\n...\n;def$FUNC(...,passwd=""..."",...):\n...\n;def$FUNC(...,pswd=""..."",...):\n...\n;def$FUNC(...,passwrd=""..."",...):\n...\n;def$FUNC(...,passkey=""..."",...):\n...\n;def$FUNC(...,secret=""..."",...):\n...\n;AND(jwt.encode($X,$SECRET,...)\n;""...""\n)))"
odoo-kn64kbnw,"AND(OR(setattr;__getattribute__;attrgetter;resolve_attr;AND(getattr(...);OR(NOT(for$VARin$ITERABLE$ITERABLE=[getattr(...,'...'%$VAR,...)..]\n...\n..:\n...\n);NOT(for$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,'...'%$VAR,...)..\n..:\n...\n);NOT(for$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,'...'%$VAR,...)..]\n...\n..\n);NOT(for$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,'...'%$VAR,...)..\n..\n));OR(NOT(for$VARin$ITERABLE$ITERABLE=[getattr(...,$VAR,...)..]\n...\n..:\n...\n);NOT(for$VARin$ITERABLE$ITERABLE=[...]\ngetattr(...,$VAR,...)..\n..:\n...\n);NOT(for$VARin$ITERABLE...:\n$ITERABLE=[getattr(...,$VAR,...)..]\n...\n..\n);NOT(for$VARin$ITERABLE...:\n$ITERABLE=[...]\ngetattr(...,$VAR,...)..\n..\n));OR(NOT($ITERABLE=[getattr(...,'...'%$VAR,...)..]\n...\n);NOT($ITERABLE=[...]\ngetattr(...,'...'%$VAR,...)..\n));OR(NOT($ITERABLE=[getattr(...,$VAR,...)..]\n...\n);NOT($ITERABLE=[...]\ngetattr(...,$VAR,...)..\n));OR(NOT($ITERABLE=[getattr(...,'...'%$VAR,...)..]\n...\n);NOT($ITERABLE=[...]\ngetattr(...,'...'%$VAR,...)..\n));OR(NOT($ITERABLE=[getattr(...,$VAR,...)..]\n...\n);NOT($ITERABLE=[...]\ngetattr(...,$VAR,...)..\n));NOT(getattr(...,'...'%$VAR,...));NOT(getattr(...,$VAR,...)))))"
odoo-markup,AND(frommarkupsafeimport$O\n...\n;Markup(...))
odoo-module-open,OR($OBJECT.open(...);open(...);send_file(...);from_path(...))
odoo-qweb-eval,AND(OR(re:_?qcontext;re:_?eval_context);NOT(re:def\s[a-zA-Z0-9\_]*_qcontext);NOT(re:def\s[a-zA-Z0-9\_]*_eval_context);NOT(re:\bminimal_qcontext);NOT(re:\bminimal_eval_context))
odoo-risky-module,"AND(OR(re:\bos\.;re:\bsys\.;re:\bzipfile\.;re:\btempfile\.;re:\btarfile\.;re:\bpathlib\.;re:\bctypes\.;re:\burllib\.);NOT(re:zipfile\.is\_zipfile);NOT(re:zipfile\.BadZipfile);NOT(re:zipfile\.ZIP\_DEFLATED);NOT(re:os\.path\.realpath\([^\)]+\));NOT(re:os\.path\.exists\([^\)]+\));NOT(re:os\.path\.isdir\([^\)]+\));NOT(re:os\.urandom);NOT(re:os\.path\.splitext);NOT(re:os\.sep);NOT(re:os\.path\.sep);NOT(re:os\.path\.altsep);NOT(re:os\.altsep);NOT(re:os\.walk);NOT(re:os\.path\.normpath);NOT(re:os\.path\.relpath);NOT(re:os\.path\.dirname);NOT(re:os\.path\.join);NOT(re:os\.path\.abspath);NOT(re:os\.access);NOT(re:os\.path\.isfile);NOT(re:os\.path\.basename);NOT(re:os\.path\.abspath);NOT(re:os\.path\.expanduser);NOT(re:os\.path\.expandvars);NOT(re:os\.close);NOT(re:from\s*os\.);NOT(re:os\.listdir);NOT(re:import\s*os\.);NOT(re:sys\.exit);NOT(re:import\s*sys\.);NOT(re:sys\.modules\['[^']+'\]);NOT(re:from\s*sys\.);NOT(re:sys\.arg\[0\]);NOT(re:sys\.stderr\();NOT(re:sys\.stderr\.write\(""[^']+""\));NOT(re:\.join\(pathlib\.Path\([^\)]+\)\.suffixes\));NOT(pathlib.$OBJECT.suffixes);NOT(re:\(?pathlib\.Path\([^\)]+\)\.suffixes\)?);NOT(re:urllib\.parse\.quote\(request\.httprequest\.full\_path\));NOT(re:import\s*urllib\.);NOT(re:tempfile\.mkstemp);NOT(re:tempfile\.NamedTemporaryFile);NOT(re:tempfile\.TemporaryFile))"
odoo-safe_eval,"AND(NOT($OBJECT.safe_eval(...,self._get_eval_context(),...));NOT(safe_eval(...,self._get_eval_context(),...));OR(eval(...);safe_eval(...);$OBJECT.safe_eval(...);def_get_eval_context(...):\n...\n);$VAL=self.env[...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...,{...,'...':$VAL,...},...)\n;$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n)"
