{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar InlayHintsController_1;\nimport { ModifierKeyEmitter } from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as languages from '../../../common/languages.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { InlayHintAnchor, InlayHintsFragments } from './inlayHints.js';\nimport { goToDefinitionWithLocation, showGoToContextMenu } from './inlayHintsLocations.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport * as colors from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\n// --- hint caching service (per session)\nclass InlayHintsCache {\n  constructor() {\n    this._entries = new LRUCache(50);\n  }\n  get(model) {\n    const key = InlayHintsCache._key(model);\n    return this._entries.get(key);\n  }\n  set(model, value) {\n    const key = InlayHintsCache._key(model);\n    this._entries.set(key, value);\n  }\n  static _key(model) {\n    return `${model.uri.toString()}/${model.getVersionId()}`;\n  }\n}\nconst IInlayHintsCache = createDecorator('IInlayHintsCache');\nregisterSingleton(IInlayHintsCache, InlayHintsCache, 1 /* InstantiationType.Delayed */);\n// --- rendered label\nexport class RenderedInlayHintLabelPart {\n  constructor(item, index) {\n    this.item = item;\n    this.index = index;\n  }\n  get part() {\n    const label = this.item.hint.label;\n    if (typeof label === 'string') {\n      return {\n        label\n      };\n    } else {\n      return label[this.index];\n    }\n  }\n}\nclass ActiveInlayHintInfo {\n  constructor(part, hasTriggerModifier) {\n    this.part = part;\n    this.hasTriggerModifier = hasTriggerModifier;\n  }\n}\n// --- controller\nlet InlayHintsController = InlayHintsController_1 = class InlayHintsController {\n  static get(editor) {\n    var _a;\n    return (_a = editor.getContribution(InlayHintsController_1.ID)) !== null && _a !== void 0 ? _a : undefined;\n  }\n  constructor(_editor, _languageFeaturesService, _featureDebounce, _inlayHintsCache, _commandService, _notificationService, _instaService) {\n    this._editor = _editor;\n    this._languageFeaturesService = _languageFeaturesService;\n    this._inlayHintsCache = _inlayHintsCache;\n    this._commandService = _commandService;\n    this._notificationService = _notificationService;\n    this._instaService = _instaService;\n    this._disposables = new DisposableStore();\n    this._sessionDisposables = new DisposableStore();\n    this._decorationsMetadata = new Map();\n    this._ruleFactory = new DynamicCssRules(this._editor);\n    this._activeRenderMode = 0 /* RenderMode.Normal */;\n    this._debounceInfo = _featureDebounce.for(_languageFeaturesService.inlayHintsProvider, 'InlayHint', {\n      min: 25\n    });\n    this._disposables.add(_languageFeaturesService.inlayHintsProvider.onDidChange(() => this._update()));\n    this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n    this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n    this._disposables.add(_editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(139 /* EditorOption.inlayHints */)) {\n        this._update();\n      }\n    }));\n    this._update();\n  }\n  dispose() {\n    this._sessionDisposables.dispose();\n    this._removeAllDecorations();\n    this._disposables.dispose();\n  }\n  _update() {\n    this._sessionDisposables.clear();\n    this._removeAllDecorations();\n    const options = this._editor.getOption(139 /* EditorOption.inlayHints */);\n    if (options.enabled === 'off') {\n      return;\n    }\n    const model = this._editor.getModel();\n    if (!model || !this._languageFeaturesService.inlayHintsProvider.has(model)) {\n      return;\n    }\n    // iff possible, quickly update from cache\n    const cached = this._inlayHintsCache.get(model);\n    if (cached) {\n      this._updateHintsDecorators([model.getFullModelRange()], cached);\n    }\n    this._sessionDisposables.add(toDisposable(() => {\n      // cache items when switching files etc\n      if (!model.isDisposed()) {\n        this._cacheHintsForFastRestore(model);\n      }\n    }));\n    let cts;\n    const watchedProviders = new Set();\n    const scheduler = new RunOnceScheduler(() => __awaiter(this, void 0, void 0, function* () {\n      const t1 = Date.now();\n      cts === null || cts === void 0 ? void 0 : cts.dispose(true);\n      cts = new CancellationTokenSource();\n      const listener = model.onWillDispose(() => cts === null || cts === void 0 ? void 0 : cts.cancel());\n      try {\n        const myToken = cts.token;\n        const inlayHints = yield InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider, model, this._getHintsRanges(), myToken);\n        scheduler.delay = this._debounceInfo.update(model, Date.now() - t1);\n        if (myToken.isCancellationRequested) {\n          inlayHints.dispose();\n          return;\n        }\n        // listen to provider changes\n        for (const provider of inlayHints.provider) {\n          if (typeof provider.onDidChangeInlayHints === 'function' && !watchedProviders.has(provider)) {\n            watchedProviders.add(provider);\n            this._sessionDisposables.add(provider.onDidChangeInlayHints(() => {\n              if (!scheduler.isScheduled()) {\n                // ignore event when request is already scheduled\n                scheduler.schedule();\n              }\n            }));\n          }\n        }\n        this._sessionDisposables.add(inlayHints);\n        this._updateHintsDecorators(inlayHints.ranges, inlayHints.items);\n        this._cacheHintsForFastRestore(model);\n      } catch (err) {\n        onUnexpectedError(err);\n      } finally {\n        cts.dispose();\n        listener.dispose();\n      }\n    }), this._debounceInfo.get(model));\n    this._sessionDisposables.add(scheduler);\n    this._sessionDisposables.add(toDisposable(() => cts === null || cts === void 0 ? void 0 : cts.dispose(true)));\n    scheduler.schedule(0);\n    this._sessionDisposables.add(this._editor.onDidScrollChange(e => {\n      // update when scroll position changes\n      // uses scrollTopChanged has weak heuristic to differenatiate between scrolling due to\n      // typing or due to \"actual\" scrolling\n      if (e.scrollTopChanged || !scheduler.isScheduled()) {\n        scheduler.schedule();\n      }\n    }));\n    this._sessionDisposables.add(this._editor.onDidChangeModelContent(e => {\n      // update less aggressive when typing\n      const delay = Math.max(scheduler.delay, 1250);\n      scheduler.schedule(delay);\n    }));\n    if (options.enabled === 'on') {\n      // different \"on\" modes: always\n      this._activeRenderMode = 0 /* RenderMode.Normal */;\n    } else {\n      // different \"on\" modes: offUnlessPressed, or onUnlessPressed\n      let defaultMode;\n      let altMode;\n      if (options.enabled === 'onUnlessPressed') {\n        defaultMode = 0 /* RenderMode.Normal */;\n        altMode = 1 /* RenderMode.Invisible */;\n      } else {\n        defaultMode = 1 /* RenderMode.Invisible */;\n        altMode = 0 /* RenderMode.Normal */;\n      }\n\n      this._activeRenderMode = defaultMode;\n      this._sessionDisposables.add(ModifierKeyEmitter.getInstance().event(e => {\n        if (!this._editor.hasModel()) {\n          return;\n        }\n        const newRenderMode = e.altKey && e.ctrlKey && !(e.shiftKey || e.metaKey) ? altMode : defaultMode;\n        if (newRenderMode !== this._activeRenderMode) {\n          this._activeRenderMode = newRenderMode;\n          const model = this._editor.getModel();\n          const copies = this._copyInlayHintsWithCurrentAnchor(model);\n          this._updateHintsDecorators([model.getFullModelRange()], copies);\n          scheduler.schedule(0);\n        }\n      }));\n    }\n    // mouse gestures\n    this._sessionDisposables.add(this._installDblClickGesture(() => scheduler.schedule(0)));\n    this._sessionDisposables.add(this._installLinkGesture());\n    this._sessionDisposables.add(this._installContextMenu());\n  }\n  _installLinkGesture() {\n    const store = new DisposableStore();\n    const gesture = store.add(new ClickLinkGesture(this._editor));\n    // let removeHighlight = () => { };\n    const sessionStore = new DisposableStore();\n    store.add(sessionStore);\n    store.add(gesture.onMouseMoveOrRelevantKeyDown(e => {\n      const [mouseEvent] = e;\n      const labelPart = this._getInlayHintLabelPart(mouseEvent);\n      const model = this._editor.getModel();\n      if (!labelPart || !model) {\n        sessionStore.clear();\n        return;\n      }\n      // resolve the item\n      const cts = new CancellationTokenSource();\n      sessionStore.add(toDisposable(() => cts.dispose(true)));\n      labelPart.item.resolve(cts.token);\n      // render link => when the modifier is pressed and when there is a command or location\n      this._activeInlayHintPart = labelPart.part.command || labelPart.part.location ? new ActiveInlayHintInfo(labelPart, mouseEvent.hasTriggerModifier) : undefined;\n      const lineNumber = model.validatePosition(labelPart.item.hint.position).lineNumber;\n      const range = new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber));\n      const lineHints = this._getInlineHintsForRange(range);\n      this._updateHintsDecorators([range], lineHints);\n      sessionStore.add(toDisposable(() => {\n        this._activeInlayHintPart = undefined;\n        this._updateHintsDecorators([range], lineHints);\n      }));\n    }));\n    store.add(gesture.onCancel(() => sessionStore.clear()));\n    store.add(gesture.onExecute(e => __awaiter(this, void 0, void 0, function* () {\n      const label = this._getInlayHintLabelPart(e);\n      if (label) {\n        const part = label.part;\n        if (part.location) {\n          // location -> execute go to def\n          this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, part.location);\n        } else if (languages.Command.is(part.command)) {\n          // command -> execute it\n          yield this._invokeCommand(part.command, label.item);\n        }\n      }\n    })));\n    return store;\n  }\n  _getInlineHintsForRange(range) {\n    const lineHints = new Set();\n    for (const data of this._decorationsMetadata.values()) {\n      if (range.containsRange(data.item.anchor.range)) {\n        lineHints.add(data.item);\n      }\n    }\n    return Array.from(lineHints);\n  }\n  _installDblClickGesture(updateInlayHints) {\n    return this._editor.onMouseUp(e => __awaiter(this, void 0, void 0, function* () {\n      if (e.event.detail !== 2) {\n        return;\n      }\n      const part = this._getInlayHintLabelPart(e);\n      if (!part) {\n        return;\n      }\n      e.event.preventDefault();\n      yield part.item.resolve(CancellationToken.None);\n      if (isNonEmptyArray(part.item.hint.textEdits)) {\n        const edits = part.item.hint.textEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text));\n        this._editor.executeEdits('inlayHint.default', edits);\n        updateInlayHints();\n      }\n    }));\n  }\n  _installContextMenu() {\n    return this._editor.onContextMenu(e => __awaiter(this, void 0, void 0, function* () {\n      if (!(e.event.target instanceof HTMLElement)) {\n        return;\n      }\n      const part = this._getInlayHintLabelPart(e);\n      if (part) {\n        yield this._instaService.invokeFunction(showGoToContextMenu, this._editor, e.event.target, part);\n      }\n    }));\n  }\n  _getInlayHintLabelPart(e) {\n    var _a;\n    if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n      return undefined;\n    }\n    const options = (_a = e.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n    if (options instanceof ModelDecorationInjectedTextOptions && (options === null || options === void 0 ? void 0 : options.attachedData) instanceof RenderedInlayHintLabelPart) {\n      return options.attachedData;\n    }\n    return undefined;\n  }\n  _invokeCommand(command, item) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        yield this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n      } catch (err) {\n        this._notificationService.notify({\n          severity: Severity.Error,\n          source: item.provider.displayName,\n          message: err\n        });\n      }\n    });\n  }\n  _cacheHintsForFastRestore(model) {\n    const hints = this._copyInlayHintsWithCurrentAnchor(model);\n    this._inlayHintsCache.set(model, hints);\n  }\n  // return inlay hints but with an anchor that reflects \"updates\"\n  // that happened after receiving them, e.g adding new lines before a hint\n  _copyInlayHintsWithCurrentAnchor(model) {\n    const items = new Map();\n    for (const [id, obj] of this._decorationsMetadata) {\n      if (items.has(obj.item)) {\n        // an inlay item can be rendered as multiple decorations\n        // but they will all uses the same range\n        continue;\n      }\n      const range = model.getDecorationRange(id);\n      if (range) {\n        // update range with whatever the editor has tweaked it to\n        const anchor = new InlayHintAnchor(range, obj.item.anchor.direction);\n        const copy = obj.item.with({\n          anchor\n        });\n        items.set(obj.item, copy);\n      }\n    }\n    return Array.from(items.values());\n  }\n  _getHintsRanges() {\n    const extra = 30;\n    const model = this._editor.getModel();\n    const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n    const result = [];\n    for (const range of visibleRanges.sort(Range.compareRangesUsingStarts)) {\n      const extendedRange = model.validateRange(new Range(range.startLineNumber - extra, range.startColumn, range.endLineNumber + extra, range.endColumn));\n      if (result.length === 0 || !Range.areIntersectingOrTouching(result[result.length - 1], extendedRange)) {\n        result.push(extendedRange);\n      } else {\n        result[result.length - 1] = Range.plusRange(result[result.length - 1], extendedRange);\n      }\n    }\n    return result;\n  }\n  _updateHintsDecorators(ranges, items) {\n    var _a, _b;\n    // utils to collect/create injected text decorations\n    const newDecorationsData = [];\n    const addInjectedText = (item, ref, content, cursorStops, attachedData) => {\n      const opts = {\n        content,\n        inlineClassNameAffectsLetterSpacing: true,\n        inlineClassName: ref.className,\n        cursorStops,\n        attachedData\n      };\n      newDecorationsData.push({\n        item,\n        classNameRef: ref,\n        decoration: {\n          range: item.anchor.range,\n          options: {\n            // className: \"rangeHighlight\", // DEBUG highlight to see to what range a hint is attached\n            description: 'InlayHint',\n            showIfCollapsed: item.anchor.range.isEmpty(),\n            // \"original\" range is empty\n            collapseOnReplaceEdit: !item.anchor.range.isEmpty(),\n            stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n            [item.anchor.direction]: this._activeRenderMode === 0 /* RenderMode.Normal */ ? opts : undefined\n          }\n        }\n      });\n    };\n    const addInjectedWhitespace = (item, isLast) => {\n      const marginRule = this._ruleFactory.createClassNameRef({\n        width: `${fontSize / 3 | 0}px`,\n        display: 'inline-block'\n      });\n      addInjectedText(item, marginRule, '\\u200a', isLast ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None);\n    };\n    //\n    const {\n      fontSize,\n      fontFamily,\n      padding,\n      isUniform\n    } = this._getLayoutInfo();\n    const fontFamilyVar = '--code-editorInlayHintsFontFamily';\n    this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily);\n    for (const item of items) {\n      // whitespace leading the actual label\n      if (item.hint.paddingLeft) {\n        addInjectedWhitespace(item, false);\n      }\n      // the label with its parts\n      const parts = typeof item.hint.label === 'string' ? [{\n        label: item.hint.label\n      }] : item.hint.label;\n      for (let i = 0; i < parts.length; i++) {\n        const part = parts[i];\n        const isFirst = i === 0;\n        const isLast = i === parts.length - 1;\n        const cssProperties = {\n          fontSize: `${fontSize}px`,\n          fontFamily: `var(${fontFamilyVar}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,\n          verticalAlign: isUniform ? 'baseline' : 'middle',\n          unicodeBidi: 'isolate'\n        };\n        if (isNonEmptyArray(item.hint.textEdits)) {\n          cssProperties.cursor = 'default';\n        }\n        this._fillInColors(cssProperties, item.hint);\n        if ((part.command || part.location) && ((_a = this._activeInlayHintPart) === null || _a === void 0 ? void 0 : _a.part.item) === item && this._activeInlayHintPart.part.index === i) {\n          // active link!\n          cssProperties.textDecoration = 'underline';\n          if (this._activeInlayHintPart.hasTriggerModifier) {\n            cssProperties.color = themeColorFromId(colors.editorActiveLinkForeground);\n            cssProperties.cursor = 'pointer';\n          }\n        }\n        if (padding) {\n          if (isFirst && isLast) {\n            // only element\n            cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px`;\n            cssProperties.borderRadius = `${fontSize / 4 | 0}px`;\n          } else if (isFirst) {\n            // first element\n            cssProperties.padding = `1px 0 1px ${Math.max(1, fontSize / 4) | 0}px`;\n            cssProperties.borderRadius = `${fontSize / 4 | 0}px 0 0 ${fontSize / 4 | 0}px`;\n          } else if (isLast) {\n            // last element\n            cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px 1px 0`;\n            cssProperties.borderRadius = `0 ${fontSize / 4 | 0}px ${fontSize / 4 | 0}px 0`;\n          } else {\n            cssProperties.padding = `1px 0 1px 0`;\n          }\n        }\n        addInjectedText(item, this._ruleFactory.createClassNameRef(cssProperties), fixSpace(part.label), isLast && !item.hint.paddingRight ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None, new RenderedInlayHintLabelPart(item, i));\n      }\n      // whitespace trailing the actual label\n      if (item.hint.paddingRight) {\n        addInjectedWhitespace(item, true);\n      }\n      if (newDecorationsData.length > InlayHintsController_1._MAX_DECORATORS) {\n        break;\n      }\n    }\n    // collect all decoration ids that are affected by the ranges\n    // and only update those decorations\n    const decorationIdsToReplace = [];\n    for (const range of ranges) {\n      for (const {\n        id\n      } of (_b = this._editor.getDecorationsInRange(range)) !== null && _b !== void 0 ? _b : []) {\n        const metadata = this._decorationsMetadata.get(id);\n        if (metadata) {\n          decorationIdsToReplace.push(id);\n          metadata.classNameRef.dispose();\n          this._decorationsMetadata.delete(id);\n        }\n      }\n    }\n    const scrollState = StableEditorScrollState.capture(this._editor);\n    this._editor.changeDecorations(accessor => {\n      const newDecorationIds = accessor.deltaDecorations(decorationIdsToReplace, newDecorationsData.map(d => d.decoration));\n      for (let i = 0; i < newDecorationIds.length; i++) {\n        const data = newDecorationsData[i];\n        this._decorationsMetadata.set(newDecorationIds[i], data);\n      }\n    });\n    scrollState.restore(this._editor);\n  }\n  _fillInColors(props, hint) {\n    if (hint.kind === languages.InlayHintKind.Parameter) {\n      props.backgroundColor = themeColorFromId(colors.editorInlayHintParameterBackground);\n      props.color = themeColorFromId(colors.editorInlayHintParameterForeground);\n    } else if (hint.kind === languages.InlayHintKind.Type) {\n      props.backgroundColor = themeColorFromId(colors.editorInlayHintTypeBackground);\n      props.color = themeColorFromId(colors.editorInlayHintTypeForeground);\n    } else {\n      props.backgroundColor = themeColorFromId(colors.editorInlayHintBackground);\n      props.color = themeColorFromId(colors.editorInlayHintForeground);\n    }\n  }\n  _getLayoutInfo() {\n    const options = this._editor.getOption(139 /* EditorOption.inlayHints */);\n    const padding = options.padding;\n    const editorFontSize = this._editor.getOption(52 /* EditorOption.fontSize */);\n    const editorFontFamily = this._editor.getOption(49 /* EditorOption.fontFamily */);\n    let fontSize = options.fontSize;\n    if (!fontSize || fontSize < 5 || fontSize > editorFontSize) {\n      fontSize = editorFontSize;\n    }\n    const fontFamily = options.fontFamily || editorFontFamily;\n    const isUniform = !padding && fontFamily === editorFontFamily && fontSize === editorFontSize;\n    return {\n      fontSize,\n      fontFamily,\n      padding,\n      isUniform\n    };\n  }\n  _removeAllDecorations() {\n    this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));\n    for (const obj of this._decorationsMetadata.values()) {\n      obj.classNameRef.dispose();\n    }\n    this._decorationsMetadata.clear();\n  }\n};\nInlayHintsController.ID = 'editor.contrib.InlayHints';\nInlayHintsController._MAX_DECORATORS = 1500;\nInlayHintsController = InlayHintsController_1 = __decorate([__param(1, ILanguageFeaturesService), __param(2, ILanguageFeatureDebounceService), __param(3, IInlayHintsCache), __param(4, ICommandService), __param(5, INotificationService), __param(6, IInstantiationService)], InlayHintsController);\nexport { InlayHintsController };\n// Prevents the view from potentially visible whitespace\nfunction fixSpace(str) {\n  const noBreakWhitespace = '\\xa0';\n  return str.replace(/[ \\t]/g, noBreakWhitespace);\n}\nCommandsRegistry.registerCommand('_executeInlayHintProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n  const [uri, range] = args;\n  assertType(URI.isUri(uri));\n  assertType(Range.isIRange(range));\n  const {\n    inlayHintsProvider\n  } = accessor.get(ILanguageFeaturesService);\n  const ref = yield accessor.get(ITextModelService).createModelReference(uri);\n  try {\n    const model = yield InlayHintsFragments.create(inlayHintsProvider, ref.object.textEditorModel, [Range.lift(range)], CancellationToken.None);\n    const result = model.items.map(i => i.hint);\n    setTimeout(() => model.dispose(), 0); // dispose after sending to ext host\n    return result;\n  } finally {\n    ref.dispose();\n  }\n}));","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","InlayHintsController_1","ModifierKeyEmitter","isNonEmptyArray","RunOnceScheduler","CancellationToken","CancellationTokenSource","onUnexpectedError","DisposableStore","toDisposable","LRUCache","assertType","URI","DynamicCssRules","StableEditorScrollState","EDITOR_FONT_DEFAULTS","EditOperation","Range","languages","InjectedTextCursorStops","ModelDecorationInjectedTextOptions","ILanguageFeatureDebounceService","ILanguageFeaturesService","ITextModelService","ClickLinkGesture","InlayHintAnchor","InlayHintsFragments","goToDefinitionWithLocation","showGoToContextMenu","CommandsRegistry","ICommandService","registerSingleton","createDecorator","IInstantiationService","INotificationService","Severity","colors","themeColorFromId","InlayHintsCache","constructor","_entries","get","model","_key","set","uri","toString","getVersionId","IInlayHintsCache","RenderedInlayHintLabelPart","item","index","part","label","hint","ActiveInlayHintInfo","hasTriggerModifier","InlayHintsController","editor","_a","getContribution","ID","undefined","_editor","_languageFeaturesService","_featureDebounce","_inlayHintsCache","_commandService","_notificationService","_instaService","_disposables","_sessionDisposables","_decorationsMetadata","Map","_ruleFactory","_activeRenderMode","_debounceInfo","for","inlayHintsProvider","min","add","onDidChange","_update","onDidChangeModel","onDidChangeModelLanguage","onDidChangeConfiguration","hasChanged","dispose","_removeAllDecorations","clear","options","getOption","enabled","getModel","has","cached","_updateHintsDecorators","getFullModelRange","isDisposed","_cacheHintsForFastRestore","cts","watchedProviders","Set","scheduler","t1","Date","now","listener","onWillDispose","cancel","myToken","token","inlayHints","create","_getHintsRanges","delay","update","isCancellationRequested","provider","onDidChangeInlayHints","isScheduled","schedule","ranges","items","err","onDidScrollChange","scrollTopChanged","onDidChangeModelContent","Math","max","defaultMode","altMode","getInstance","event","hasModel","newRenderMode","altKey","ctrlKey","shiftKey","metaKey","copies","_copyInlayHintsWithCurrentAnchor","_installDblClickGesture","_installLinkGesture","_installContextMenu","store","gesture","sessionStore","onMouseMoveOrRelevantKeyDown","mouseEvent","labelPart","_getInlayHintLabelPart","_activeInlayHintPart","command","location","lineNumber","validatePosition","position","range","getLineMaxColumn","lineHints","_getInlineHintsForRange","onCancel","onExecute","invokeFunction","Command","is","_invokeCommand","data","values","containsRange","anchor","Array","from","updateInlayHints","onMouseUp","detail","preventDefault","None","textEdits","edits","map","edit","replace","lift","text","executeEdits","onContextMenu","HTMLElement","type","injectedText","attachedData","executeCommand","id","notify","severity","Error","source","displayName","message","hints","obj","getDecorationRange","direction","copy","with","extra","visibleRanges","getVisibleRangesPlusViewportAboveBelow","sort","compareRangesUsingStarts","extendedRange","validateRange","startLineNumber","startColumn","endLineNumber","endColumn","areIntersectingOrTouching","push","plusRange","_b","newDecorationsData","addInjectedText","ref","content","cursorStops","opts","inlineClassNameAffectsLetterSpacing","inlineClassName","className","classNameRef","decoration","description","showIfCollapsed","isEmpty","collapseOnReplaceEdit","stickiness","addInjectedWhitespace","isLast","marginRule","createClassNameRef","width","fontSize","display","Right","fontFamily","padding","isUniform","_getLayoutInfo","fontFamilyVar","getContainerDomNode","style","setProperty","paddingLeft","parts","isFirst","cssProperties","verticalAlign","unicodeBidi","cursor","_fillInColors","textDecoration","color","editorActiveLinkForeground","borderRadius","fixSpace","paddingRight","_MAX_DECORATORS","decorationIdsToReplace","getDecorationsInRange","metadata","delete","scrollState","capture","changeDecorations","accessor","newDecorationIds","deltaDecorations","restore","props","kind","InlayHintKind","Parameter","backgroundColor","editorInlayHintParameterBackground","editorInlayHintParameterForeground","Type","editorInlayHintTypeBackground","editorInlayHintTypeForeground","editorInlayHintBackground","editorInlayHintForeground","editorFontSize","editorFontFamily","removeDecorations","keys","str","noBreakWhitespace","registerCommand","args","isUri","isIRange","createModelReference","object","textEditorModel","setTimeout"],"sources":["/home/chlohest/work/website/my_web/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsController.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar InlayHintsController_1;\nimport { ModifierKeyEmitter } from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as languages from '../../../common/languages.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { InlayHintAnchor, InlayHintsFragments } from './inlayHints.js';\nimport { goToDefinitionWithLocation, showGoToContextMenu } from './inlayHintsLocations.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport * as colors from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\n// --- hint caching service (per session)\nclass InlayHintsCache {\n    constructor() {\n        this._entries = new LRUCache(50);\n    }\n    get(model) {\n        const key = InlayHintsCache._key(model);\n        return this._entries.get(key);\n    }\n    set(model, value) {\n        const key = InlayHintsCache._key(model);\n        this._entries.set(key, value);\n    }\n    static _key(model) {\n        return `${model.uri.toString()}/${model.getVersionId()}`;\n    }\n}\nconst IInlayHintsCache = createDecorator('IInlayHintsCache');\nregisterSingleton(IInlayHintsCache, InlayHintsCache, 1 /* InstantiationType.Delayed */);\n// --- rendered label\nexport class RenderedInlayHintLabelPart {\n    constructor(item, index) {\n        this.item = item;\n        this.index = index;\n    }\n    get part() {\n        const label = this.item.hint.label;\n        if (typeof label === 'string') {\n            return { label };\n        }\n        else {\n            return label[this.index];\n        }\n    }\n}\nclass ActiveInlayHintInfo {\n    constructor(part, hasTriggerModifier) {\n        this.part = part;\n        this.hasTriggerModifier = hasTriggerModifier;\n    }\n}\n// --- controller\nlet InlayHintsController = InlayHintsController_1 = class InlayHintsController {\n    static get(editor) {\n        var _a;\n        return (_a = editor.getContribution(InlayHintsController_1.ID)) !== null && _a !== void 0 ? _a : undefined;\n    }\n    constructor(_editor, _languageFeaturesService, _featureDebounce, _inlayHintsCache, _commandService, _notificationService, _instaService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._inlayHintsCache = _inlayHintsCache;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._instaService = _instaService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._decorationsMetadata = new Map();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._activeRenderMode = 0 /* RenderMode.Normal */;\n        this._debounceInfo = _featureDebounce.for(_languageFeaturesService.inlayHintsProvider, 'InlayHint', { min: 25 });\n        this._disposables.add(_languageFeaturesService.inlayHintsProvider.onDidChange(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(139 /* EditorOption.inlayHints */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._sessionDisposables.dispose();\n        this._removeAllDecorations();\n        this._disposables.dispose();\n    }\n    _update() {\n        this._sessionDisposables.clear();\n        this._removeAllDecorations();\n        const options = this._editor.getOption(139 /* EditorOption.inlayHints */);\n        if (options.enabled === 'off') {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.inlayHintsProvider.has(model)) {\n            return;\n        }\n        // iff possible, quickly update from cache\n        const cached = this._inlayHintsCache.get(model);\n        if (cached) {\n            this._updateHintsDecorators([model.getFullModelRange()], cached);\n        }\n        this._sessionDisposables.add(toDisposable(() => {\n            // cache items when switching files etc\n            if (!model.isDisposed()) {\n                this._cacheHintsForFastRestore(model);\n            }\n        }));\n        let cts;\n        const watchedProviders = new Set();\n        const scheduler = new RunOnceScheduler(() => __awaiter(this, void 0, void 0, function* () {\n            const t1 = Date.now();\n            cts === null || cts === void 0 ? void 0 : cts.dispose(true);\n            cts = new CancellationTokenSource();\n            const listener = model.onWillDispose(() => cts === null || cts === void 0 ? void 0 : cts.cancel());\n            try {\n                const myToken = cts.token;\n                const inlayHints = yield InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider, model, this._getHintsRanges(), myToken);\n                scheduler.delay = this._debounceInfo.update(model, Date.now() - t1);\n                if (myToken.isCancellationRequested) {\n                    inlayHints.dispose();\n                    return;\n                }\n                // listen to provider changes\n                for (const provider of inlayHints.provider) {\n                    if (typeof provider.onDidChangeInlayHints === 'function' && !watchedProviders.has(provider)) {\n                        watchedProviders.add(provider);\n                        this._sessionDisposables.add(provider.onDidChangeInlayHints(() => {\n                            if (!scheduler.isScheduled()) { // ignore event when request is already scheduled\n                                scheduler.schedule();\n                            }\n                        }));\n                    }\n                }\n                this._sessionDisposables.add(inlayHints);\n                this._updateHintsDecorators(inlayHints.ranges, inlayHints.items);\n                this._cacheHintsForFastRestore(model);\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n            finally {\n                cts.dispose();\n                listener.dispose();\n            }\n        }), this._debounceInfo.get(model));\n        this._sessionDisposables.add(scheduler);\n        this._sessionDisposables.add(toDisposable(() => cts === null || cts === void 0 ? void 0 : cts.dispose(true)));\n        scheduler.schedule(0);\n        this._sessionDisposables.add(this._editor.onDidScrollChange((e) => {\n            // update when scroll position changes\n            // uses scrollTopChanged has weak heuristic to differenatiate between scrolling due to\n            // typing or due to \"actual\" scrolling\n            if (e.scrollTopChanged || !scheduler.isScheduled()) {\n                scheduler.schedule();\n            }\n        }));\n        this._sessionDisposables.add(this._editor.onDidChangeModelContent((e) => {\n            // update less aggressive when typing\n            const delay = Math.max(scheduler.delay, 1250);\n            scheduler.schedule(delay);\n        }));\n        if (options.enabled === 'on') {\n            // different \"on\" modes: always\n            this._activeRenderMode = 0 /* RenderMode.Normal */;\n        }\n        else {\n            // different \"on\" modes: offUnlessPressed, or onUnlessPressed\n            let defaultMode;\n            let altMode;\n            if (options.enabled === 'onUnlessPressed') {\n                defaultMode = 0 /* RenderMode.Normal */;\n                altMode = 1 /* RenderMode.Invisible */;\n            }\n            else {\n                defaultMode = 1 /* RenderMode.Invisible */;\n                altMode = 0 /* RenderMode.Normal */;\n            }\n            this._activeRenderMode = defaultMode;\n            this._sessionDisposables.add(ModifierKeyEmitter.getInstance().event(e => {\n                if (!this._editor.hasModel()) {\n                    return;\n                }\n                const newRenderMode = e.altKey && e.ctrlKey && !(e.shiftKey || e.metaKey) ? altMode : defaultMode;\n                if (newRenderMode !== this._activeRenderMode) {\n                    this._activeRenderMode = newRenderMode;\n                    const model = this._editor.getModel();\n                    const copies = this._copyInlayHintsWithCurrentAnchor(model);\n                    this._updateHintsDecorators([model.getFullModelRange()], copies);\n                    scheduler.schedule(0);\n                }\n            }));\n        }\n        // mouse gestures\n        this._sessionDisposables.add(this._installDblClickGesture(() => scheduler.schedule(0)));\n        this._sessionDisposables.add(this._installLinkGesture());\n        this._sessionDisposables.add(this._installContextMenu());\n    }\n    _installLinkGesture() {\n        const store = new DisposableStore();\n        const gesture = store.add(new ClickLinkGesture(this._editor));\n        // let removeHighlight = () => { };\n        const sessionStore = new DisposableStore();\n        store.add(sessionStore);\n        store.add(gesture.onMouseMoveOrRelevantKeyDown(e => {\n            const [mouseEvent] = e;\n            const labelPart = this._getInlayHintLabelPart(mouseEvent);\n            const model = this._editor.getModel();\n            if (!labelPart || !model) {\n                sessionStore.clear();\n                return;\n            }\n            // resolve the item\n            const cts = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cts.dispose(true)));\n            labelPart.item.resolve(cts.token);\n            // render link => when the modifier is pressed and when there is a command or location\n            this._activeInlayHintPart = labelPart.part.command || labelPart.part.location\n                ? new ActiveInlayHintInfo(labelPart, mouseEvent.hasTriggerModifier)\n                : undefined;\n            const lineNumber = model.validatePosition(labelPart.item.hint.position).lineNumber;\n            const range = new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber));\n            const lineHints = this._getInlineHintsForRange(range);\n            this._updateHintsDecorators([range], lineHints);\n            sessionStore.add(toDisposable(() => {\n                this._activeInlayHintPart = undefined;\n                this._updateHintsDecorators([range], lineHints);\n            }));\n        }));\n        store.add(gesture.onCancel(() => sessionStore.clear()));\n        store.add(gesture.onExecute((e) => __awaiter(this, void 0, void 0, function* () {\n            const label = this._getInlayHintLabelPart(e);\n            if (label) {\n                const part = label.part;\n                if (part.location) {\n                    // location -> execute go to def\n                    this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, part.location);\n                }\n                else if (languages.Command.is(part.command)) {\n                    // command -> execute it\n                    yield this._invokeCommand(part.command, label.item);\n                }\n            }\n        })));\n        return store;\n    }\n    _getInlineHintsForRange(range) {\n        const lineHints = new Set();\n        for (const data of this._decorationsMetadata.values()) {\n            if (range.containsRange(data.item.anchor.range)) {\n                lineHints.add(data.item);\n            }\n        }\n        return Array.from(lineHints);\n    }\n    _installDblClickGesture(updateInlayHints) {\n        return this._editor.onMouseUp((e) => __awaiter(this, void 0, void 0, function* () {\n            if (e.event.detail !== 2) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (!part) {\n                return;\n            }\n            e.event.preventDefault();\n            yield part.item.resolve(CancellationToken.None);\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                const edits = part.item.hint.textEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text));\n                this._editor.executeEdits('inlayHint.default', edits);\n                updateInlayHints();\n            }\n        }));\n    }\n    _installContextMenu() {\n        return this._editor.onContextMenu((e) => __awaiter(this, void 0, void 0, function* () {\n            if (!(e.event.target instanceof HTMLElement)) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (part) {\n                yield this._instaService.invokeFunction(showGoToContextMenu, this._editor, e.event.target, part);\n            }\n        }));\n    }\n    _getInlayHintLabelPart(e) {\n        var _a;\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return undefined;\n        }\n        const options = (_a = e.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n        if (options instanceof ModelDecorationInjectedTextOptions && (options === null || options === void 0 ? void 0 : options.attachedData) instanceof RenderedInlayHintLabelPart) {\n            return options.attachedData;\n        }\n        return undefined;\n    }\n    _invokeCommand(command, item) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n            }\n            catch (err) {\n                this._notificationService.notify({\n                    severity: Severity.Error,\n                    source: item.provider.displayName,\n                    message: err\n                });\n            }\n        });\n    }\n    _cacheHintsForFastRestore(model) {\n        const hints = this._copyInlayHintsWithCurrentAnchor(model);\n        this._inlayHintsCache.set(model, hints);\n    }\n    // return inlay hints but with an anchor that reflects \"updates\"\n    // that happened after receiving them, e.g adding new lines before a hint\n    _copyInlayHintsWithCurrentAnchor(model) {\n        const items = new Map();\n        for (const [id, obj] of this._decorationsMetadata) {\n            if (items.has(obj.item)) {\n                // an inlay item can be rendered as multiple decorations\n                // but they will all uses the same range\n                continue;\n            }\n            const range = model.getDecorationRange(id);\n            if (range) {\n                // update range with whatever the editor has tweaked it to\n                const anchor = new InlayHintAnchor(range, obj.item.anchor.direction);\n                const copy = obj.item.with({ anchor });\n                items.set(obj.item, copy);\n            }\n        }\n        return Array.from(items.values());\n    }\n    _getHintsRanges() {\n        const extra = 30;\n        const model = this._editor.getModel();\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        const result = [];\n        for (const range of visibleRanges.sort(Range.compareRangesUsingStarts)) {\n            const extendedRange = model.validateRange(new Range(range.startLineNumber - extra, range.startColumn, range.endLineNumber + extra, range.endColumn));\n            if (result.length === 0 || !Range.areIntersectingOrTouching(result[result.length - 1], extendedRange)) {\n                result.push(extendedRange);\n            }\n            else {\n                result[result.length - 1] = Range.plusRange(result[result.length - 1], extendedRange);\n            }\n        }\n        return result;\n    }\n    _updateHintsDecorators(ranges, items) {\n        var _a, _b;\n        // utils to collect/create injected text decorations\n        const newDecorationsData = [];\n        const addInjectedText = (item, ref, content, cursorStops, attachedData) => {\n            const opts = {\n                content,\n                inlineClassNameAffectsLetterSpacing: true,\n                inlineClassName: ref.className,\n                cursorStops,\n                attachedData\n            };\n            newDecorationsData.push({\n                item,\n                classNameRef: ref,\n                decoration: {\n                    range: item.anchor.range,\n                    options: {\n                        // className: \"rangeHighlight\", // DEBUG highlight to see to what range a hint is attached\n                        description: 'InlayHint',\n                        showIfCollapsed: item.anchor.range.isEmpty(), // \"original\" range is empty\n                        collapseOnReplaceEdit: !item.anchor.range.isEmpty(),\n                        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n                        [item.anchor.direction]: this._activeRenderMode === 0 /* RenderMode.Normal */ ? opts : undefined\n                    }\n                }\n            });\n        };\n        const addInjectedWhitespace = (item, isLast) => {\n            const marginRule = this._ruleFactory.createClassNameRef({\n                width: `${(fontSize / 3) | 0}px`,\n                display: 'inline-block'\n            });\n            addInjectedText(item, marginRule, '\\u200a', isLast ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None);\n        };\n        //\n        const { fontSize, fontFamily, padding, isUniform } = this._getLayoutInfo();\n        const fontFamilyVar = '--code-editorInlayHintsFontFamily';\n        this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily);\n        for (const item of items) {\n            // whitespace leading the actual label\n            if (item.hint.paddingLeft) {\n                addInjectedWhitespace(item, false);\n            }\n            // the label with its parts\n            const parts = typeof item.hint.label === 'string'\n                ? [{ label: item.hint.label }]\n                : item.hint.label;\n            for (let i = 0; i < parts.length; i++) {\n                const part = parts[i];\n                const isFirst = i === 0;\n                const isLast = i === parts.length - 1;\n                const cssProperties = {\n                    fontSize: `${fontSize}px`,\n                    fontFamily: `var(${fontFamilyVar}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,\n                    verticalAlign: isUniform ? 'baseline' : 'middle',\n                    unicodeBidi: 'isolate'\n                };\n                if (isNonEmptyArray(item.hint.textEdits)) {\n                    cssProperties.cursor = 'default';\n                }\n                this._fillInColors(cssProperties, item.hint);\n                if ((part.command || part.location) && ((_a = this._activeInlayHintPart) === null || _a === void 0 ? void 0 : _a.part.item) === item && this._activeInlayHintPart.part.index === i) {\n                    // active link!\n                    cssProperties.textDecoration = 'underline';\n                    if (this._activeInlayHintPart.hasTriggerModifier) {\n                        cssProperties.color = themeColorFromId(colors.editorActiveLinkForeground);\n                        cssProperties.cursor = 'pointer';\n                    }\n                }\n                if (padding) {\n                    if (isFirst && isLast) {\n                        // only element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isFirst) {\n                        // first element\n                        cssProperties.padding = `1px 0 1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px 0 0 ${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isLast) {\n                        // last element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px 1px 0`;\n                        cssProperties.borderRadius = `0 ${(fontSize / 4) | 0}px ${(fontSize / 4) | 0}px 0`;\n                    }\n                    else {\n                        cssProperties.padding = `1px 0 1px 0`;\n                    }\n                }\n                addInjectedText(item, this._ruleFactory.createClassNameRef(cssProperties), fixSpace(part.label), isLast && !item.hint.paddingRight ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None, new RenderedInlayHintLabelPart(item, i));\n            }\n            // whitespace trailing the actual label\n            if (item.hint.paddingRight) {\n                addInjectedWhitespace(item, true);\n            }\n            if (newDecorationsData.length > InlayHintsController_1._MAX_DECORATORS) {\n                break;\n            }\n        }\n        // collect all decoration ids that are affected by the ranges\n        // and only update those decorations\n        const decorationIdsToReplace = [];\n        for (const range of ranges) {\n            for (const { id } of (_b = this._editor.getDecorationsInRange(range)) !== null && _b !== void 0 ? _b : []) {\n                const metadata = this._decorationsMetadata.get(id);\n                if (metadata) {\n                    decorationIdsToReplace.push(id);\n                    metadata.classNameRef.dispose();\n                    this._decorationsMetadata.delete(id);\n                }\n            }\n        }\n        const scrollState = StableEditorScrollState.capture(this._editor);\n        this._editor.changeDecorations(accessor => {\n            const newDecorationIds = accessor.deltaDecorations(decorationIdsToReplace, newDecorationsData.map(d => d.decoration));\n            for (let i = 0; i < newDecorationIds.length; i++) {\n                const data = newDecorationsData[i];\n                this._decorationsMetadata.set(newDecorationIds[i], data);\n            }\n        });\n        scrollState.restore(this._editor);\n    }\n    _fillInColors(props, hint) {\n        if (hint.kind === languages.InlayHintKind.Parameter) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintParameterBackground);\n            props.color = themeColorFromId(colors.editorInlayHintParameterForeground);\n        }\n        else if (hint.kind === languages.InlayHintKind.Type) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintTypeBackground);\n            props.color = themeColorFromId(colors.editorInlayHintTypeForeground);\n        }\n        else {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintBackground);\n            props.color = themeColorFromId(colors.editorInlayHintForeground);\n        }\n    }\n    _getLayoutInfo() {\n        const options = this._editor.getOption(139 /* EditorOption.inlayHints */);\n        const padding = options.padding;\n        const editorFontSize = this._editor.getOption(52 /* EditorOption.fontSize */);\n        const editorFontFamily = this._editor.getOption(49 /* EditorOption.fontFamily */);\n        let fontSize = options.fontSize;\n        if (!fontSize || fontSize < 5 || fontSize > editorFontSize) {\n            fontSize = editorFontSize;\n        }\n        const fontFamily = options.fontFamily || editorFontFamily;\n        const isUniform = !padding\n            && fontFamily === editorFontFamily\n            && fontSize === editorFontSize;\n        return { fontSize, fontFamily, padding, isUniform };\n    }\n    _removeAllDecorations() {\n        this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));\n        for (const obj of this._decorationsMetadata.values()) {\n            obj.classNameRef.dispose();\n        }\n        this._decorationsMetadata.clear();\n    }\n};\nInlayHintsController.ID = 'editor.contrib.InlayHints';\nInlayHintsController._MAX_DECORATORS = 1500;\nInlayHintsController = InlayHintsController_1 = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, IInlayHintsCache),\n    __param(4, ICommandService),\n    __param(5, INotificationService),\n    __param(6, IInstantiationService)\n], InlayHintsController);\nexport { InlayHintsController };\n// Prevents the view from potentially visible whitespace\nfunction fixSpace(str) {\n    const noBreakWhitespace = '\\xa0';\n    return str.replace(/[ \\t]/g, noBreakWhitespace);\n}\nCommandsRegistry.registerCommand('_executeInlayHintProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\n    const [uri, range] = args;\n    assertType(URI.isUri(uri));\n    assertType(Range.isIRange(range));\n    const { inlayHintsProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const model = yield InlayHintsFragments.create(inlayHintsProvider, ref.object.textEditorModel, [Range.lift(range)], CancellationToken.None);\n        const result = model.items.map(i => i.hint);\n        setTimeout(() => model.dispose(), 0); // dispose after sending to ext host\n        return result;\n    }\n    finally {\n        ref.dispose();\n    }\n}));\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}