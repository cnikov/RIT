{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './stickyScroll.css';\nimport { getColumnOfNodeOffset } from '../../../browser/viewParts/lines/viewLine.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { foldingCollapsedIcon, foldingExpandedIcon } from '../../folding/browser/foldingDecorations.js';\nexport class StickyScrollWidgetState {\n  constructor(startLineNumbers, endLineNumbers, lastLineRelativePosition, showEndForLine = null) {\n    this.startLineNumbers = startLineNumbers;\n    this.endLineNumbers = endLineNumbers;\n    this.lastLineRelativePosition = lastLineRelativePosition;\n    this.showEndForLine = showEndForLine;\n  }\n  equals(other) {\n    return !!other && this.lastLineRelativePosition === other.lastLineRelativePosition && this.showEndForLine === other.showEndForLine && equals(this.startLineNumbers, other.startLineNumbers) && equals(this.endLineNumbers, other.endLineNumbers);\n  }\n}\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', {\n  createHTML: value => value\n});\nconst STICKY_INDEX_ATTR = 'data-sticky-line-index';\nconst STICKY_IS_LINE_ATTR = 'data-sticky-is-line';\nconst STICKY_IS_LINE_NUMBER_ATTR = 'data-sticky-is-line-number';\nconst STICKY_IS_FOLDING_ICON_ATTR = 'data-sticky-is-folding-icon';\nexport class StickyScrollWidget extends Disposable {\n  constructor(_editor) {\n    super();\n    this._editor = _editor;\n    this._foldingIconStore = new DisposableStore();\n    this._rootDomNode = document.createElement('div');\n    this._lineNumbersDomNode = document.createElement('div');\n    this._linesDomNodeScrollable = document.createElement('div');\n    this._linesDomNode = document.createElement('div');\n    this._lineHeight = this._editor.getOption(66 /* EditorOption.lineHeight */);\n    this._stickyLines = [];\n    this._lineNumbers = [];\n    this._lastLineRelativePosition = 0;\n    this._minContentWidthInPx = 0;\n    this._isOnGlyphMargin = false;\n    this._lineNumbersDomNode.className = 'sticky-widget-line-numbers';\n    this._lineNumbersDomNode.setAttribute('role', 'none');\n    this._linesDomNode.className = 'sticky-widget-lines';\n    this._linesDomNode.setAttribute('role', 'list');\n    this._linesDomNodeScrollable.className = 'sticky-widget-lines-scrollable';\n    this._linesDomNodeScrollable.appendChild(this._linesDomNode);\n    this._rootDomNode.className = 'sticky-widget';\n    this._rootDomNode.classList.toggle('peek', _editor instanceof EmbeddedCodeEditorWidget);\n    this._rootDomNode.appendChild(this._lineNumbersDomNode);\n    this._rootDomNode.appendChild(this._linesDomNodeScrollable);\n    const updateScrollLeftPosition = () => {\n      this._linesDomNode.style.left = this._editor.getOption(114 /* EditorOption.stickyScroll */).scrollWithEditor ? `-${this._editor.getScrollLeft()}px` : '0px';\n    };\n    this._register(this._editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(114 /* EditorOption.stickyScroll */)) {\n        updateScrollLeftPosition();\n      }\n      if (e.hasChanged(66 /* EditorOption.lineHeight */)) {\n        this._lineHeight = this._editor.getOption(66 /* EditorOption.lineHeight */);\n      }\n    }));\n\n    this._register(this._editor.onDidScrollChange(e => {\n      if (e.scrollLeftChanged) {\n        updateScrollLeftPosition();\n      }\n      if (e.scrollWidthChanged) {\n        this._updateWidgetWidth();\n      }\n    }));\n    this._register(this._editor.onDidChangeModel(() => {\n      updateScrollLeftPosition();\n      this._updateWidgetWidth();\n    }));\n    this._register(this._foldingIconStore);\n    updateScrollLeftPosition();\n    this._register(this._editor.onDidLayoutChange(e => {\n      this._updateWidgetWidth();\n    }));\n    this._updateWidgetWidth();\n  }\n  get lineNumbers() {\n    return this._lineNumbers;\n  }\n  get lineNumberCount() {\n    return this._lineNumbers.length;\n  }\n  getStickyLineForLine(lineNumber) {\n    return this._stickyLines.find(stickyLine => stickyLine.lineNumber === lineNumber);\n  }\n  getCurrentLines() {\n    return this._lineNumbers;\n  }\n  setState(state, foldingModel, rebuildFromLine = Infinity) {\n    if ((!this._previousState && !state || this._previousState && this._previousState.equals(state)) && rebuildFromLine === Infinity) {\n      return;\n    }\n    this._previousState = state;\n    const previousStickyLines = this._stickyLines;\n    this._clearStickyWidget();\n    if (!state || !this._editor._getViewModel()) {\n      return;\n    }\n    const futureWidgetHeight = state.startLineNumbers.length * this._lineHeight + state.lastLineRelativePosition;\n    if (futureWidgetHeight > 0) {\n      this._lastLineRelativePosition = state.lastLineRelativePosition;\n      const lineNumbers = [...state.startLineNumbers];\n      if (state.showEndForLine !== null) {\n        lineNumbers[state.showEndForLine] = state.endLineNumbers[state.showEndForLine];\n      }\n      this._lineNumbers = lineNumbers;\n    } else {\n      this._lastLineRelativePosition = 0;\n      this._lineNumbers = [];\n    }\n    this._renderRootNode(previousStickyLines, foldingModel, rebuildFromLine);\n  }\n  _updateWidgetWidth() {\n    const layoutInfo = this._editor.getLayoutInfo();\n    const lineNumbersWidth = layoutInfo.contentLeft;\n    this._lineNumbersDomNode.style.width = `${lineNumbersWidth}px`;\n    this._linesDomNodeScrollable.style.setProperty('--vscode-editorStickyScroll-scrollableWidth', `${this._editor.getScrollWidth() - layoutInfo.verticalScrollbarWidth}px`);\n    this._rootDomNode.style.width = `${layoutInfo.width - layoutInfo.verticalScrollbarWidth}px`;\n  }\n  _clearStickyWidget() {\n    this._stickyLines = [];\n    this._foldingIconStore.clear();\n    dom.clearNode(this._lineNumbersDomNode);\n    dom.clearNode(this._linesDomNode);\n    this._rootDomNode.style.display = 'none';\n  }\n  _useFoldingOpacityTransition(requireTransitions) {\n    this._lineNumbersDomNode.style.setProperty('--vscode-editorStickyScroll-foldingOpacityTransition', `opacity ${requireTransitions ? 0.5 : 0}s`);\n  }\n  _setFoldingIconsVisibility(allVisible) {\n    for (const line of this._stickyLines) {\n      const foldingIcon = line.foldingIcon;\n      if (!foldingIcon) {\n        continue;\n      }\n      foldingIcon.setVisible(allVisible ? true : foldingIcon.isCollapsed);\n    }\n  }\n  _renderRootNode(previousStickyLines, foldingModel, rebuildFromLine = Infinity) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const layoutInfo = this._editor.getLayoutInfo();\n      for (const [index, line] of this._lineNumbers.entries()) {\n        const previousStickyLine = previousStickyLines[index];\n        const stickyLine = line >= rebuildFromLine || (previousStickyLine === null || previousStickyLine === void 0 ? void 0 : previousStickyLine.lineNumber) !== line ? this._renderChildNode(index, line, foldingModel, layoutInfo) : this._updateTopAndZIndexOfStickyLine(previousStickyLine);\n        if (!stickyLine) {\n          continue;\n        }\n        this._linesDomNode.appendChild(stickyLine.lineDomNode);\n        this._lineNumbersDomNode.appendChild(stickyLine.lineNumberDomNode);\n        this._stickyLines.push(stickyLine);\n      }\n      if (foldingModel) {\n        this._setFoldingHoverListeners();\n        this._useFoldingOpacityTransition(!this._isOnGlyphMargin);\n      }\n      const widgetHeight = this._lineNumbers.length * this._lineHeight + this._lastLineRelativePosition;\n      if (widgetHeight === 0) {\n        this._clearStickyWidget();\n        return;\n      }\n      this._rootDomNode.style.display = 'block';\n      this._lineNumbersDomNode.style.height = `${widgetHeight}px`;\n      this._linesDomNodeScrollable.style.height = `${widgetHeight}px`;\n      this._rootDomNode.style.height = `${widgetHeight}px`;\n      this._rootDomNode.style.marginLeft = '0px';\n      this._updateMinContentWidth();\n      this._editor.layoutOverlayWidget(this);\n    });\n  }\n  _setFoldingHoverListeners() {\n    const showFoldingControls = this._editor.getOption(109 /* EditorOption.showFoldingControls */);\n    if (showFoldingControls !== 'mouseover') {\n      return;\n    }\n    this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_ENTER, e => {\n      this._isOnGlyphMargin = true;\n      this._setFoldingIconsVisibility(true);\n    }));\n    this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_LEAVE, () => {\n      this._isOnGlyphMargin = false;\n      this._useFoldingOpacityTransition(true);\n      this._setFoldingIconsVisibility(false);\n    }));\n  }\n  _renderChildNode(index, line, foldingModel, layoutInfo) {\n    const viewModel = this._editor._getViewModel();\n    if (!viewModel) {\n      return;\n    }\n    const viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n    const lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n    const lineNumberOption = this._editor.getOption(67 /* EditorOption.lineNumbers */);\n    let actualInlineDecorations;\n    try {\n      actualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n    } catch (err) {\n      actualInlineDecorations = [];\n    }\n    const renderLineInput = new RenderLineInput(true, true, lineRenderingData.content, lineRenderingData.continuesWithWrappedLine, lineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0, lineRenderingData.tokens, actualInlineDecorations, lineRenderingData.tabSize, lineRenderingData.startVisibleColumn, 1, 1, 1, 500, 'none', true, true, null);\n    const sb = new StringBuilder(2000);\n    const renderOutput = renderViewLine(renderLineInput, sb);\n    let newLine;\n    if (_ttPolicy) {\n      newLine = _ttPolicy.createHTML(sb.build());\n    } else {\n      newLine = sb.build();\n    }\n    const lineHTMLNode = document.createElement('span');\n    lineHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n    lineHTMLNode.setAttribute(STICKY_IS_LINE_ATTR, '');\n    lineHTMLNode.setAttribute('role', 'listitem');\n    lineHTMLNode.tabIndex = 0;\n    lineHTMLNode.className = 'sticky-line-content';\n    lineHTMLNode.classList.add(`stickyLine${line}`);\n    lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n    lineHTMLNode.innerHTML = newLine;\n    const lineNumberHTMLNode = document.createElement('span');\n    lineNumberHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n    lineNumberHTMLNode.setAttribute(STICKY_IS_LINE_NUMBER_ATTR, '');\n    lineNumberHTMLNode.className = 'sticky-line-number';\n    lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n    const lineNumbersWidth = layoutInfo.contentLeft;\n    lineNumberHTMLNode.style.width = `${lineNumbersWidth}px`;\n    const innerLineNumberHTML = document.createElement('span');\n    if (lineNumberOption.renderType === 1 /* RenderLineNumbersType.On */ || lineNumberOption.renderType === 3 /* RenderLineNumbersType.Interval */ && line % 10 === 0) {\n      innerLineNumberHTML.innerText = line.toString();\n    } else if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n      innerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition().lineNumber).toString();\n    }\n    innerLineNumberHTML.className = 'sticky-line-number-inner';\n    innerLineNumberHTML.style.lineHeight = `${this._lineHeight}px`;\n    innerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n    innerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n    lineNumberHTMLNode.appendChild(innerLineNumberHTML);\n    const foldingIcon = this._renderFoldingIconForLine(foldingModel, line);\n    if (foldingIcon) {\n      lineNumberHTMLNode.appendChild(foldingIcon.domNode);\n    }\n    this._editor.applyFontInfo(lineHTMLNode);\n    this._editor.applyFontInfo(innerLineNumberHTML);\n    lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n    lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n    lineNumberHTMLNode.style.height = `${this._lineHeight}px`;\n    lineHTMLNode.style.height = `${this._lineHeight}px`;\n    const renderedLine = new RenderedStickyLine(index, line, lineHTMLNode, lineNumberHTMLNode, foldingIcon, renderOutput.characterMapping);\n    return this._updateTopAndZIndexOfStickyLine(renderedLine);\n  }\n  _updateTopAndZIndexOfStickyLine(stickyLine) {\n    var _a;\n    const index = stickyLine.index;\n    const lineHTMLNode = stickyLine.lineDomNode;\n    const lineNumberHTMLNode = stickyLine.lineNumberDomNode;\n    const isLastLine = index === this._lineNumbers.length - 1;\n    const lastLineZIndex = '0';\n    const intermediateLineZIndex = '1';\n    lineHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n    lineNumberHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n    const lastLineTop = `${index * this._lineHeight + this._lastLineRelativePosition + (((_a = stickyLine.foldingIcon) === null || _a === void 0 ? void 0 : _a.isCollapsed) ? 1 : 0)}px`;\n    const intermediateLineTop = `${index * this._lineHeight}px`;\n    lineHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n    lineNumberHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n    return stickyLine;\n  }\n  _renderFoldingIconForLine(foldingModel, line) {\n    const showFoldingControls = this._editor.getOption(109 /* EditorOption.showFoldingControls */);\n    if (!foldingModel || showFoldingControls === 'never') {\n      return;\n    }\n    const foldingRegions = foldingModel.regions;\n    const indexOfFoldingRegion = foldingRegions.findRange(line);\n    const startLineNumber = foldingRegions.getStartLineNumber(indexOfFoldingRegion);\n    const isFoldingScope = line === startLineNumber;\n    if (!isFoldingScope) {\n      return;\n    }\n    const isCollapsed = foldingRegions.isCollapsed(indexOfFoldingRegion);\n    const foldingIcon = new StickyFoldingIcon(isCollapsed, startLineNumber, foldingRegions.getEndLineNumber(indexOfFoldingRegion), this._lineHeight);\n    foldingIcon.setVisible(this._isOnGlyphMargin ? true : isCollapsed || showFoldingControls === 'always');\n    foldingIcon.domNode.setAttribute(STICKY_IS_FOLDING_ICON_ATTR, '');\n    return foldingIcon;\n  }\n  _updateMinContentWidth() {\n    this._minContentWidthInPx = 0;\n    for (const stickyLine of this._stickyLines) {\n      if (stickyLine.lineDomNode.scrollWidth > this._minContentWidthInPx) {\n        this._minContentWidthInPx = stickyLine.lineDomNode.scrollWidth;\n      }\n    }\n    this._minContentWidthInPx += this._editor.getLayoutInfo().verticalScrollbarWidth;\n  }\n  getId() {\n    return 'editor.contrib.stickyScrollWidget';\n  }\n  getDomNode() {\n    return this._rootDomNode;\n  }\n  getPosition() {\n    return {\n      preference: null\n    };\n  }\n  getMinContentWidthInPx() {\n    return this._minContentWidthInPx;\n  }\n  focusLineWithIndex(index) {\n    if (0 <= index && index < this._stickyLines.length) {\n      this._stickyLines[index].lineDomNode.focus();\n    }\n  }\n  /**\n   * Given a leaf dom node, tries to find the editor position.\n   */\n  getEditorPositionFromNode(spanDomNode) {\n    if (!spanDomNode || spanDomNode.children.length > 0) {\n      // This is not a leaf node\n      return null;\n    }\n    const renderedStickyLine = this._getRenderedStickyLineFromChildDomNode(spanDomNode);\n    if (!renderedStickyLine) {\n      return null;\n    }\n    const column = getColumnOfNodeOffset(renderedStickyLine.characterMapping, spanDomNode, 0);\n    return new Position(renderedStickyLine.lineNumber, column);\n  }\n  getLineNumberFromChildDomNode(domNode) {\n    var _a, _b;\n    return (_b = (_a = this._getRenderedStickyLineFromChildDomNode(domNode)) === null || _a === void 0 ? void 0 : _a.lineNumber) !== null && _b !== void 0 ? _b : null;\n  }\n  _getRenderedStickyLineFromChildDomNode(domNode) {\n    const index = this.getLineIndexFromChildDomNode(domNode);\n    if (index === null || index < 0 || index >= this._stickyLines.length) {\n      return null;\n    }\n    return this._stickyLines[index];\n  }\n  /**\n   * Given a child dom node, tries to find the line number attribute that was stored in the node.\n   * @returns the attribute value or null if none is found.\n   */\n  getLineIndexFromChildDomNode(domNode) {\n    const lineIndex = this._getAttributeValue(domNode, STICKY_INDEX_ATTR);\n    return lineIndex ? parseInt(lineIndex, 10) : null;\n  }\n  /**\n   * Given a child dom node, tries to find if it is (contained in) a sticky line.\n   * @returns a boolean.\n   */\n  isInStickyLine(domNode) {\n    const isInLine = this._getAttributeValue(domNode, STICKY_IS_LINE_ATTR);\n    return isInLine !== undefined;\n  }\n  /**\n   * Given a child dom node, tries to find if this dom node is (contained in) a sticky folding icon.\n   * @returns a boolean.\n   */\n  isInFoldingIconDomNode(domNode) {\n    const isInFoldingIcon = this._getAttributeValue(domNode, STICKY_IS_FOLDING_ICON_ATTR);\n    return isInFoldingIcon !== undefined;\n  }\n  /**\n   * Given the dom node, finds if it or its parent sequence contains the given attribute.\n   * @returns the attribute value or undefined.\n   */\n  _getAttributeValue(domNode, attribute) {\n    while (domNode && domNode !== this._rootDomNode) {\n      const line = domNode.getAttribute(attribute);\n      if (line !== null) {\n        return line;\n      }\n      domNode = domNode.parentElement;\n    }\n    return;\n  }\n}\nclass RenderedStickyLine {\n  constructor(index, lineNumber, lineDomNode, lineNumberDomNode, foldingIcon, characterMapping) {\n    this.index = index;\n    this.lineNumber = lineNumber;\n    this.lineDomNode = lineDomNode;\n    this.lineNumberDomNode = lineNumberDomNode;\n    this.foldingIcon = foldingIcon;\n    this.characterMapping = characterMapping;\n  }\n}\nclass StickyFoldingIcon {\n  constructor(isCollapsed, foldingStartLine, foldingEndLine, dimension) {\n    this.isCollapsed = isCollapsed;\n    this.foldingStartLine = foldingStartLine;\n    this.foldingEndLine = foldingEndLine;\n    this.dimension = dimension;\n    this.domNode = document.createElement('div');\n    this.domNode.style.width = `${dimension}px`;\n    this.domNode.style.height = `${dimension}px`;\n    this.domNode.className = ThemeIcon.asClassName(isCollapsed ? foldingCollapsedIcon : foldingExpandedIcon);\n  }\n  setVisible(visible) {\n    this.domNode.style.cursor = visible ? 'pointer' : 'default';\n    this.domNode.style.opacity = visible ? '1' : '0';\n  }\n}","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","dom","createTrustedTypesPolicy","equals","Disposable","DisposableStore","ThemeIcon","getColumnOfNodeOffset","EmbeddedCodeEditorWidget","Position","StringBuilder","LineDecoration","RenderLineInput","renderViewLine","foldingCollapsedIcon","foldingExpandedIcon","StickyScrollWidgetState","constructor","startLineNumbers","endLineNumbers","lastLineRelativePosition","showEndForLine","other","_ttPolicy","createHTML","STICKY_INDEX_ATTR","STICKY_IS_LINE_ATTR","STICKY_IS_LINE_NUMBER_ATTR","STICKY_IS_FOLDING_ICON_ATTR","StickyScrollWidget","_editor","_foldingIconStore","_rootDomNode","document","createElement","_lineNumbersDomNode","_linesDomNodeScrollable","_linesDomNode","_lineHeight","getOption","_stickyLines","_lineNumbers","_lastLineRelativePosition","_minContentWidthInPx","_isOnGlyphMargin","className","setAttribute","appendChild","classList","toggle","updateScrollLeftPosition","style","left","scrollWithEditor","getScrollLeft","_register","onDidChangeConfiguration","hasChanged","onDidScrollChange","scrollLeftChanged","scrollWidthChanged","_updateWidgetWidth","onDidChangeModel","onDidLayoutChange","lineNumbers","lineNumberCount","length","getStickyLineForLine","lineNumber","find","stickyLine","getCurrentLines","setState","state","foldingModel","rebuildFromLine","Infinity","_previousState","previousStickyLines","_clearStickyWidget","_getViewModel","futureWidgetHeight","_renderRootNode","layoutInfo","getLayoutInfo","lineNumbersWidth","contentLeft","width","setProperty","getScrollWidth","verticalScrollbarWidth","clear","clearNode","display","_useFoldingOpacityTransition","requireTransitions","_setFoldingIconsVisibility","allVisible","line","foldingIcon","setVisible","isCollapsed","index","entries","previousStickyLine","_renderChildNode","_updateTopAndZIndexOfStickyLine","lineDomNode","lineNumberDomNode","push","_setFoldingHoverListeners","widgetHeight","height","marginLeft","_updateMinContentWidth","layoutOverlayWidget","showFoldingControls","add","addDisposableListener","EventType","MOUSE_ENTER","MOUSE_LEAVE","viewModel","viewLineNumber","coordinatesConverter","convertModelPositionToViewPosition","lineRenderingData","getViewLineRenderingData","lineNumberOption","actualInlineDecorations","filter","inlineDecorations","minColumn","maxColumn","err","renderLineInput","content","continuesWithWrappedLine","isBasicASCII","containsRTL","tokens","tabSize","startVisibleColumn","sb","renderOutput","newLine","build","lineHTMLNode","String","tabIndex","lineHeight","innerHTML","lineNumberHTMLNode","innerLineNumberHTML","renderType","innerText","toString","Math","abs","getPosition","paddingLeft","lineNumbersLeft","_renderFoldingIconForLine","domNode","applyFontInfo","renderedLine","RenderedStickyLine","characterMapping","_a","isLastLine","lastLineZIndex","intermediateLineZIndex","zIndex","lastLineTop","intermediateLineTop","top","foldingRegions","regions","indexOfFoldingRegion","findRange","startLineNumber","getStartLineNumber","isFoldingScope","StickyFoldingIcon","getEndLineNumber","scrollWidth","getId","getDomNode","preference","getMinContentWidthInPx","focusLineWithIndex","focus","getEditorPositionFromNode","spanDomNode","children","renderedStickyLine","_getRenderedStickyLineFromChildDomNode","column","getLineNumberFromChildDomNode","_b","getLineIndexFromChildDomNode","lineIndex","_getAttributeValue","parseInt","isInStickyLine","isInLine","undefined","isInFoldingIconDomNode","isInFoldingIcon","attribute","getAttribute","parentElement","foldingStartLine","foldingEndLine","dimension","asClassName","visible","cursor","opacity"],"sources":["/home/chlohest/work/website/my_web/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './stickyScroll.css';\nimport { getColumnOfNodeOffset } from '../../../browser/viewParts/lines/viewLine.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { foldingCollapsedIcon, foldingExpandedIcon } from '../../folding/browser/foldingDecorations.js';\nexport class StickyScrollWidgetState {\n    constructor(startLineNumbers, endLineNumbers, lastLineRelativePosition, showEndForLine = null) {\n        this.startLineNumbers = startLineNumbers;\n        this.endLineNumbers = endLineNumbers;\n        this.lastLineRelativePosition = lastLineRelativePosition;\n        this.showEndForLine = showEndForLine;\n    }\n    equals(other) {\n        return !!other\n            && this.lastLineRelativePosition === other.lastLineRelativePosition\n            && this.showEndForLine === other.showEndForLine\n            && equals(this.startLineNumbers, other.startLineNumbers)\n            && equals(this.endLineNumbers, other.endLineNumbers);\n    }\n}\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', { createHTML: value => value });\nconst STICKY_INDEX_ATTR = 'data-sticky-line-index';\nconst STICKY_IS_LINE_ATTR = 'data-sticky-is-line';\nconst STICKY_IS_LINE_NUMBER_ATTR = 'data-sticky-is-line-number';\nconst STICKY_IS_FOLDING_ICON_ATTR = 'data-sticky-is-folding-icon';\nexport class StickyScrollWidget extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._foldingIconStore = new DisposableStore();\n        this._rootDomNode = document.createElement('div');\n        this._lineNumbersDomNode = document.createElement('div');\n        this._linesDomNodeScrollable = document.createElement('div');\n        this._linesDomNode = document.createElement('div');\n        this._lineHeight = this._editor.getOption(66 /* EditorOption.lineHeight */);\n        this._stickyLines = [];\n        this._lineNumbers = [];\n        this._lastLineRelativePosition = 0;\n        this._minContentWidthInPx = 0;\n        this._isOnGlyphMargin = false;\n        this._lineNumbersDomNode.className = 'sticky-widget-line-numbers';\n        this._lineNumbersDomNode.setAttribute('role', 'none');\n        this._linesDomNode.className = 'sticky-widget-lines';\n        this._linesDomNode.setAttribute('role', 'list');\n        this._linesDomNodeScrollable.className = 'sticky-widget-lines-scrollable';\n        this._linesDomNodeScrollable.appendChild(this._linesDomNode);\n        this._rootDomNode.className = 'sticky-widget';\n        this._rootDomNode.classList.toggle('peek', _editor instanceof EmbeddedCodeEditorWidget);\n        this._rootDomNode.appendChild(this._lineNumbersDomNode);\n        this._rootDomNode.appendChild(this._linesDomNodeScrollable);\n        const updateScrollLeftPosition = () => {\n            this._linesDomNode.style.left = this._editor.getOption(114 /* EditorOption.stickyScroll */).scrollWithEditor ? `-${this._editor.getScrollLeft()}px` : '0px';\n        };\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(114 /* EditorOption.stickyScroll */)) {\n                updateScrollLeftPosition();\n            }\n            if (e.hasChanged(66 /* EditorOption.lineHeight */)) {\n                this._lineHeight = this._editor.getOption(66 /* EditorOption.lineHeight */);\n            }\n        }));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollLeftChanged) {\n                updateScrollLeftPosition();\n            }\n            if (e.scrollWidthChanged) {\n                this._updateWidgetWidth();\n            }\n        }));\n        this._register(this._editor.onDidChangeModel(() => {\n            updateScrollLeftPosition();\n            this._updateWidgetWidth();\n        }));\n        this._register(this._foldingIconStore);\n        updateScrollLeftPosition();\n        this._register(this._editor.onDidLayoutChange((e) => {\n            this._updateWidgetWidth();\n        }));\n        this._updateWidgetWidth();\n    }\n    get lineNumbers() {\n        return this._lineNumbers;\n    }\n    get lineNumberCount() {\n        return this._lineNumbers.length;\n    }\n    getStickyLineForLine(lineNumber) {\n        return this._stickyLines.find(stickyLine => stickyLine.lineNumber === lineNumber);\n    }\n    getCurrentLines() {\n        return this._lineNumbers;\n    }\n    setState(state, foldingModel, rebuildFromLine = Infinity) {\n        if (((!this._previousState && !state) || (this._previousState && this._previousState.equals(state)))\n            && rebuildFromLine === Infinity) {\n            return;\n        }\n        this._previousState = state;\n        const previousStickyLines = this._stickyLines;\n        this._clearStickyWidget();\n        if (!state || !this._editor._getViewModel()) {\n            return;\n        }\n        const futureWidgetHeight = state.startLineNumbers.length * this._lineHeight + state.lastLineRelativePosition;\n        if (futureWidgetHeight > 0) {\n            this._lastLineRelativePosition = state.lastLineRelativePosition;\n            const lineNumbers = [...state.startLineNumbers];\n            if (state.showEndForLine !== null) {\n                lineNumbers[state.showEndForLine] = state.endLineNumbers[state.showEndForLine];\n            }\n            this._lineNumbers = lineNumbers;\n        }\n        else {\n            this._lastLineRelativePosition = 0;\n            this._lineNumbers = [];\n        }\n        this._renderRootNode(previousStickyLines, foldingModel, rebuildFromLine);\n    }\n    _updateWidgetWidth() {\n        const layoutInfo = this._editor.getLayoutInfo();\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        this._lineNumbersDomNode.style.width = `${lineNumbersWidth}px`;\n        this._linesDomNodeScrollable.style.setProperty('--vscode-editorStickyScroll-scrollableWidth', `${this._editor.getScrollWidth() - layoutInfo.verticalScrollbarWidth}px`);\n        this._rootDomNode.style.width = `${layoutInfo.width - layoutInfo.verticalScrollbarWidth}px`;\n    }\n    _clearStickyWidget() {\n        this._stickyLines = [];\n        this._foldingIconStore.clear();\n        dom.clearNode(this._lineNumbersDomNode);\n        dom.clearNode(this._linesDomNode);\n        this._rootDomNode.style.display = 'none';\n    }\n    _useFoldingOpacityTransition(requireTransitions) {\n        this._lineNumbersDomNode.style.setProperty('--vscode-editorStickyScroll-foldingOpacityTransition', `opacity ${requireTransitions ? 0.5 : 0}s`);\n    }\n    _setFoldingIconsVisibility(allVisible) {\n        for (const line of this._stickyLines) {\n            const foldingIcon = line.foldingIcon;\n            if (!foldingIcon) {\n                continue;\n            }\n            foldingIcon.setVisible(allVisible ? true : foldingIcon.isCollapsed);\n        }\n    }\n    _renderRootNode(previousStickyLines, foldingModel, rebuildFromLine = Infinity) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const layoutInfo = this._editor.getLayoutInfo();\n            for (const [index, line] of this._lineNumbers.entries()) {\n                const previousStickyLine = previousStickyLines[index];\n                const stickyLine = (line >= rebuildFromLine || (previousStickyLine === null || previousStickyLine === void 0 ? void 0 : previousStickyLine.lineNumber) !== line)\n                    ? this._renderChildNode(index, line, foldingModel, layoutInfo)\n                    : this._updateTopAndZIndexOfStickyLine(previousStickyLine);\n                if (!stickyLine) {\n                    continue;\n                }\n                this._linesDomNode.appendChild(stickyLine.lineDomNode);\n                this._lineNumbersDomNode.appendChild(stickyLine.lineNumberDomNode);\n                this._stickyLines.push(stickyLine);\n            }\n            if (foldingModel) {\n                this._setFoldingHoverListeners();\n                this._useFoldingOpacityTransition(!this._isOnGlyphMargin);\n            }\n            const widgetHeight = this._lineNumbers.length * this._lineHeight + this._lastLineRelativePosition;\n            if (widgetHeight === 0) {\n                this._clearStickyWidget();\n                return;\n            }\n            this._rootDomNode.style.display = 'block';\n            this._lineNumbersDomNode.style.height = `${widgetHeight}px`;\n            this._linesDomNodeScrollable.style.height = `${widgetHeight}px`;\n            this._rootDomNode.style.height = `${widgetHeight}px`;\n            this._rootDomNode.style.marginLeft = '0px';\n            this._updateMinContentWidth();\n            this._editor.layoutOverlayWidget(this);\n        });\n    }\n    _setFoldingHoverListeners() {\n        const showFoldingControls = this._editor.getOption(109 /* EditorOption.showFoldingControls */);\n        if (showFoldingControls !== 'mouseover') {\n            return;\n        }\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_ENTER, (e) => {\n            this._isOnGlyphMargin = true;\n            this._setFoldingIconsVisibility(true);\n        }));\n        this._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_LEAVE, () => {\n            this._isOnGlyphMargin = false;\n            this._useFoldingOpacityTransition(true);\n            this._setFoldingIconsVisibility(false);\n        }));\n    }\n    _renderChildNode(index, line, foldingModel, layoutInfo) {\n        const viewModel = this._editor._getViewModel();\n        if (!viewModel) {\n            return;\n        }\n        const viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n        const lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n        const lineNumberOption = this._editor.getOption(67 /* EditorOption.lineNumbers */);\n        let actualInlineDecorations;\n        try {\n            actualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n        }\n        catch (err) {\n            actualInlineDecorations = [];\n        }\n        const renderLineInput = new RenderLineInput(true, true, lineRenderingData.content, lineRenderingData.continuesWithWrappedLine, lineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0, lineRenderingData.tokens, actualInlineDecorations, lineRenderingData.tabSize, lineRenderingData.startVisibleColumn, 1, 1, 1, 500, 'none', true, true, null);\n        const sb = new StringBuilder(2000);\n        const renderOutput = renderViewLine(renderLineInput, sb);\n        let newLine;\n        if (_ttPolicy) {\n            newLine = _ttPolicy.createHTML(sb.build());\n        }\n        else {\n            newLine = sb.build();\n        }\n        const lineHTMLNode = document.createElement('span');\n        lineHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineHTMLNode.setAttribute(STICKY_IS_LINE_ATTR, '');\n        lineHTMLNode.setAttribute('role', 'listitem');\n        lineHTMLNode.tabIndex = 0;\n        lineHTMLNode.className = 'sticky-line-content';\n        lineHTMLNode.classList.add(`stickyLine${line}`);\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.innerHTML = newLine;\n        const lineNumberHTMLNode = document.createElement('span');\n        lineNumberHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n        lineNumberHTMLNode.setAttribute(STICKY_IS_LINE_NUMBER_ATTR, '');\n        lineNumberHTMLNode.className = 'sticky-line-number';\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        const lineNumbersWidth = layoutInfo.contentLeft;\n        lineNumberHTMLNode.style.width = `${lineNumbersWidth}px`;\n        const innerLineNumberHTML = document.createElement('span');\n        if (lineNumberOption.renderType === 1 /* RenderLineNumbersType.On */ || lineNumberOption.renderType === 3 /* RenderLineNumbersType.Interval */ && line % 10 === 0) {\n            innerLineNumberHTML.innerText = line.toString();\n        }\n        else if (lineNumberOption.renderType === 2 /* RenderLineNumbersType.Relative */) {\n            innerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition().lineNumber).toString();\n        }\n        innerLineNumberHTML.className = 'sticky-line-number-inner';\n        innerLineNumberHTML.style.lineHeight = `${this._lineHeight}px`;\n        innerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n        innerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n        lineNumberHTMLNode.appendChild(innerLineNumberHTML);\n        const foldingIcon = this._renderFoldingIconForLine(foldingModel, line);\n        if (foldingIcon) {\n            lineNumberHTMLNode.appendChild(foldingIcon.domNode);\n        }\n        this._editor.applyFontInfo(lineHTMLNode);\n        this._editor.applyFontInfo(innerLineNumberHTML);\n        lineNumberHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineHTMLNode.style.lineHeight = `${this._lineHeight}px`;\n        lineNumberHTMLNode.style.height = `${this._lineHeight}px`;\n        lineHTMLNode.style.height = `${this._lineHeight}px`;\n        const renderedLine = new RenderedStickyLine(index, line, lineHTMLNode, lineNumberHTMLNode, foldingIcon, renderOutput.characterMapping);\n        return this._updateTopAndZIndexOfStickyLine(renderedLine);\n    }\n    _updateTopAndZIndexOfStickyLine(stickyLine) {\n        var _a;\n        const index = stickyLine.index;\n        const lineHTMLNode = stickyLine.lineDomNode;\n        const lineNumberHTMLNode = stickyLine.lineNumberDomNode;\n        const isLastLine = index === this._lineNumbers.length - 1;\n        const lastLineZIndex = '0';\n        const intermediateLineZIndex = '1';\n        lineHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        lineNumberHTMLNode.style.zIndex = isLastLine ? lastLineZIndex : intermediateLineZIndex;\n        const lastLineTop = `${index * this._lineHeight + this._lastLineRelativePosition + (((_a = stickyLine.foldingIcon) === null || _a === void 0 ? void 0 : _a.isCollapsed) ? 1 : 0)}px`;\n        const intermediateLineTop = `${index * this._lineHeight}px`;\n        lineHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        lineNumberHTMLNode.style.top = isLastLine ? lastLineTop : intermediateLineTop;\n        return stickyLine;\n    }\n    _renderFoldingIconForLine(foldingModel, line) {\n        const showFoldingControls = this._editor.getOption(109 /* EditorOption.showFoldingControls */);\n        if (!foldingModel || showFoldingControls === 'never') {\n            return;\n        }\n        const foldingRegions = foldingModel.regions;\n        const indexOfFoldingRegion = foldingRegions.findRange(line);\n        const startLineNumber = foldingRegions.getStartLineNumber(indexOfFoldingRegion);\n        const isFoldingScope = line === startLineNumber;\n        if (!isFoldingScope) {\n            return;\n        }\n        const isCollapsed = foldingRegions.isCollapsed(indexOfFoldingRegion);\n        const foldingIcon = new StickyFoldingIcon(isCollapsed, startLineNumber, foldingRegions.getEndLineNumber(indexOfFoldingRegion), this._lineHeight);\n        foldingIcon.setVisible(this._isOnGlyphMargin ? true : (isCollapsed || showFoldingControls === 'always'));\n        foldingIcon.domNode.setAttribute(STICKY_IS_FOLDING_ICON_ATTR, '');\n        return foldingIcon;\n    }\n    _updateMinContentWidth() {\n        this._minContentWidthInPx = 0;\n        for (const stickyLine of this._stickyLines) {\n            if (stickyLine.lineDomNode.scrollWidth > this._minContentWidthInPx) {\n                this._minContentWidthInPx = stickyLine.lineDomNode.scrollWidth;\n            }\n        }\n        this._minContentWidthInPx += this._editor.getLayoutInfo().verticalScrollbarWidth;\n    }\n    getId() {\n        return 'editor.contrib.stickyScrollWidget';\n    }\n    getDomNode() {\n        return this._rootDomNode;\n    }\n    getPosition() {\n        return {\n            preference: null\n        };\n    }\n    getMinContentWidthInPx() {\n        return this._minContentWidthInPx;\n    }\n    focusLineWithIndex(index) {\n        if (0 <= index && index < this._stickyLines.length) {\n            this._stickyLines[index].lineDomNode.focus();\n        }\n    }\n    /**\n     * Given a leaf dom node, tries to find the editor position.\n     */\n    getEditorPositionFromNode(spanDomNode) {\n        if (!spanDomNode || spanDomNode.children.length > 0) {\n            // This is not a leaf node\n            return null;\n        }\n        const renderedStickyLine = this._getRenderedStickyLineFromChildDomNode(spanDomNode);\n        if (!renderedStickyLine) {\n            return null;\n        }\n        const column = getColumnOfNodeOffset(renderedStickyLine.characterMapping, spanDomNode, 0);\n        return new Position(renderedStickyLine.lineNumber, column);\n    }\n    getLineNumberFromChildDomNode(domNode) {\n        var _a, _b;\n        return (_b = (_a = this._getRenderedStickyLineFromChildDomNode(domNode)) === null || _a === void 0 ? void 0 : _a.lineNumber) !== null && _b !== void 0 ? _b : null;\n    }\n    _getRenderedStickyLineFromChildDomNode(domNode) {\n        const index = this.getLineIndexFromChildDomNode(domNode);\n        if (index === null || index < 0 || index >= this._stickyLines.length) {\n            return null;\n        }\n        return this._stickyLines[index];\n    }\n    /**\n     * Given a child dom node, tries to find the line number attribute that was stored in the node.\n     * @returns the attribute value or null if none is found.\n     */\n    getLineIndexFromChildDomNode(domNode) {\n        const lineIndex = this._getAttributeValue(domNode, STICKY_INDEX_ATTR);\n        return lineIndex ? parseInt(lineIndex, 10) : null;\n    }\n    /**\n     * Given a child dom node, tries to find if it is (contained in) a sticky line.\n     * @returns a boolean.\n     */\n    isInStickyLine(domNode) {\n        const isInLine = this._getAttributeValue(domNode, STICKY_IS_LINE_ATTR);\n        return isInLine !== undefined;\n    }\n    /**\n     * Given a child dom node, tries to find if this dom node is (contained in) a sticky folding icon.\n     * @returns a boolean.\n     */\n    isInFoldingIconDomNode(domNode) {\n        const isInFoldingIcon = this._getAttributeValue(domNode, STICKY_IS_FOLDING_ICON_ATTR);\n        return isInFoldingIcon !== undefined;\n    }\n    /**\n     * Given the dom node, finds if it or its parent sequence contains the given attribute.\n     * @returns the attribute value or undefined.\n     */\n    _getAttributeValue(domNode, attribute) {\n        while (domNode && domNode !== this._rootDomNode) {\n            const line = domNode.getAttribute(attribute);\n            if (line !== null) {\n                return line;\n            }\n            domNode = domNode.parentElement;\n        }\n        return;\n    }\n}\nclass RenderedStickyLine {\n    constructor(index, lineNumber, lineDomNode, lineNumberDomNode, foldingIcon, characterMapping) {\n        this.index = index;\n        this.lineNumber = lineNumber;\n        this.lineDomNode = lineDomNode;\n        this.lineNumberDomNode = lineNumberDomNode;\n        this.foldingIcon = foldingIcon;\n        this.characterMapping = characterMapping;\n    }\n}\nclass StickyFoldingIcon {\n    constructor(isCollapsed, foldingStartLine, foldingEndLine, dimension) {\n        this.isCollapsed = isCollapsed;\n        this.foldingStartLine = foldingStartLine;\n        this.foldingEndLine = foldingEndLine;\n        this.dimension = dimension;\n        this.domNode = document.createElement('div');\n        this.domNode.style.width = `${dimension}px`;\n        this.domNode.style.height = `${dimension}px`;\n        this.domNode.className = ThemeIcon.asClassName(isCollapsed ? foldingCollapsedIcon : foldingExpandedIcon);\n    }\n    setVisible(visible) {\n        this.domNode.style.cursor = visible ? 'pointer' : 'default';\n        this.domNode.style.opacity = visible ? '1' : '0';\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}