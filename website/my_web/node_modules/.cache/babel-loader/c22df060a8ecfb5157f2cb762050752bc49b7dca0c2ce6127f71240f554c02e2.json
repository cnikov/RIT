{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport { PauseableEmitter } from '../../../base/common/event.js';\nimport { Iterable } from '../../../base/common/iterator.js';\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { cloneAndChange } from '../../../base/common/objects.js';\nimport { TernarySearchTree } from '../../../base/common/ternarySearchTree.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { localize } from '../../../nls.js';\nimport { CommandsRegistry } from '../../commands/common/commands.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IContextKeyService, RawContextKey } from '../common/contextkey.js';\nconst KEYBINDING_CONTEXT_ATTR = 'data-keybinding-context';\nexport class Context {\n  constructor(id, parent) {\n    this._id = id;\n    this._parent = parent;\n    this._value = Object.create(null);\n    this._value['_contextId'] = id;\n  }\n  get value() {\n    return Object.assign({}, this._value);\n  }\n  setValue(key, value) {\n    // console.log('SET ' + key + ' = ' + value + ' ON ' + this._id);\n    if (this._value[key] !== value) {\n      this._value[key] = value;\n      return true;\n    }\n    return false;\n  }\n  removeValue(key) {\n    // console.log('REMOVE ' + key + ' FROM ' + this._id);\n    if (key in this._value) {\n      delete this._value[key];\n      return true;\n    }\n    return false;\n  }\n  getValue(key) {\n    const ret = this._value[key];\n    if (typeof ret === 'undefined' && this._parent) {\n      return this._parent.getValue(key);\n    }\n    return ret;\n  }\n}\nclass NullContext extends Context {\n  constructor() {\n    super(-1, null);\n  }\n  setValue(key, value) {\n    return false;\n  }\n  removeValue(key) {\n    return false;\n  }\n  getValue(key) {\n    return undefined;\n  }\n}\nNullContext.INSTANCE = new NullContext();\nclass ConfigAwareContextValuesContainer extends Context {\n  constructor(id, _configurationService, emitter) {\n    super(id, null);\n    this._configurationService = _configurationService;\n    this._values = TernarySearchTree.forConfigKeys();\n    this._listener = this._configurationService.onDidChangeConfiguration(event => {\n      if (event.source === 7 /* ConfigurationTarget.DEFAULT */) {\n        // new setting, reset everything\n        const allKeys = Array.from(this._values, ([k]) => k);\n        this._values.clear();\n        emitter.fire(new ArrayContextKeyChangeEvent(allKeys));\n      } else {\n        const changedKeys = [];\n        for (const configKey of event.affectedKeys) {\n          const contextKey = `config.${configKey}`;\n          const cachedItems = this._values.findSuperstr(contextKey);\n          if (cachedItems !== undefined) {\n            changedKeys.push(...Iterable.map(cachedItems, ([key]) => key));\n            this._values.deleteSuperstr(contextKey);\n          }\n          if (this._values.has(contextKey)) {\n            changedKeys.push(contextKey);\n            this._values.delete(contextKey);\n          }\n        }\n        emitter.fire(new ArrayContextKeyChangeEvent(changedKeys));\n      }\n    });\n  }\n  dispose() {\n    this._listener.dispose();\n  }\n  getValue(key) {\n    if (key.indexOf(ConfigAwareContextValuesContainer._keyPrefix) !== 0) {\n      return super.getValue(key);\n    }\n    if (this._values.has(key)) {\n      return this._values.get(key);\n    }\n    const configKey = key.substr(ConfigAwareContextValuesContainer._keyPrefix.length);\n    const configValue = this._configurationService.getValue(configKey);\n    let value = undefined;\n    switch (typeof configValue) {\n      case 'number':\n      case 'boolean':\n      case 'string':\n        value = configValue;\n        break;\n      default:\n        if (Array.isArray(configValue)) {\n          value = JSON.stringify(configValue);\n        } else {\n          value = configValue;\n        }\n    }\n    this._values.set(key, value);\n    return value;\n  }\n  setValue(key, value) {\n    return super.setValue(key, value);\n  }\n  removeValue(key) {\n    return super.removeValue(key);\n  }\n}\nConfigAwareContextValuesContainer._keyPrefix = 'config.';\nclass ContextKey {\n  constructor(service, key, defaultValue) {\n    this._service = service;\n    this._key = key;\n    this._defaultValue = defaultValue;\n    this.reset();\n  }\n  set(value) {\n    this._service.setContext(this._key, value);\n  }\n  reset() {\n    if (typeof this._defaultValue === 'undefined') {\n      this._service.removeContext(this._key);\n    } else {\n      this._service.setContext(this._key, this._defaultValue);\n    }\n  }\n  get() {\n    return this._service.getContextKeyValue(this._key);\n  }\n}\nclass SimpleContextKeyChangeEvent {\n  constructor(key) {\n    this.key = key;\n  }\n  affectsSome(keys) {\n    return keys.has(this.key);\n  }\n  allKeysContainedIn(keys) {\n    return this.affectsSome(keys);\n  }\n}\nclass ArrayContextKeyChangeEvent {\n  constructor(keys) {\n    this.keys = keys;\n  }\n  affectsSome(keys) {\n    for (const key of this.keys) {\n      if (keys.has(key)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  allKeysContainedIn(keys) {\n    return this.keys.every(key => keys.has(key));\n  }\n}\nclass CompositeContextKeyChangeEvent {\n  constructor(events) {\n    this.events = events;\n  }\n  affectsSome(keys) {\n    for (const e of this.events) {\n      if (e.affectsSome(keys)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  allKeysContainedIn(keys) {\n    return this.events.every(evt => evt.allKeysContainedIn(keys));\n  }\n}\nfunction allEventKeysInContext(event, context) {\n  return event.allKeysContainedIn(new Set(Object.keys(context)));\n}\nexport class AbstractContextKeyService extends Disposable {\n  constructor(myContextId) {\n    super();\n    this._onDidChangeContext = this._register(new PauseableEmitter({\n      merge: input => new CompositeContextKeyChangeEvent(input)\n    }));\n    this.onDidChangeContext = this._onDidChangeContext.event;\n    this._isDisposed = false;\n    this._myContextId = myContextId;\n  }\n  createKey(key, defaultValue) {\n    if (this._isDisposed) {\n      throw new Error(`AbstractContextKeyService has been disposed`);\n    }\n    return new ContextKey(this, key, defaultValue);\n  }\n  bufferChangeEvents(callback) {\n    this._onDidChangeContext.pause();\n    try {\n      callback();\n    } finally {\n      this._onDidChangeContext.resume();\n    }\n  }\n  createScoped(domNode) {\n    if (this._isDisposed) {\n      throw new Error(`AbstractContextKeyService has been disposed`);\n    }\n    return new ScopedContextKeyService(this, domNode);\n  }\n  contextMatchesRules(rules) {\n    if (this._isDisposed) {\n      throw new Error(`AbstractContextKeyService has been disposed`);\n    }\n    const context = this.getContextValuesContainer(this._myContextId);\n    const result = rules ? rules.evaluate(context) : true;\n    // console.group(rules.serialize() + ' -> ' + result);\n    // rules.keys().forEach(key => { console.log(key, ctx[key]); });\n    // console.groupEnd();\n    return result;\n  }\n  getContextKeyValue(key) {\n    if (this._isDisposed) {\n      return undefined;\n    }\n    return this.getContextValuesContainer(this._myContextId).getValue(key);\n  }\n  setContext(key, value) {\n    if (this._isDisposed) {\n      return;\n    }\n    const myContext = this.getContextValuesContainer(this._myContextId);\n    if (!myContext) {\n      return;\n    }\n    if (myContext.setValue(key, value)) {\n      this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key));\n    }\n  }\n  removeContext(key) {\n    if (this._isDisposed) {\n      return;\n    }\n    if (this.getContextValuesContainer(this._myContextId).removeValue(key)) {\n      this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key));\n    }\n  }\n  getContext(target) {\n    if (this._isDisposed) {\n      return NullContext.INSTANCE;\n    }\n    return this.getContextValuesContainer(findContextAttr(target));\n  }\n  dispose() {\n    super.dispose();\n    this._isDisposed = true;\n  }\n}\nlet ContextKeyService = class ContextKeyService extends AbstractContextKeyService {\n  constructor(configurationService) {\n    super(0);\n    this._contexts = new Map();\n    this._lastContextId = 0;\n    const myContext = this._register(new ConfigAwareContextValuesContainer(this._myContextId, configurationService, this._onDidChangeContext));\n    this._contexts.set(this._myContextId, myContext);\n    // Uncomment this to see the contexts continuously logged\n    // let lastLoggedValue: string | null = null;\n    // setInterval(() => {\n    // \tlet values = Object.keys(this._contexts).map((key) => this._contexts[key]);\n    // \tlet logValue = values.map(v => JSON.stringify(v._value, null, '\\t')).join('\\n');\n    // \tif (lastLoggedValue !== logValue) {\n    // \t\tlastLoggedValue = logValue;\n    // \t\tconsole.log(lastLoggedValue);\n    // \t}\n    // }, 2000);\n  }\n\n  getContextValuesContainer(contextId) {\n    if (this._isDisposed) {\n      return NullContext.INSTANCE;\n    }\n    return this._contexts.get(contextId) || NullContext.INSTANCE;\n  }\n  createChildContext(parentContextId = this._myContextId) {\n    if (this._isDisposed) {\n      throw new Error(`ContextKeyService has been disposed`);\n    }\n    const id = ++this._lastContextId;\n    this._contexts.set(id, new Context(id, this.getContextValuesContainer(parentContextId)));\n    return id;\n  }\n  disposeContext(contextId) {\n    if (!this._isDisposed) {\n      this._contexts.delete(contextId);\n    }\n  }\n};\nContextKeyService = __decorate([__param(0, IConfigurationService)], ContextKeyService);\nexport { ContextKeyService };\nclass ScopedContextKeyService extends AbstractContextKeyService {\n  constructor(parent, domNode) {\n    super(parent.createChildContext());\n    this._parentChangeListener = this._register(new MutableDisposable());\n    this._parent = parent;\n    this._updateParentChangeListener();\n    this._domNode = domNode;\n    if (this._domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)) {\n      let extraInfo = '';\n      if (this._domNode.classList) {\n        extraInfo = Array.from(this._domNode.classList.values()).join(', ');\n      }\n      console.error(`Element already has context attribute${extraInfo ? ': ' + extraInfo : ''}`);\n    }\n    this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR, String(this._myContextId));\n  }\n  _updateParentChangeListener() {\n    // Forward parent events to this listener. Parent will change.\n    this._parentChangeListener.value = this._parent.onDidChangeContext(e => {\n      const thisContainer = this._parent.getContextValuesContainer(this._myContextId);\n      const thisContextValues = thisContainer.value;\n      if (!allEventKeysInContext(e, thisContextValues)) {\n        this._onDidChangeContext.fire(e);\n      }\n    });\n  }\n  dispose() {\n    if (this._isDisposed) {\n      return;\n    }\n    this._parent.disposeContext(this._myContextId);\n    this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR);\n    super.dispose();\n  }\n  getContextValuesContainer(contextId) {\n    if (this._isDisposed) {\n      return NullContext.INSTANCE;\n    }\n    return this._parent.getContextValuesContainer(contextId);\n  }\n  createChildContext(parentContextId = this._myContextId) {\n    if (this._isDisposed) {\n      throw new Error(`ScopedContextKeyService has been disposed`);\n    }\n    return this._parent.createChildContext(parentContextId);\n  }\n  disposeContext(contextId) {\n    if (this._isDisposed) {\n      return;\n    }\n    this._parent.disposeContext(contextId);\n  }\n}\nfunction findContextAttr(domNode) {\n  while (domNode) {\n    if (domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)) {\n      const attr = domNode.getAttribute(KEYBINDING_CONTEXT_ATTR);\n      if (attr) {\n        return parseInt(attr, 10);\n      }\n      return NaN;\n    }\n    domNode = domNode.parentElement;\n  }\n  return 0;\n}\nexport function setContext(accessor, contextKey, contextValue) {\n  const contextKeyService = accessor.get(IContextKeyService);\n  contextKeyService.createKey(String(contextKey), stringifyURIs(contextValue));\n}\nfunction stringifyURIs(contextValue) {\n  return cloneAndChange(contextValue, obj => {\n    if (typeof obj === 'object' && obj.$mid === 1 /* MarshalledId.Uri */) {\n      return URI.revive(obj).toString();\n    }\n    if (obj instanceof URI) {\n      return obj.toString();\n    }\n    return undefined;\n  });\n}\nCommandsRegistry.registerCommand('_setContext', setContext);\nCommandsRegistry.registerCommand({\n  id: 'getContextKeyInfo',\n  handler() {\n    return [...RawContextKey.all()].sort((a, b) => a.key.localeCompare(b.key));\n  },\n  description: {\n    description: localize('getContextKeyInfo', \"A command that returns information about context keys\"),\n    args: []\n  }\n});\nCommandsRegistry.registerCommand('_generateContextKeyInfo', function () {\n  const result = [];\n  const seen = new Set();\n  for (const info of RawContextKey.all()) {\n    if (!seen.has(info.key)) {\n      seen.add(info.key);\n      result.push(info);\n    }\n  }\n  result.sort((a, b) => a.key.localeCompare(b.key));\n  console.log(JSON.stringify(result, undefined, 2));\n});","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","PauseableEmitter","Iterable","Disposable","MutableDisposable","cloneAndChange","TernarySearchTree","URI","localize","CommandsRegistry","IConfigurationService","IContextKeyService","RawContextKey","KEYBINDING_CONTEXT_ATTR","Context","constructor","id","parent","_id","_parent","_value","create","value","assign","setValue","removeValue","getValue","ret","NullContext","undefined","INSTANCE","ConfigAwareContextValuesContainer","_configurationService","emitter","_values","forConfigKeys","_listener","onDidChangeConfiguration","event","source","allKeys","Array","from","k","clear","fire","ArrayContextKeyChangeEvent","changedKeys","configKey","affectedKeys","contextKey","cachedItems","findSuperstr","push","map","deleteSuperstr","has","delete","dispose","indexOf","_keyPrefix","get","substr","configValue","isArray","JSON","stringify","set","ContextKey","service","defaultValue","_service","_key","_defaultValue","reset","setContext","removeContext","getContextKeyValue","SimpleContextKeyChangeEvent","affectsSome","keys","allKeysContainedIn","every","CompositeContextKeyChangeEvent","events","e","evt","allEventKeysInContext","context","Set","AbstractContextKeyService","myContextId","_onDidChangeContext","_register","merge","input","onDidChangeContext","_isDisposed","_myContextId","createKey","Error","bufferChangeEvents","callback","pause","resume","createScoped","domNode","ScopedContextKeyService","contextMatchesRules","rules","getContextValuesContainer","result","evaluate","myContext","getContext","findContextAttr","ContextKeyService","configurationService","_contexts","Map","_lastContextId","contextId","createChildContext","parentContextId","disposeContext","_parentChangeListener","_updateParentChangeListener","_domNode","hasAttribute","extraInfo","classList","values","join","console","error","setAttribute","String","thisContainer","thisContextValues","removeAttribute","attr","getAttribute","parseInt","NaN","parentElement","accessor","contextValue","contextKeyService","stringifyURIs","obj","$mid","revive","toString","registerCommand","handler","all","sort","a","b","localeCompare","description","args","seen","info","add","log"],"sources":["/home/chlohest/work/website/my_web/node_modules/monaco-editor/esm/vs/platform/contextkey/browser/contextKeyService.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { PauseableEmitter } from '../../../base/common/event.js';\nimport { Iterable } from '../../../base/common/iterator.js';\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\nimport { cloneAndChange } from '../../../base/common/objects.js';\nimport { TernarySearchTree } from '../../../base/common/ternarySearchTree.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { localize } from '../../../nls.js';\nimport { CommandsRegistry } from '../../commands/common/commands.js';\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\nimport { IContextKeyService, RawContextKey } from '../common/contextkey.js';\nconst KEYBINDING_CONTEXT_ATTR = 'data-keybinding-context';\nexport class Context {\n    constructor(id, parent) {\n        this._id = id;\n        this._parent = parent;\n        this._value = Object.create(null);\n        this._value['_contextId'] = id;\n    }\n    get value() {\n        return Object.assign({}, this._value);\n    }\n    setValue(key, value) {\n        // console.log('SET ' + key + ' = ' + value + ' ON ' + this._id);\n        if (this._value[key] !== value) {\n            this._value[key] = value;\n            return true;\n        }\n        return false;\n    }\n    removeValue(key) {\n        // console.log('REMOVE ' + key + ' FROM ' + this._id);\n        if (key in this._value) {\n            delete this._value[key];\n            return true;\n        }\n        return false;\n    }\n    getValue(key) {\n        const ret = this._value[key];\n        if (typeof ret === 'undefined' && this._parent) {\n            return this._parent.getValue(key);\n        }\n        return ret;\n    }\n}\nclass NullContext extends Context {\n    constructor() {\n        super(-1, null);\n    }\n    setValue(key, value) {\n        return false;\n    }\n    removeValue(key) {\n        return false;\n    }\n    getValue(key) {\n        return undefined;\n    }\n}\nNullContext.INSTANCE = new NullContext();\nclass ConfigAwareContextValuesContainer extends Context {\n    constructor(id, _configurationService, emitter) {\n        super(id, null);\n        this._configurationService = _configurationService;\n        this._values = TernarySearchTree.forConfigKeys();\n        this._listener = this._configurationService.onDidChangeConfiguration(event => {\n            if (event.source === 7 /* ConfigurationTarget.DEFAULT */) {\n                // new setting, reset everything\n                const allKeys = Array.from(this._values, ([k]) => k);\n                this._values.clear();\n                emitter.fire(new ArrayContextKeyChangeEvent(allKeys));\n            }\n            else {\n                const changedKeys = [];\n                for (const configKey of event.affectedKeys) {\n                    const contextKey = `config.${configKey}`;\n                    const cachedItems = this._values.findSuperstr(contextKey);\n                    if (cachedItems !== undefined) {\n                        changedKeys.push(...Iterable.map(cachedItems, ([key]) => key));\n                        this._values.deleteSuperstr(contextKey);\n                    }\n                    if (this._values.has(contextKey)) {\n                        changedKeys.push(contextKey);\n                        this._values.delete(contextKey);\n                    }\n                }\n                emitter.fire(new ArrayContextKeyChangeEvent(changedKeys));\n            }\n        });\n    }\n    dispose() {\n        this._listener.dispose();\n    }\n    getValue(key) {\n        if (key.indexOf(ConfigAwareContextValuesContainer._keyPrefix) !== 0) {\n            return super.getValue(key);\n        }\n        if (this._values.has(key)) {\n            return this._values.get(key);\n        }\n        const configKey = key.substr(ConfigAwareContextValuesContainer._keyPrefix.length);\n        const configValue = this._configurationService.getValue(configKey);\n        let value = undefined;\n        switch (typeof configValue) {\n            case 'number':\n            case 'boolean':\n            case 'string':\n                value = configValue;\n                break;\n            default:\n                if (Array.isArray(configValue)) {\n                    value = JSON.stringify(configValue);\n                }\n                else {\n                    value = configValue;\n                }\n        }\n        this._values.set(key, value);\n        return value;\n    }\n    setValue(key, value) {\n        return super.setValue(key, value);\n    }\n    removeValue(key) {\n        return super.removeValue(key);\n    }\n}\nConfigAwareContextValuesContainer._keyPrefix = 'config.';\nclass ContextKey {\n    constructor(service, key, defaultValue) {\n        this._service = service;\n        this._key = key;\n        this._defaultValue = defaultValue;\n        this.reset();\n    }\n    set(value) {\n        this._service.setContext(this._key, value);\n    }\n    reset() {\n        if (typeof this._defaultValue === 'undefined') {\n            this._service.removeContext(this._key);\n        }\n        else {\n            this._service.setContext(this._key, this._defaultValue);\n        }\n    }\n    get() {\n        return this._service.getContextKeyValue(this._key);\n    }\n}\nclass SimpleContextKeyChangeEvent {\n    constructor(key) {\n        this.key = key;\n    }\n    affectsSome(keys) {\n        return keys.has(this.key);\n    }\n    allKeysContainedIn(keys) {\n        return this.affectsSome(keys);\n    }\n}\nclass ArrayContextKeyChangeEvent {\n    constructor(keys) {\n        this.keys = keys;\n    }\n    affectsSome(keys) {\n        for (const key of this.keys) {\n            if (keys.has(key)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    allKeysContainedIn(keys) {\n        return this.keys.every(key => keys.has(key));\n    }\n}\nclass CompositeContextKeyChangeEvent {\n    constructor(events) {\n        this.events = events;\n    }\n    affectsSome(keys) {\n        for (const e of this.events) {\n            if (e.affectsSome(keys)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    allKeysContainedIn(keys) {\n        return this.events.every(evt => evt.allKeysContainedIn(keys));\n    }\n}\nfunction allEventKeysInContext(event, context) {\n    return event.allKeysContainedIn(new Set(Object.keys(context)));\n}\nexport class AbstractContextKeyService extends Disposable {\n    constructor(myContextId) {\n        super();\n        this._onDidChangeContext = this._register(new PauseableEmitter({ merge: input => new CompositeContextKeyChangeEvent(input) }));\n        this.onDidChangeContext = this._onDidChangeContext.event;\n        this._isDisposed = false;\n        this._myContextId = myContextId;\n    }\n    createKey(key, defaultValue) {\n        if (this._isDisposed) {\n            throw new Error(`AbstractContextKeyService has been disposed`);\n        }\n        return new ContextKey(this, key, defaultValue);\n    }\n    bufferChangeEvents(callback) {\n        this._onDidChangeContext.pause();\n        try {\n            callback();\n        }\n        finally {\n            this._onDidChangeContext.resume();\n        }\n    }\n    createScoped(domNode) {\n        if (this._isDisposed) {\n            throw new Error(`AbstractContextKeyService has been disposed`);\n        }\n        return new ScopedContextKeyService(this, domNode);\n    }\n    contextMatchesRules(rules) {\n        if (this._isDisposed) {\n            throw new Error(`AbstractContextKeyService has been disposed`);\n        }\n        const context = this.getContextValuesContainer(this._myContextId);\n        const result = (rules ? rules.evaluate(context) : true);\n        // console.group(rules.serialize() + ' -> ' + result);\n        // rules.keys().forEach(key => { console.log(key, ctx[key]); });\n        // console.groupEnd();\n        return result;\n    }\n    getContextKeyValue(key) {\n        if (this._isDisposed) {\n            return undefined;\n        }\n        return this.getContextValuesContainer(this._myContextId).getValue(key);\n    }\n    setContext(key, value) {\n        if (this._isDisposed) {\n            return;\n        }\n        const myContext = this.getContextValuesContainer(this._myContextId);\n        if (!myContext) {\n            return;\n        }\n        if (myContext.setValue(key, value)) {\n            this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key));\n        }\n    }\n    removeContext(key) {\n        if (this._isDisposed) {\n            return;\n        }\n        if (this.getContextValuesContainer(this._myContextId).removeValue(key)) {\n            this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(key));\n        }\n    }\n    getContext(target) {\n        if (this._isDisposed) {\n            return NullContext.INSTANCE;\n        }\n        return this.getContextValuesContainer(findContextAttr(target));\n    }\n    dispose() {\n        super.dispose();\n        this._isDisposed = true;\n    }\n}\nlet ContextKeyService = class ContextKeyService extends AbstractContextKeyService {\n    constructor(configurationService) {\n        super(0);\n        this._contexts = new Map();\n        this._lastContextId = 0;\n        const myContext = this._register(new ConfigAwareContextValuesContainer(this._myContextId, configurationService, this._onDidChangeContext));\n        this._contexts.set(this._myContextId, myContext);\n        // Uncomment this to see the contexts continuously logged\n        // let lastLoggedValue: string | null = null;\n        // setInterval(() => {\n        // \tlet values = Object.keys(this._contexts).map((key) => this._contexts[key]);\n        // \tlet logValue = values.map(v => JSON.stringify(v._value, null, '\\t')).join('\\n');\n        // \tif (lastLoggedValue !== logValue) {\n        // \t\tlastLoggedValue = logValue;\n        // \t\tconsole.log(lastLoggedValue);\n        // \t}\n        // }, 2000);\n    }\n    getContextValuesContainer(contextId) {\n        if (this._isDisposed) {\n            return NullContext.INSTANCE;\n        }\n        return this._contexts.get(contextId) || NullContext.INSTANCE;\n    }\n    createChildContext(parentContextId = this._myContextId) {\n        if (this._isDisposed) {\n            throw new Error(`ContextKeyService has been disposed`);\n        }\n        const id = (++this._lastContextId);\n        this._contexts.set(id, new Context(id, this.getContextValuesContainer(parentContextId)));\n        return id;\n    }\n    disposeContext(contextId) {\n        if (!this._isDisposed) {\n            this._contexts.delete(contextId);\n        }\n    }\n};\nContextKeyService = __decorate([\n    __param(0, IConfigurationService)\n], ContextKeyService);\nexport { ContextKeyService };\nclass ScopedContextKeyService extends AbstractContextKeyService {\n    constructor(parent, domNode) {\n        super(parent.createChildContext());\n        this._parentChangeListener = this._register(new MutableDisposable());\n        this._parent = parent;\n        this._updateParentChangeListener();\n        this._domNode = domNode;\n        if (this._domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)) {\n            let extraInfo = '';\n            if (this._domNode.classList) {\n                extraInfo = Array.from(this._domNode.classList.values()).join(', ');\n            }\n            console.error(`Element already has context attribute${extraInfo ? ': ' + extraInfo : ''}`);\n        }\n        this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR, String(this._myContextId));\n    }\n    _updateParentChangeListener() {\n        // Forward parent events to this listener. Parent will change.\n        this._parentChangeListener.value = this._parent.onDidChangeContext(e => {\n            const thisContainer = this._parent.getContextValuesContainer(this._myContextId);\n            const thisContextValues = thisContainer.value;\n            if (!allEventKeysInContext(e, thisContextValues)) {\n                this._onDidChangeContext.fire(e);\n            }\n        });\n    }\n    dispose() {\n        if (this._isDisposed) {\n            return;\n        }\n        this._parent.disposeContext(this._myContextId);\n        this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR);\n        super.dispose();\n    }\n    getContextValuesContainer(contextId) {\n        if (this._isDisposed) {\n            return NullContext.INSTANCE;\n        }\n        return this._parent.getContextValuesContainer(contextId);\n    }\n    createChildContext(parentContextId = this._myContextId) {\n        if (this._isDisposed) {\n            throw new Error(`ScopedContextKeyService has been disposed`);\n        }\n        return this._parent.createChildContext(parentContextId);\n    }\n    disposeContext(contextId) {\n        if (this._isDisposed) {\n            return;\n        }\n        this._parent.disposeContext(contextId);\n    }\n}\nfunction findContextAttr(domNode) {\n    while (domNode) {\n        if (domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)) {\n            const attr = domNode.getAttribute(KEYBINDING_CONTEXT_ATTR);\n            if (attr) {\n                return parseInt(attr, 10);\n            }\n            return NaN;\n        }\n        domNode = domNode.parentElement;\n    }\n    return 0;\n}\nexport function setContext(accessor, contextKey, contextValue) {\n    const contextKeyService = accessor.get(IContextKeyService);\n    contextKeyService.createKey(String(contextKey), stringifyURIs(contextValue));\n}\nfunction stringifyURIs(contextValue) {\n    return cloneAndChange(contextValue, (obj) => {\n        if (typeof obj === 'object' && obj.$mid === 1 /* MarshalledId.Uri */) {\n            return URI.revive(obj).toString();\n        }\n        if (obj instanceof URI) {\n            return obj.toString();\n        }\n        return undefined;\n    });\n}\nCommandsRegistry.registerCommand('_setContext', setContext);\nCommandsRegistry.registerCommand({\n    id: 'getContextKeyInfo',\n    handler() {\n        return [...RawContextKey.all()].sort((a, b) => a.key.localeCompare(b.key));\n    },\n    description: {\n        description: localize('getContextKeyInfo', \"A command that returns information about context keys\"),\n        args: []\n    }\n});\nCommandsRegistry.registerCommand('_generateContextKeyInfo', function () {\n    const result = [];\n    const seen = new Set();\n    for (const info of RawContextKey.all()) {\n        if (!seen.has(info.key)) {\n            seen.add(info.key);\n            result.push(info);\n        }\n    }\n    result.sort((a, b) => a.key.localeCompare(b.key));\n    console.log(JSON.stringify(result, undefined, 2));\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}