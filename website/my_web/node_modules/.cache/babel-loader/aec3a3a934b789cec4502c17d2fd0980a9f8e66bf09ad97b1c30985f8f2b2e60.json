{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport '../../common/languages/languageConfigurationRegistry.js';\nimport './standaloneCodeEditorService.js';\nimport './standaloneLayoutService.js';\nimport '../../../platform/undoRedo/common/undoRedoService.js';\nimport '../../common/services/languageFeatureDebounce.js';\nimport '../../common/services/semanticTokensStylingService.js';\nimport '../../common/services/languageFeaturesService.js';\nimport * as strings from '../../../base/common/strings.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { KeyCodeChord, decodeKeybinding } from '../../../base/common/keybindings.js';\nimport { ImmortalReference, toDisposable, DisposableStore, Disposable, combinedDisposable } from '../../../base/common/lifecycle.js';\nimport { OS, isLinux, isMacintosh } from '../../../base/common/platform.js';\nimport Severity from '../../../base/common/severity.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IBulkEditService, ResourceEdit, ResourceTextEdit } from '../../browser/services/bulkEditService.js';\nimport { isDiffEditorConfigurationKey, isEditorConfigurationKey } from '../../common/config/editorConfigurationSchema.js';\nimport { EditOperation } from '../../common/core/editOperation.js';\nimport { Position as Pos } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { ITextModelService } from '../../common/services/resolverService.js';\nimport { ITextResourceConfigurationService, ITextResourcePropertiesService } from '../../common/services/textResourceConfiguration.js';\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { Configuration, ConfigurationModel, ConfigurationChangeEvent } from '../../../platform/configuration/common/configurationModels.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IDialogService } from '../../../platform/dialogs/common/dialogs.js';\nimport { createDecorator, IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { AbstractKeybindingService } from '../../../platform/keybinding/common/abstractKeybindingService.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingResolver } from '../../../platform/keybinding/common/keybindingResolver.js';\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { ResolvedKeybindingItem } from '../../../platform/keybinding/common/resolvedKeybindingItem.js';\nimport { USLayoutResolvedKeybinding } from '../../../platform/keybinding/common/usLayoutResolvedKeybinding.js';\nimport { ILabelService } from '../../../platform/label/common/label.js';\nimport { INotificationService, NoOpNotification } from '../../../platform/notification/common/notification.js';\nimport { IEditorProgressService, IProgressService } from '../../../platform/progress/common/progress.js';\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService, WorkspaceFolder, STANDALONE_EDITOR_WORKSPACE_ID } from '../../../platform/workspace/common/workspace.js';\nimport { ILayoutService } from '../../../platform/layout/browser/layoutService.js';\nimport { StandaloneServicesNLS } from '../../common/standaloneStrings.js';\nimport { basename } from '../../../base/common/resources.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { ConsoleLogger, ILogService } from '../../../platform/log/common/log.js';\nimport { IWorkspaceTrustManagementService } from '../../../platform/workspace/common/workspaceTrust.js';\nimport { IContextMenuService, IContextViewService } from '../../../platform/contextview/browser/contextView.js';\nimport { ContextViewService } from '../../../platform/contextview/browser/contextViewService.js';\nimport { LanguageService } from '../../common/services/languageService.js';\nimport { ContextMenuService } from '../../../platform/contextview/browser/contextMenuService.js';\nimport { getSingletonServiceDescriptors, registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { OpenerService } from '../../browser/services/openerService.js';\nimport { IEditorWorkerService } from '../../common/services/editorWorker.js';\nimport { EditorWorkerService } from '../../browser/services/editorWorkerService.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport { MarkerDecorationsService } from '../../common/services/markerDecorationsService.js';\nimport { IMarkerDecorationsService } from '../../common/services/markerDecorations.js';\nimport { ModelService } from '../../common/services/modelService.js';\nimport { StandaloneQuickInputService } from './quickInput/standaloneQuickInputService.js';\nimport { StandaloneThemeService } from './standaloneThemeService.js';\nimport { IStandaloneThemeService } from '../common/standaloneTheme.js';\nimport { AccessibilityService } from '../../../platform/accessibility/browser/accessibilityService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { IMenuService } from '../../../platform/actions/common/actions.js';\nimport { MenuService } from '../../../platform/actions/common/menuService.js';\nimport { BrowserClipboardService } from '../../../platform/clipboard/browser/clipboardService.js';\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyService } from '../../../platform/contextkey/browser/contextKeyService.js';\nimport { SyncDescriptor } from '../../../platform/instantiation/common/descriptors.js';\nimport { InstantiationService } from '../../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { IListService, ListService } from '../../../platform/list/browser/listService.js';\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\nimport { MarkerService } from '../../../platform/markers/common/markerService.js';\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\nimport { IQuickInputService } from '../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService, InMemoryStorageService } from '../../../platform/storage/common/storage.js';\nimport { DefaultConfiguration } from '../../../platform/configuration/common/configurations.js';\nimport { IAudioCueService } from '../../../platform/audioCues/browser/audioCueService.js';\nimport { LogService } from '../../../platform/log/common/logService.js';\nimport { getEditorFeatures } from '../../common/editorFeatures.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { IEnvironmentService } from '../../../platform/environment/common/environment.js';\nclass SimpleModel {\n  constructor(model) {\n    this.disposed = false;\n    this.model = model;\n    this._onWillDispose = new Emitter();\n  }\n  get textEditorModel() {\n    return this.model;\n  }\n  dispose() {\n    this.disposed = true;\n    this._onWillDispose.fire();\n  }\n}\nlet StandaloneTextModelService = class StandaloneTextModelService {\n  constructor(modelService) {\n    this.modelService = modelService;\n  }\n  createModelReference(resource) {\n    const model = this.modelService.getModel(resource);\n    if (!model) {\n      return Promise.reject(new Error(`Model not found`));\n    }\n    return Promise.resolve(new ImmortalReference(new SimpleModel(model)));\n  }\n};\nStandaloneTextModelService = __decorate([__param(0, IModelService)], StandaloneTextModelService);\nclass StandaloneEditorProgressService {\n  show() {\n    return StandaloneEditorProgressService.NULL_PROGRESS_RUNNER;\n  }\n  showWhile(promise, delay) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield promise;\n    });\n  }\n}\nStandaloneEditorProgressService.NULL_PROGRESS_RUNNER = {\n  done: () => {},\n  total: () => {},\n  worked: () => {}\n};\nclass StandaloneProgressService {\n  withProgress(_options, task, onDidCancel) {\n    return task({\n      report: () => {}\n    });\n  }\n}\nclass StandaloneEnvironmentService {\n  constructor() {\n    this.isExtensionDevelopment = false;\n    this.isBuilt = false;\n  }\n}\nclass StandaloneDialogService {\n  confirm(confirmation) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const confirmed = this.doConfirm(confirmation.message, confirmation.detail);\n      return {\n        confirmed,\n        checkboxChecked: false // unsupported\n      };\n    });\n  }\n\n  doConfirm(message, detail) {\n    let messageText = message;\n    if (detail) {\n      messageText = messageText + '\\n\\n' + detail;\n    }\n    return window.confirm(messageText);\n  }\n  prompt(prompt) {\n    var _a, _b;\n    return __awaiter(this, void 0, void 0, function* () {\n      let result = undefined;\n      const confirmed = this.doConfirm(prompt.message, prompt.detail);\n      if (confirmed) {\n        const promptButtons = [...((_a = prompt.buttons) !== null && _a !== void 0 ? _a : [])];\n        if (prompt.cancelButton && typeof prompt.cancelButton !== 'string' && typeof prompt.cancelButton !== 'boolean') {\n          promptButtons.push(prompt.cancelButton);\n        }\n        result = yield (_b = promptButtons[0]) === null || _b === void 0 ? void 0 : _b.run({\n          checkboxChecked: false\n        });\n      }\n      return {\n        result\n      };\n    });\n  }\n  error(message, detail) {\n    return __awaiter(this, void 0, void 0, function* () {\n      yield this.prompt({\n        type: Severity.Error,\n        message,\n        detail\n      });\n    });\n  }\n}\nexport class StandaloneNotificationService {\n  info(message) {\n    return this.notify({\n      severity: Severity.Info,\n      message\n    });\n  }\n  warn(message) {\n    return this.notify({\n      severity: Severity.Warning,\n      message\n    });\n  }\n  error(error) {\n    return this.notify({\n      severity: Severity.Error,\n      message: error\n    });\n  }\n  notify(notification) {\n    switch (notification.severity) {\n      case Severity.Error:\n        console.error(notification.message);\n        break;\n      case Severity.Warning:\n        console.warn(notification.message);\n        break;\n      default:\n        console.log(notification.message);\n        break;\n    }\n    return StandaloneNotificationService.NO_OP;\n  }\n  prompt(severity, message, choices, options) {\n    return StandaloneNotificationService.NO_OP;\n  }\n  status(message, options) {\n    return Disposable.None;\n  }\n}\nStandaloneNotificationService.NO_OP = new NoOpNotification();\nlet StandaloneCommandService = class StandaloneCommandService {\n  constructor(instantiationService) {\n    this._onWillExecuteCommand = new Emitter();\n    this._onDidExecuteCommand = new Emitter();\n    this.onDidExecuteCommand = this._onDidExecuteCommand.event;\n    this._instantiationService = instantiationService;\n  }\n  executeCommand(id, ...args) {\n    const command = CommandsRegistry.getCommand(id);\n    if (!command) {\n      return Promise.reject(new Error(`command '${id}' not found`));\n    }\n    try {\n      this._onWillExecuteCommand.fire({\n        commandId: id,\n        args\n      });\n      const result = this._instantiationService.invokeFunction.apply(this._instantiationService, [command.handler, ...args]);\n      this._onDidExecuteCommand.fire({\n        commandId: id,\n        args\n      });\n      return Promise.resolve(result);\n    } catch (err) {\n      return Promise.reject(err);\n    }\n  }\n};\nStandaloneCommandService = __decorate([__param(0, IInstantiationService)], StandaloneCommandService);\nexport { StandaloneCommandService };\nlet StandaloneKeybindingService = class StandaloneKeybindingService extends AbstractKeybindingService {\n  constructor(contextKeyService, commandService, telemetryService, notificationService, logService, codeEditorService) {\n    super(contextKeyService, commandService, telemetryService, notificationService, logService);\n    this._cachedResolver = null;\n    this._dynamicKeybindings = [];\n    this._domNodeListeners = [];\n    const addContainer = domNode => {\n      const disposables = new DisposableStore();\n      // for standard keybindings\n      disposables.add(dom.addDisposableListener(domNode, dom.EventType.KEY_DOWN, e => {\n        const keyEvent = new StandardKeyboardEvent(e);\n        const shouldPreventDefault = this._dispatch(keyEvent, keyEvent.target);\n        if (shouldPreventDefault) {\n          keyEvent.preventDefault();\n          keyEvent.stopPropagation();\n        }\n      }));\n      // for single modifier chord keybindings (e.g. shift shift)\n      disposables.add(dom.addDisposableListener(domNode, dom.EventType.KEY_UP, e => {\n        const keyEvent = new StandardKeyboardEvent(e);\n        const shouldPreventDefault = this._singleModifierDispatch(keyEvent, keyEvent.target);\n        if (shouldPreventDefault) {\n          keyEvent.preventDefault();\n        }\n      }));\n      this._domNodeListeners.push(new DomNodeListeners(domNode, disposables));\n    };\n    const removeContainer = domNode => {\n      for (let i = 0; i < this._domNodeListeners.length; i++) {\n        const domNodeListeners = this._domNodeListeners[i];\n        if (domNodeListeners.domNode === domNode) {\n          this._domNodeListeners.splice(i, 1);\n          domNodeListeners.dispose();\n        }\n      }\n    };\n    const addCodeEditor = codeEditor => {\n      if (codeEditor.getOption(61 /* EditorOption.inDiffEditor */)) {\n        return;\n      }\n      addContainer(codeEditor.getContainerDomNode());\n    };\n    const removeCodeEditor = codeEditor => {\n      if (codeEditor.getOption(61 /* EditorOption.inDiffEditor */)) {\n        return;\n      }\n      removeContainer(codeEditor.getContainerDomNode());\n    };\n    this._register(codeEditorService.onCodeEditorAdd(addCodeEditor));\n    this._register(codeEditorService.onCodeEditorRemove(removeCodeEditor));\n    codeEditorService.listCodeEditors().forEach(addCodeEditor);\n    const addDiffEditor = diffEditor => {\n      addContainer(diffEditor.getContainerDomNode());\n    };\n    const removeDiffEditor = diffEditor => {\n      removeContainer(diffEditor.getContainerDomNode());\n    };\n    this._register(codeEditorService.onDiffEditorAdd(addDiffEditor));\n    this._register(codeEditorService.onDiffEditorRemove(removeDiffEditor));\n    codeEditorService.listDiffEditors().forEach(addDiffEditor);\n  }\n  addDynamicKeybinding(command, keybinding, handler, when) {\n    return combinedDisposable(CommandsRegistry.registerCommand(command, handler), this.addDynamicKeybindings([{\n      keybinding,\n      command,\n      when\n    }]));\n  }\n  addDynamicKeybindings(rules) {\n    const entries = rules.map(rule => {\n      var _a;\n      const keybinding = decodeKeybinding(rule.keybinding, OS);\n      return {\n        keybinding,\n        command: (_a = rule.command) !== null && _a !== void 0 ? _a : null,\n        commandArgs: rule.commandArgs,\n        when: rule.when,\n        weight1: 1000,\n        weight2: 0,\n        extensionId: null,\n        isBuiltinExtension: false\n      };\n    });\n    this._dynamicKeybindings = this._dynamicKeybindings.concat(entries);\n    this.updateResolver();\n    return toDisposable(() => {\n      // Search the first entry and remove them all since they will be contiguous\n      for (let i = 0; i < this._dynamicKeybindings.length; i++) {\n        if (this._dynamicKeybindings[i] === entries[0]) {\n          this._dynamicKeybindings.splice(i, entries.length);\n          this.updateResolver();\n          return;\n        }\n      }\n    });\n  }\n  updateResolver() {\n    this._cachedResolver = null;\n    this._onDidUpdateKeybindings.fire();\n  }\n  _getResolver() {\n    if (!this._cachedResolver) {\n      const defaults = this._toNormalizedKeybindingItems(KeybindingsRegistry.getDefaultKeybindings(), true);\n      const overrides = this._toNormalizedKeybindingItems(this._dynamicKeybindings, false);\n      this._cachedResolver = new KeybindingResolver(defaults, overrides, str => this._log(str));\n    }\n    return this._cachedResolver;\n  }\n  _documentHasFocus() {\n    return document.hasFocus();\n  }\n  _toNormalizedKeybindingItems(items, isDefault) {\n    const result = [];\n    let resultLen = 0;\n    for (const item of items) {\n      const when = item.when || undefined;\n      const keybinding = item.keybinding;\n      if (!keybinding) {\n        // This might be a removal keybinding item in user settings => accept it\n        result[resultLen++] = new ResolvedKeybindingItem(undefined, item.command, item.commandArgs, when, isDefault, null, false);\n      } else {\n        const resolvedKeybindings = USLayoutResolvedKeybinding.resolveKeybinding(keybinding, OS);\n        for (const resolvedKeybinding of resolvedKeybindings) {\n          result[resultLen++] = new ResolvedKeybindingItem(resolvedKeybinding, item.command, item.commandArgs, when, isDefault, null, false);\n        }\n      }\n    }\n    return result;\n  }\n  resolveKeyboardEvent(keyboardEvent) {\n    const chord = new KeyCodeChord(keyboardEvent.ctrlKey, keyboardEvent.shiftKey, keyboardEvent.altKey, keyboardEvent.metaKey, keyboardEvent.keyCode);\n    return new USLayoutResolvedKeybinding([chord], OS);\n  }\n};\nStandaloneKeybindingService = __decorate([__param(0, IContextKeyService), __param(1, ICommandService), __param(2, ITelemetryService), __param(3, INotificationService), __param(4, ILogService), __param(5, ICodeEditorService)], StandaloneKeybindingService);\nexport { StandaloneKeybindingService };\nclass DomNodeListeners extends Disposable {\n  constructor(domNode, disposables) {\n    super();\n    this.domNode = domNode;\n    this._register(disposables);\n  }\n}\nfunction isConfigurationOverrides(thing) {\n  return thing && typeof thing === 'object' && (!thing.overrideIdentifier || typeof thing.overrideIdentifier === 'string') && (!thing.resource || thing.resource instanceof URI);\n}\nexport class StandaloneConfigurationService {\n  constructor() {\n    this._onDidChangeConfiguration = new Emitter();\n    this.onDidChangeConfiguration = this._onDidChangeConfiguration.event;\n    const defaultConfiguration = new DefaultConfiguration();\n    this._configuration = new Configuration(defaultConfiguration.reload(), new ConfigurationModel(), new ConfigurationModel(), new ConfigurationModel());\n    defaultConfiguration.dispose();\n  }\n  getValue(arg1, arg2) {\n    const section = typeof arg1 === 'string' ? arg1 : undefined;\n    const overrides = isConfigurationOverrides(arg1) ? arg1 : isConfigurationOverrides(arg2) ? arg2 : {};\n    return this._configuration.getValue(section, overrides, undefined);\n  }\n  updateValues(values) {\n    const previous = {\n      data: this._configuration.toData()\n    };\n    const changedKeys = [];\n    for (const entry of values) {\n      const [key, value] = entry;\n      if (this.getValue(key) === value) {\n        continue;\n      }\n      this._configuration.updateValue(key, value);\n      changedKeys.push(key);\n    }\n    if (changedKeys.length > 0) {\n      const configurationChangeEvent = new ConfigurationChangeEvent({\n        keys: changedKeys,\n        overrides: []\n      }, previous, this._configuration);\n      configurationChangeEvent.source = 8 /* ConfigurationTarget.MEMORY */;\n      configurationChangeEvent.sourceConfig = null;\n      this._onDidChangeConfiguration.fire(configurationChangeEvent);\n    }\n    return Promise.resolve();\n  }\n  updateValue(key, value, arg3, arg4) {\n    return this.updateValues([[key, value]]);\n  }\n  inspect(key, options = {}) {\n    return this._configuration.inspect(key, options, undefined);\n  }\n}\nlet StandaloneResourceConfigurationService = class StandaloneResourceConfigurationService {\n  constructor(configurationService, modelService, languageService) {\n    this.configurationService = configurationService;\n    this.modelService = modelService;\n    this.languageService = languageService;\n    this._onDidChangeConfiguration = new Emitter();\n    this.configurationService.onDidChangeConfiguration(e => {\n      this._onDidChangeConfiguration.fire({\n        affectedKeys: e.affectedKeys,\n        affectsConfiguration: (resource, configuration) => e.affectsConfiguration(configuration)\n      });\n    });\n  }\n  getValue(resource, arg2, arg3) {\n    const position = Pos.isIPosition(arg2) ? arg2 : null;\n    const section = position ? typeof arg3 === 'string' ? arg3 : undefined : typeof arg2 === 'string' ? arg2 : undefined;\n    const language = resource ? this.getLanguage(resource, position) : undefined;\n    if (typeof section === 'undefined') {\n      return this.configurationService.getValue({\n        resource,\n        overrideIdentifier: language\n      });\n    }\n    return this.configurationService.getValue(section, {\n      resource,\n      overrideIdentifier: language\n    });\n  }\n  getLanguage(resource, position) {\n    const model = this.modelService.getModel(resource);\n    if (model) {\n      return position ? model.getLanguageIdAtPosition(position.lineNumber, position.column) : model.getLanguageId();\n    }\n    return this.languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n  }\n};\nStandaloneResourceConfigurationService = __decorate([__param(0, IConfigurationService), __param(1, IModelService), __param(2, ILanguageService)], StandaloneResourceConfigurationService);\nlet StandaloneResourcePropertiesService = class StandaloneResourcePropertiesService {\n  constructor(configurationService) {\n    this.configurationService = configurationService;\n  }\n  getEOL(resource, language) {\n    const eol = this.configurationService.getValue('files.eol', {\n      overrideIdentifier: language,\n      resource\n    });\n    if (eol && typeof eol === 'string' && eol !== 'auto') {\n      return eol;\n    }\n    return isLinux || isMacintosh ? '\\n' : '\\r\\n';\n  }\n};\nStandaloneResourcePropertiesService = __decorate([__param(0, IConfigurationService)], StandaloneResourcePropertiesService);\nclass StandaloneTelemetryService {\n  publicLog2() {}\n}\nclass StandaloneWorkspaceContextService {\n  constructor() {\n    const resource = URI.from({\n      scheme: StandaloneWorkspaceContextService.SCHEME,\n      authority: 'model',\n      path: '/'\n    });\n    this.workspace = {\n      id: STANDALONE_EDITOR_WORKSPACE_ID,\n      folders: [new WorkspaceFolder({\n        uri: resource,\n        name: '',\n        index: 0\n      })]\n    };\n  }\n  getWorkspace() {\n    return this.workspace;\n  }\n  getWorkspaceFolder(resource) {\n    return resource && resource.scheme === StandaloneWorkspaceContextService.SCHEME ? this.workspace.folders[0] : null;\n  }\n}\nStandaloneWorkspaceContextService.SCHEME = 'inmemory';\nexport function updateConfigurationService(configurationService, source, isDiffEditor) {\n  if (!source) {\n    return;\n  }\n  if (!(configurationService instanceof StandaloneConfigurationService)) {\n    return;\n  }\n  const toUpdate = [];\n  Object.keys(source).forEach(key => {\n    if (isEditorConfigurationKey(key)) {\n      toUpdate.push([`editor.${key}`, source[key]]);\n    }\n    if (isDiffEditor && isDiffEditorConfigurationKey(key)) {\n      toUpdate.push([`diffEditor.${key}`, source[key]]);\n    }\n  });\n  if (toUpdate.length > 0) {\n    configurationService.updateValues(toUpdate);\n  }\n}\nlet StandaloneBulkEditService = class StandaloneBulkEditService {\n  constructor(_modelService) {\n    this._modelService = _modelService;\n    //\n  }\n\n  hasPreviewHandler() {\n    return false;\n  }\n  apply(editsIn, _options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const edits = Array.isArray(editsIn) ? editsIn : ResourceEdit.convert(editsIn);\n      const textEdits = new Map();\n      for (const edit of edits) {\n        if (!(edit instanceof ResourceTextEdit)) {\n          throw new Error('bad edit - only text edits are supported');\n        }\n        const model = this._modelService.getModel(edit.resource);\n        if (!model) {\n          throw new Error('bad edit - model not found');\n        }\n        if (typeof edit.versionId === 'number' && model.getVersionId() !== edit.versionId) {\n          throw new Error('bad state - model changed in the meantime');\n        }\n        let array = textEdits.get(model);\n        if (!array) {\n          array = [];\n          textEdits.set(model, array);\n        }\n        array.push(EditOperation.replaceMove(Range.lift(edit.textEdit.range), edit.textEdit.text));\n      }\n      let totalEdits = 0;\n      let totalFiles = 0;\n      for (const [model, edits] of textEdits) {\n        model.pushStackElement();\n        model.pushEditOperations([], edits, () => []);\n        model.pushStackElement();\n        totalFiles += 1;\n        totalEdits += edits.length;\n      }\n      return {\n        ariaSummary: strings.format(StandaloneServicesNLS.bulkEditServiceSummary, totalEdits, totalFiles),\n        isApplied: totalEdits > 0\n      };\n    });\n  }\n};\nStandaloneBulkEditService = __decorate([__param(0, IModelService)], StandaloneBulkEditService);\nclass StandaloneUriLabelService {\n  getUriLabel(resource, options) {\n    if (resource.scheme === 'file') {\n      return resource.fsPath;\n    }\n    return resource.path;\n  }\n  getUriBasenameLabel(resource) {\n    return basename(resource);\n  }\n}\nlet StandaloneContextViewService = class StandaloneContextViewService extends ContextViewService {\n  constructor(layoutService, _codeEditorService) {\n    super(layoutService);\n    this._codeEditorService = _codeEditorService;\n  }\n  showContextView(delegate, container, shadowRoot) {\n    if (!container) {\n      const codeEditor = this._codeEditorService.getFocusedCodeEditor() || this._codeEditorService.getActiveCodeEditor();\n      if (codeEditor) {\n        container = codeEditor.getContainerDomNode();\n      }\n    }\n    return super.showContextView(delegate, container, shadowRoot);\n  }\n};\nStandaloneContextViewService = __decorate([__param(0, ILayoutService), __param(1, ICodeEditorService)], StandaloneContextViewService);\nclass StandaloneWorkspaceTrustManagementService {\n  constructor() {\n    this._neverEmitter = new Emitter();\n    this.onDidChangeTrust = this._neverEmitter.event;\n  }\n  isWorkspaceTrusted() {\n    return true;\n  }\n}\nclass StandaloneLanguageService extends LanguageService {\n  constructor() {\n    super();\n  }\n}\nclass StandaloneLogService extends LogService {\n  constructor() {\n    super(new ConsoleLogger());\n  }\n}\nlet StandaloneContextMenuService = class StandaloneContextMenuService extends ContextMenuService {\n  constructor(telemetryService, notificationService, contextViewService, keybindingService, menuService, contextKeyService) {\n    super(telemetryService, notificationService, contextViewService, keybindingService, menuService, contextKeyService);\n    this.configure({\n      blockMouse: false\n    }); // we do not want that in the standalone editor\n  }\n};\n\nStandaloneContextMenuService = __decorate([__param(0, ITelemetryService), __param(1, INotificationService), __param(2, IContextViewService), __param(3, IKeybindingService), __param(4, IMenuService), __param(5, IContextKeyService)], StandaloneContextMenuService);\nclass StandaloneAudioService {\n  playAudioCue(cue, options) {\n    return __awaiter(this, void 0, void 0, function* () {});\n  }\n}\nregisterSingleton(IConfigurationService, StandaloneConfigurationService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITextResourceConfigurationService, StandaloneResourceConfigurationService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITextResourcePropertiesService, StandaloneResourcePropertiesService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IWorkspaceContextService, StandaloneWorkspaceContextService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ILabelService, StandaloneUriLabelService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITelemetryService, StandaloneTelemetryService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IDialogService, StandaloneDialogService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IEnvironmentService, StandaloneEnvironmentService, 0 /* InstantiationType.Eager */);\nregisterSingleton(INotificationService, StandaloneNotificationService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IMarkerService, MarkerService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ILanguageService, StandaloneLanguageService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IStandaloneThemeService, StandaloneThemeService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ILogService, StandaloneLogService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IModelService, ModelService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IMarkerDecorationsService, MarkerDecorationsService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IContextKeyService, ContextKeyService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IProgressService, StandaloneProgressService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IEditorProgressService, StandaloneEditorProgressService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IStorageService, InMemoryStorageService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IEditorWorkerService, EditorWorkerService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IBulkEditService, StandaloneBulkEditService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IWorkspaceTrustManagementService, StandaloneWorkspaceTrustManagementService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITextModelService, StandaloneTextModelService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IAccessibilityService, AccessibilityService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IListService, ListService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ICommandService, StandaloneCommandService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IKeybindingService, StandaloneKeybindingService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IQuickInputService, StandaloneQuickInputService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IContextViewService, StandaloneContextViewService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IOpenerService, OpenerService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IClipboardService, BrowserClipboardService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IContextMenuService, StandaloneContextMenuService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IMenuService, MenuService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IAudioCueService, StandaloneAudioService, 0 /* InstantiationType.Eager */);\n/**\n * We don't want to eagerly instantiate services because embedders get a one time chance\n * to override services when they create the first editor.\n */\nexport var StandaloneServices;\n(function (StandaloneServices) {\n  const serviceCollection = new ServiceCollection();\n  for (const [id, descriptor] of getSingletonServiceDescriptors()) {\n    serviceCollection.set(id, descriptor);\n  }\n  const instantiationService = new InstantiationService(serviceCollection, true);\n  serviceCollection.set(IInstantiationService, instantiationService);\n  function get(serviceId) {\n    if (!initialized) {\n      initialize({});\n    }\n    const r = serviceCollection.get(serviceId);\n    if (!r) {\n      throw new Error('Missing service ' + serviceId);\n    }\n    if (r instanceof SyncDescriptor) {\n      return instantiationService.invokeFunction(accessor => accessor.get(serviceId));\n    } else {\n      return r;\n    }\n  }\n  StandaloneServices.get = get;\n  let initialized = false;\n  const onDidInitialize = new Emitter();\n  function initialize(overrides) {\n    if (initialized) {\n      return instantiationService;\n    }\n    initialized = true;\n    // Add singletons that were registered after this module loaded\n    for (const [id, descriptor] of getSingletonServiceDescriptors()) {\n      if (!serviceCollection.get(id)) {\n        serviceCollection.set(id, descriptor);\n      }\n    }\n    // Initialize the service collection with the overrides, but only if the\n    // service was not instantiated in the meantime.\n    for (const serviceId in overrides) {\n      if (overrides.hasOwnProperty(serviceId)) {\n        const serviceIdentifier = createDecorator(serviceId);\n        const r = serviceCollection.get(serviceIdentifier);\n        if (r instanceof SyncDescriptor) {\n          serviceCollection.set(serviceIdentifier, overrides[serviceId]);\n        }\n      }\n    }\n    // Instantiate all editor features\n    const editorFeatures = getEditorFeatures();\n    for (const feature of editorFeatures) {\n      try {\n        instantiationService.createInstance(feature);\n      } catch (err) {\n        onUnexpectedError(err);\n      }\n    }\n    onDidInitialize.fire();\n    return instantiationService;\n  }\n  StandaloneServices.initialize = initialize;\n  /**\n   * Executes callback once services are initialized.\n   */\n  function withServices(callback) {\n    if (initialized) {\n      return callback();\n    }\n    const disposable = new DisposableStore();\n    const listener = disposable.add(onDidInitialize.event(() => {\n      listener.dispose();\n      disposable.add(callback());\n    }));\n    return disposable;\n  }\n  StandaloneServices.withServices = withServices;\n})(StandaloneServices || (StandaloneServices = {}));","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","strings","dom","StandardKeyboardEvent","Emitter","KeyCodeChord","decodeKeybinding","ImmortalReference","toDisposable","DisposableStore","Disposable","combinedDisposable","OS","isLinux","isMacintosh","Severity","URI","IBulkEditService","ResourceEdit","ResourceTextEdit","isDiffEditorConfigurationKey","isEditorConfigurationKey","EditOperation","Position","Pos","Range","IModelService","ITextModelService","ITextResourceConfigurationService","ITextResourcePropertiesService","CommandsRegistry","ICommandService","IConfigurationService","Configuration","ConfigurationModel","ConfigurationChangeEvent","IContextKeyService","IDialogService","createDecorator","IInstantiationService","AbstractKeybindingService","IKeybindingService","KeybindingResolver","KeybindingsRegistry","ResolvedKeybindingItem","USLayoutResolvedKeybinding","ILabelService","INotificationService","NoOpNotification","IEditorProgressService","IProgressService","ITelemetryService","IWorkspaceContextService","WorkspaceFolder","STANDALONE_EDITOR_WORKSPACE_ID","ILayoutService","StandaloneServicesNLS","basename","ICodeEditorService","ConsoleLogger","ILogService","IWorkspaceTrustManagementService","IContextMenuService","IContextViewService","ContextViewService","LanguageService","ContextMenuService","getSingletonServiceDescriptors","registerSingleton","OpenerService","IEditorWorkerService","EditorWorkerService","ILanguageService","MarkerDecorationsService","IMarkerDecorationsService","ModelService","StandaloneQuickInputService","StandaloneThemeService","IStandaloneThemeService","AccessibilityService","IAccessibilityService","IMenuService","MenuService","BrowserClipboardService","IClipboardService","ContextKeyService","SyncDescriptor","InstantiationService","ServiceCollection","IListService","ListService","IMarkerService","MarkerService","IOpenerService","IQuickInputService","IStorageService","InMemoryStorageService","DefaultConfiguration","IAudioCueService","LogService","getEditorFeatures","onUnexpectedError","IEnvironmentService","SimpleModel","constructor","model","disposed","_onWillDispose","textEditorModel","dispose","fire","StandaloneTextModelService","modelService","createModelReference","resource","getModel","Error","StandaloneEditorProgressService","show","NULL_PROGRESS_RUNNER","showWhile","promise","delay","total","worked","StandaloneProgressService","withProgress","_options","task","onDidCancel","report","StandaloneEnvironmentService","isExtensionDevelopment","isBuilt","StandaloneDialogService","confirm","confirmation","confirmed","doConfirm","message","detail","checkboxChecked","messageText","window","prompt","_a","_b","undefined","promptButtons","buttons","cancelButton","push","run","error","type","StandaloneNotificationService","info","notify","severity","Info","warn","Warning","notification","console","log","NO_OP","choices","options","status","None","StandaloneCommandService","instantiationService","_onWillExecuteCommand","_onDidExecuteCommand","onDidExecuteCommand","event","_instantiationService","executeCommand","id","args","command","getCommand","commandId","invokeFunction","handler","err","StandaloneKeybindingService","contextKeyService","commandService","telemetryService","notificationService","logService","codeEditorService","_cachedResolver","_dynamicKeybindings","_domNodeListeners","addContainer","domNode","disposables","add","addDisposableListener","EventType","KEY_DOWN","keyEvent","shouldPreventDefault","_dispatch","preventDefault","stopPropagation","KEY_UP","_singleModifierDispatch","DomNodeListeners","removeContainer","domNodeListeners","splice","addCodeEditor","codeEditor","getOption","getContainerDomNode","removeCodeEditor","_register","onCodeEditorAdd","onCodeEditorRemove","listCodeEditors","forEach","addDiffEditor","diffEditor","removeDiffEditor","onDiffEditorAdd","onDiffEditorRemove","listDiffEditors","addDynamicKeybinding","keybinding","when","registerCommand","addDynamicKeybindings","rules","entries","map","rule","commandArgs","weight1","weight2","extensionId","isBuiltinExtension","concat","updateResolver","_onDidUpdateKeybindings","_getResolver","defaults","_toNormalizedKeybindingItems","getDefaultKeybindings","overrides","str","_log","_documentHasFocus","document","hasFocus","items","isDefault","resultLen","item","resolvedKeybindings","resolveKeybinding","resolvedKeybinding","resolveKeyboardEvent","keyboardEvent","chord","ctrlKey","shiftKey","altKey","metaKey","keyCode","isConfigurationOverrides","thing","overrideIdentifier","StandaloneConfigurationService","_onDidChangeConfiguration","onDidChangeConfiguration","defaultConfiguration","_configuration","reload","getValue","arg1","arg2","section","updateValues","values","previous","data","toData","changedKeys","entry","updateValue","configurationChangeEvent","keys","source","sourceConfig","arg3","arg4","inspect","StandaloneResourceConfigurationService","configurationService","languageService","affectedKeys","affectsConfiguration","configuration","position","isIPosition","language","getLanguage","getLanguageIdAtPosition","lineNumber","column","getLanguageId","guessLanguageIdByFilepathOrFirstLine","StandaloneResourcePropertiesService","getEOL","eol","StandaloneTelemetryService","publicLog2","StandaloneWorkspaceContextService","from","scheme","SCHEME","authority","path","workspace","folders","uri","name","index","getWorkspace","getWorkspaceFolder","updateConfigurationService","isDiffEditor","toUpdate","StandaloneBulkEditService","_modelService","hasPreviewHandler","editsIn","edits","Array","isArray","convert","textEdits","Map","edit","versionId","getVersionId","array","get","set","replaceMove","lift","textEdit","range","text","totalEdits","totalFiles","pushStackElement","pushEditOperations","ariaSummary","format","bulkEditServiceSummary","isApplied","StandaloneUriLabelService","getUriLabel","fsPath","getUriBasenameLabel","StandaloneContextViewService","layoutService","_codeEditorService","showContextView","delegate","container","shadowRoot","getFocusedCodeEditor","getActiveCodeEditor","StandaloneWorkspaceTrustManagementService","_neverEmitter","onDidChangeTrust","isWorkspaceTrusted","StandaloneLanguageService","StandaloneLogService","StandaloneContextMenuService","contextViewService","keybindingService","menuService","configure","blockMouse","StandaloneAudioService","playAudioCue","cue","StandaloneServices","serviceCollection","descriptor","serviceId","initialized","initialize","accessor","onDidInitialize","hasOwnProperty","serviceIdentifier","editorFeatures","feature","createInstance","withServices","callback","disposable","listener"],"sources":["/home/chlohest/work/website/my_web/node_modules/monaco-editor/esm/vs/editor/standalone/browser/standaloneServices.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport '../../common/languages/languageConfigurationRegistry.js';\nimport './standaloneCodeEditorService.js';\nimport './standaloneLayoutService.js';\nimport '../../../platform/undoRedo/common/undoRedoService.js';\nimport '../../common/services/languageFeatureDebounce.js';\nimport '../../common/services/semanticTokensStylingService.js';\nimport '../../common/services/languageFeaturesService.js';\nimport * as strings from '../../../base/common/strings.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { KeyCodeChord, decodeKeybinding } from '../../../base/common/keybindings.js';\nimport { ImmortalReference, toDisposable, DisposableStore, Disposable, combinedDisposable } from '../../../base/common/lifecycle.js';\nimport { OS, isLinux, isMacintosh } from '../../../base/common/platform.js';\nimport Severity from '../../../base/common/severity.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { IBulkEditService, ResourceEdit, ResourceTextEdit } from '../../browser/services/bulkEditService.js';\nimport { isDiffEditorConfigurationKey, isEditorConfigurationKey } from '../../common/config/editorConfigurationSchema.js';\nimport { EditOperation } from '../../common/core/editOperation.js';\nimport { Position as Pos } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { ITextModelService } from '../../common/services/resolverService.js';\nimport { ITextResourceConfigurationService, ITextResourcePropertiesService } from '../../common/services/textResourceConfiguration.js';\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\nimport { Configuration, ConfigurationModel, ConfigurationChangeEvent } from '../../../platform/configuration/common/configurationModels.js';\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\nimport { IDialogService } from '../../../platform/dialogs/common/dialogs.js';\nimport { createDecorator, IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\nimport { AbstractKeybindingService } from '../../../platform/keybinding/common/abstractKeybindingService.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingResolver } from '../../../platform/keybinding/common/keybindingResolver.js';\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { ResolvedKeybindingItem } from '../../../platform/keybinding/common/resolvedKeybindingItem.js';\nimport { USLayoutResolvedKeybinding } from '../../../platform/keybinding/common/usLayoutResolvedKeybinding.js';\nimport { ILabelService } from '../../../platform/label/common/label.js';\nimport { INotificationService, NoOpNotification } from '../../../platform/notification/common/notification.js';\nimport { IEditorProgressService, IProgressService } from '../../../platform/progress/common/progress.js';\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\nimport { IWorkspaceContextService, WorkspaceFolder, STANDALONE_EDITOR_WORKSPACE_ID } from '../../../platform/workspace/common/workspace.js';\nimport { ILayoutService } from '../../../platform/layout/browser/layoutService.js';\nimport { StandaloneServicesNLS } from '../../common/standaloneStrings.js';\nimport { basename } from '../../../base/common/resources.js';\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\nimport { ConsoleLogger, ILogService } from '../../../platform/log/common/log.js';\nimport { IWorkspaceTrustManagementService } from '../../../platform/workspace/common/workspaceTrust.js';\nimport { IContextMenuService, IContextViewService } from '../../../platform/contextview/browser/contextView.js';\nimport { ContextViewService } from '../../../platform/contextview/browser/contextViewService.js';\nimport { LanguageService } from '../../common/services/languageService.js';\nimport { ContextMenuService } from '../../../platform/contextview/browser/contextMenuService.js';\nimport { getSingletonServiceDescriptors, registerSingleton } from '../../../platform/instantiation/common/extensions.js';\nimport { OpenerService } from '../../browser/services/openerService.js';\nimport { IEditorWorkerService } from '../../common/services/editorWorker.js';\nimport { EditorWorkerService } from '../../browser/services/editorWorkerService.js';\nimport { ILanguageService } from '../../common/languages/language.js';\nimport { MarkerDecorationsService } from '../../common/services/markerDecorationsService.js';\nimport { IMarkerDecorationsService } from '../../common/services/markerDecorations.js';\nimport { ModelService } from '../../common/services/modelService.js';\nimport { StandaloneQuickInputService } from './quickInput/standaloneQuickInputService.js';\nimport { StandaloneThemeService } from './standaloneThemeService.js';\nimport { IStandaloneThemeService } from '../common/standaloneTheme.js';\nimport { AccessibilityService } from '../../../platform/accessibility/browser/accessibilityService.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nimport { IMenuService } from '../../../platform/actions/common/actions.js';\nimport { MenuService } from '../../../platform/actions/common/menuService.js';\nimport { BrowserClipboardService } from '../../../platform/clipboard/browser/clipboardService.js';\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyService } from '../../../platform/contextkey/browser/contextKeyService.js';\nimport { SyncDescriptor } from '../../../platform/instantiation/common/descriptors.js';\nimport { InstantiationService } from '../../../platform/instantiation/common/instantiationService.js';\nimport { ServiceCollection } from '../../../platform/instantiation/common/serviceCollection.js';\nimport { IListService, ListService } from '../../../platform/list/browser/listService.js';\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\nimport { MarkerService } from '../../../platform/markers/common/markerService.js';\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\nimport { IQuickInputService } from '../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService, InMemoryStorageService } from '../../../platform/storage/common/storage.js';\nimport { DefaultConfiguration } from '../../../platform/configuration/common/configurations.js';\nimport { IAudioCueService } from '../../../platform/audioCues/browser/audioCueService.js';\nimport { LogService } from '../../../platform/log/common/logService.js';\nimport { getEditorFeatures } from '../../common/editorFeatures.js';\nimport { onUnexpectedError } from '../../../base/common/errors.js';\nimport { IEnvironmentService } from '../../../platform/environment/common/environment.js';\nclass SimpleModel {\n    constructor(model) {\n        this.disposed = false;\n        this.model = model;\n        this._onWillDispose = new Emitter();\n    }\n    get textEditorModel() {\n        return this.model;\n    }\n    dispose() {\n        this.disposed = true;\n        this._onWillDispose.fire();\n    }\n}\nlet StandaloneTextModelService = class StandaloneTextModelService {\n    constructor(modelService) {\n        this.modelService = modelService;\n    }\n    createModelReference(resource) {\n        const model = this.modelService.getModel(resource);\n        if (!model) {\n            return Promise.reject(new Error(`Model not found`));\n        }\n        return Promise.resolve(new ImmortalReference(new SimpleModel(model)));\n    }\n};\nStandaloneTextModelService = __decorate([\n    __param(0, IModelService)\n], StandaloneTextModelService);\nclass StandaloneEditorProgressService {\n    show() {\n        return StandaloneEditorProgressService.NULL_PROGRESS_RUNNER;\n    }\n    showWhile(promise, delay) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield promise;\n        });\n    }\n}\nStandaloneEditorProgressService.NULL_PROGRESS_RUNNER = {\n    done: () => { },\n    total: () => { },\n    worked: () => { }\n};\nclass StandaloneProgressService {\n    withProgress(_options, task, onDidCancel) {\n        return task({\n            report: () => { },\n        });\n    }\n}\nclass StandaloneEnvironmentService {\n    constructor() {\n        this.isExtensionDevelopment = false;\n        this.isBuilt = false;\n    }\n}\nclass StandaloneDialogService {\n    confirm(confirmation) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const confirmed = this.doConfirm(confirmation.message, confirmation.detail);\n            return {\n                confirmed,\n                checkboxChecked: false // unsupported\n            };\n        });\n    }\n    doConfirm(message, detail) {\n        let messageText = message;\n        if (detail) {\n            messageText = messageText + '\\n\\n' + detail;\n        }\n        return window.confirm(messageText);\n    }\n    prompt(prompt) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            let result = undefined;\n            const confirmed = this.doConfirm(prompt.message, prompt.detail);\n            if (confirmed) {\n                const promptButtons = [...((_a = prompt.buttons) !== null && _a !== void 0 ? _a : [])];\n                if (prompt.cancelButton && typeof prompt.cancelButton !== 'string' && typeof prompt.cancelButton !== 'boolean') {\n                    promptButtons.push(prompt.cancelButton);\n                }\n                result = yield ((_b = promptButtons[0]) === null || _b === void 0 ? void 0 : _b.run({ checkboxChecked: false }));\n            }\n            return { result };\n        });\n    }\n    error(message, detail) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.prompt({ type: Severity.Error, message, detail });\n        });\n    }\n}\nexport class StandaloneNotificationService {\n    info(message) {\n        return this.notify({ severity: Severity.Info, message });\n    }\n    warn(message) {\n        return this.notify({ severity: Severity.Warning, message });\n    }\n    error(error) {\n        return this.notify({ severity: Severity.Error, message: error });\n    }\n    notify(notification) {\n        switch (notification.severity) {\n            case Severity.Error:\n                console.error(notification.message);\n                break;\n            case Severity.Warning:\n                console.warn(notification.message);\n                break;\n            default:\n                console.log(notification.message);\n                break;\n        }\n        return StandaloneNotificationService.NO_OP;\n    }\n    prompt(severity, message, choices, options) {\n        return StandaloneNotificationService.NO_OP;\n    }\n    status(message, options) {\n        return Disposable.None;\n    }\n}\nStandaloneNotificationService.NO_OP = new NoOpNotification();\nlet StandaloneCommandService = class StandaloneCommandService {\n    constructor(instantiationService) {\n        this._onWillExecuteCommand = new Emitter();\n        this._onDidExecuteCommand = new Emitter();\n        this.onDidExecuteCommand = this._onDidExecuteCommand.event;\n        this._instantiationService = instantiationService;\n    }\n    executeCommand(id, ...args) {\n        const command = CommandsRegistry.getCommand(id);\n        if (!command) {\n            return Promise.reject(new Error(`command '${id}' not found`));\n        }\n        try {\n            this._onWillExecuteCommand.fire({ commandId: id, args });\n            const result = this._instantiationService.invokeFunction.apply(this._instantiationService, [command.handler, ...args]);\n            this._onDidExecuteCommand.fire({ commandId: id, args });\n            return Promise.resolve(result);\n        }\n        catch (err) {\n            return Promise.reject(err);\n        }\n    }\n};\nStandaloneCommandService = __decorate([\n    __param(0, IInstantiationService)\n], StandaloneCommandService);\nexport { StandaloneCommandService };\nlet StandaloneKeybindingService = class StandaloneKeybindingService extends AbstractKeybindingService {\n    constructor(contextKeyService, commandService, telemetryService, notificationService, logService, codeEditorService) {\n        super(contextKeyService, commandService, telemetryService, notificationService, logService);\n        this._cachedResolver = null;\n        this._dynamicKeybindings = [];\n        this._domNodeListeners = [];\n        const addContainer = (domNode) => {\n            const disposables = new DisposableStore();\n            // for standard keybindings\n            disposables.add(dom.addDisposableListener(domNode, dom.EventType.KEY_DOWN, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                const shouldPreventDefault = this._dispatch(keyEvent, keyEvent.target);\n                if (shouldPreventDefault) {\n                    keyEvent.preventDefault();\n                    keyEvent.stopPropagation();\n                }\n            }));\n            // for single modifier chord keybindings (e.g. shift shift)\n            disposables.add(dom.addDisposableListener(domNode, dom.EventType.KEY_UP, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                const shouldPreventDefault = this._singleModifierDispatch(keyEvent, keyEvent.target);\n                if (shouldPreventDefault) {\n                    keyEvent.preventDefault();\n                }\n            }));\n            this._domNodeListeners.push(new DomNodeListeners(domNode, disposables));\n        };\n        const removeContainer = (domNode) => {\n            for (let i = 0; i < this._domNodeListeners.length; i++) {\n                const domNodeListeners = this._domNodeListeners[i];\n                if (domNodeListeners.domNode === domNode) {\n                    this._domNodeListeners.splice(i, 1);\n                    domNodeListeners.dispose();\n                }\n            }\n        };\n        const addCodeEditor = (codeEditor) => {\n            if (codeEditor.getOption(61 /* EditorOption.inDiffEditor */)) {\n                return;\n            }\n            addContainer(codeEditor.getContainerDomNode());\n        };\n        const removeCodeEditor = (codeEditor) => {\n            if (codeEditor.getOption(61 /* EditorOption.inDiffEditor */)) {\n                return;\n            }\n            removeContainer(codeEditor.getContainerDomNode());\n        };\n        this._register(codeEditorService.onCodeEditorAdd(addCodeEditor));\n        this._register(codeEditorService.onCodeEditorRemove(removeCodeEditor));\n        codeEditorService.listCodeEditors().forEach(addCodeEditor);\n        const addDiffEditor = (diffEditor) => {\n            addContainer(diffEditor.getContainerDomNode());\n        };\n        const removeDiffEditor = (diffEditor) => {\n            removeContainer(diffEditor.getContainerDomNode());\n        };\n        this._register(codeEditorService.onDiffEditorAdd(addDiffEditor));\n        this._register(codeEditorService.onDiffEditorRemove(removeDiffEditor));\n        codeEditorService.listDiffEditors().forEach(addDiffEditor);\n    }\n    addDynamicKeybinding(command, keybinding, handler, when) {\n        return combinedDisposable(CommandsRegistry.registerCommand(command, handler), this.addDynamicKeybindings([{\n                keybinding,\n                command,\n                when\n            }]));\n    }\n    addDynamicKeybindings(rules) {\n        const entries = rules.map((rule) => {\n            var _a;\n            const keybinding = decodeKeybinding(rule.keybinding, OS);\n            return {\n                keybinding,\n                command: (_a = rule.command) !== null && _a !== void 0 ? _a : null,\n                commandArgs: rule.commandArgs,\n                when: rule.when,\n                weight1: 1000,\n                weight2: 0,\n                extensionId: null,\n                isBuiltinExtension: false\n            };\n        });\n        this._dynamicKeybindings = this._dynamicKeybindings.concat(entries);\n        this.updateResolver();\n        return toDisposable(() => {\n            // Search the first entry and remove them all since they will be contiguous\n            for (let i = 0; i < this._dynamicKeybindings.length; i++) {\n                if (this._dynamicKeybindings[i] === entries[0]) {\n                    this._dynamicKeybindings.splice(i, entries.length);\n                    this.updateResolver();\n                    return;\n                }\n            }\n        });\n    }\n    updateResolver() {\n        this._cachedResolver = null;\n        this._onDidUpdateKeybindings.fire();\n    }\n    _getResolver() {\n        if (!this._cachedResolver) {\n            const defaults = this._toNormalizedKeybindingItems(KeybindingsRegistry.getDefaultKeybindings(), true);\n            const overrides = this._toNormalizedKeybindingItems(this._dynamicKeybindings, false);\n            this._cachedResolver = new KeybindingResolver(defaults, overrides, (str) => this._log(str));\n        }\n        return this._cachedResolver;\n    }\n    _documentHasFocus() {\n        return document.hasFocus();\n    }\n    _toNormalizedKeybindingItems(items, isDefault) {\n        const result = [];\n        let resultLen = 0;\n        for (const item of items) {\n            const when = item.when || undefined;\n            const keybinding = item.keybinding;\n            if (!keybinding) {\n                // This might be a removal keybinding item in user settings => accept it\n                result[resultLen++] = new ResolvedKeybindingItem(undefined, item.command, item.commandArgs, when, isDefault, null, false);\n            }\n            else {\n                const resolvedKeybindings = USLayoutResolvedKeybinding.resolveKeybinding(keybinding, OS);\n                for (const resolvedKeybinding of resolvedKeybindings) {\n                    result[resultLen++] = new ResolvedKeybindingItem(resolvedKeybinding, item.command, item.commandArgs, when, isDefault, null, false);\n                }\n            }\n        }\n        return result;\n    }\n    resolveKeyboardEvent(keyboardEvent) {\n        const chord = new KeyCodeChord(keyboardEvent.ctrlKey, keyboardEvent.shiftKey, keyboardEvent.altKey, keyboardEvent.metaKey, keyboardEvent.keyCode);\n        return new USLayoutResolvedKeybinding([chord], OS);\n    }\n};\nStandaloneKeybindingService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICommandService),\n    __param(2, ITelemetryService),\n    __param(3, INotificationService),\n    __param(4, ILogService),\n    __param(5, ICodeEditorService)\n], StandaloneKeybindingService);\nexport { StandaloneKeybindingService };\nclass DomNodeListeners extends Disposable {\n    constructor(domNode, disposables) {\n        super();\n        this.domNode = domNode;\n        this._register(disposables);\n    }\n}\nfunction isConfigurationOverrides(thing) {\n    return thing\n        && typeof thing === 'object'\n        && (!thing.overrideIdentifier || typeof thing.overrideIdentifier === 'string')\n        && (!thing.resource || thing.resource instanceof URI);\n}\nexport class StandaloneConfigurationService {\n    constructor() {\n        this._onDidChangeConfiguration = new Emitter();\n        this.onDidChangeConfiguration = this._onDidChangeConfiguration.event;\n        const defaultConfiguration = new DefaultConfiguration();\n        this._configuration = new Configuration(defaultConfiguration.reload(), new ConfigurationModel(), new ConfigurationModel(), new ConfigurationModel());\n        defaultConfiguration.dispose();\n    }\n    getValue(arg1, arg2) {\n        const section = typeof arg1 === 'string' ? arg1 : undefined;\n        const overrides = isConfigurationOverrides(arg1) ? arg1 : isConfigurationOverrides(arg2) ? arg2 : {};\n        return this._configuration.getValue(section, overrides, undefined);\n    }\n    updateValues(values) {\n        const previous = { data: this._configuration.toData() };\n        const changedKeys = [];\n        for (const entry of values) {\n            const [key, value] = entry;\n            if (this.getValue(key) === value) {\n                continue;\n            }\n            this._configuration.updateValue(key, value);\n            changedKeys.push(key);\n        }\n        if (changedKeys.length > 0) {\n            const configurationChangeEvent = new ConfigurationChangeEvent({ keys: changedKeys, overrides: [] }, previous, this._configuration);\n            configurationChangeEvent.source = 8 /* ConfigurationTarget.MEMORY */;\n            configurationChangeEvent.sourceConfig = null;\n            this._onDidChangeConfiguration.fire(configurationChangeEvent);\n        }\n        return Promise.resolve();\n    }\n    updateValue(key, value, arg3, arg4) {\n        return this.updateValues([[key, value]]);\n    }\n    inspect(key, options = {}) {\n        return this._configuration.inspect(key, options, undefined);\n    }\n}\nlet StandaloneResourceConfigurationService = class StandaloneResourceConfigurationService {\n    constructor(configurationService, modelService, languageService) {\n        this.configurationService = configurationService;\n        this.modelService = modelService;\n        this.languageService = languageService;\n        this._onDidChangeConfiguration = new Emitter();\n        this.configurationService.onDidChangeConfiguration((e) => {\n            this._onDidChangeConfiguration.fire({ affectedKeys: e.affectedKeys, affectsConfiguration: (resource, configuration) => e.affectsConfiguration(configuration) });\n        });\n    }\n    getValue(resource, arg2, arg3) {\n        const position = Pos.isIPosition(arg2) ? arg2 : null;\n        const section = position ? (typeof arg3 === 'string' ? arg3 : undefined) : (typeof arg2 === 'string' ? arg2 : undefined);\n        const language = resource ? this.getLanguage(resource, position) : undefined;\n        if (typeof section === 'undefined') {\n            return this.configurationService.getValue({\n                resource,\n                overrideIdentifier: language\n            });\n        }\n        return this.configurationService.getValue(section, {\n            resource,\n            overrideIdentifier: language\n        });\n    }\n    getLanguage(resource, position) {\n        const model = this.modelService.getModel(resource);\n        if (model) {\n            return position ? model.getLanguageIdAtPosition(position.lineNumber, position.column) : model.getLanguageId();\n        }\n        return this.languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n    }\n};\nStandaloneResourceConfigurationService = __decorate([\n    __param(0, IConfigurationService),\n    __param(1, IModelService),\n    __param(2, ILanguageService)\n], StandaloneResourceConfigurationService);\nlet StandaloneResourcePropertiesService = class StandaloneResourcePropertiesService {\n    constructor(configurationService) {\n        this.configurationService = configurationService;\n    }\n    getEOL(resource, language) {\n        const eol = this.configurationService.getValue('files.eol', { overrideIdentifier: language, resource });\n        if (eol && typeof eol === 'string' && eol !== 'auto') {\n            return eol;\n        }\n        return (isLinux || isMacintosh) ? '\\n' : '\\r\\n';\n    }\n};\nStandaloneResourcePropertiesService = __decorate([\n    __param(0, IConfigurationService)\n], StandaloneResourcePropertiesService);\nclass StandaloneTelemetryService {\n    publicLog2() { }\n}\nclass StandaloneWorkspaceContextService {\n    constructor() {\n        const resource = URI.from({ scheme: StandaloneWorkspaceContextService.SCHEME, authority: 'model', path: '/' });\n        this.workspace = { id: STANDALONE_EDITOR_WORKSPACE_ID, folders: [new WorkspaceFolder({ uri: resource, name: '', index: 0 })] };\n    }\n    getWorkspace() {\n        return this.workspace;\n    }\n    getWorkspaceFolder(resource) {\n        return resource && resource.scheme === StandaloneWorkspaceContextService.SCHEME ? this.workspace.folders[0] : null;\n    }\n}\nStandaloneWorkspaceContextService.SCHEME = 'inmemory';\nexport function updateConfigurationService(configurationService, source, isDiffEditor) {\n    if (!source) {\n        return;\n    }\n    if (!(configurationService instanceof StandaloneConfigurationService)) {\n        return;\n    }\n    const toUpdate = [];\n    Object.keys(source).forEach((key) => {\n        if (isEditorConfigurationKey(key)) {\n            toUpdate.push([`editor.${key}`, source[key]]);\n        }\n        if (isDiffEditor && isDiffEditorConfigurationKey(key)) {\n            toUpdate.push([`diffEditor.${key}`, source[key]]);\n        }\n    });\n    if (toUpdate.length > 0) {\n        configurationService.updateValues(toUpdate);\n    }\n}\nlet StandaloneBulkEditService = class StandaloneBulkEditService {\n    constructor(_modelService) {\n        this._modelService = _modelService;\n        //\n    }\n    hasPreviewHandler() {\n        return false;\n    }\n    apply(editsIn, _options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const edits = Array.isArray(editsIn) ? editsIn : ResourceEdit.convert(editsIn);\n            const textEdits = new Map();\n            for (const edit of edits) {\n                if (!(edit instanceof ResourceTextEdit)) {\n                    throw new Error('bad edit - only text edits are supported');\n                }\n                const model = this._modelService.getModel(edit.resource);\n                if (!model) {\n                    throw new Error('bad edit - model not found');\n                }\n                if (typeof edit.versionId === 'number' && model.getVersionId() !== edit.versionId) {\n                    throw new Error('bad state - model changed in the meantime');\n                }\n                let array = textEdits.get(model);\n                if (!array) {\n                    array = [];\n                    textEdits.set(model, array);\n                }\n                array.push(EditOperation.replaceMove(Range.lift(edit.textEdit.range), edit.textEdit.text));\n            }\n            let totalEdits = 0;\n            let totalFiles = 0;\n            for (const [model, edits] of textEdits) {\n                model.pushStackElement();\n                model.pushEditOperations([], edits, () => []);\n                model.pushStackElement();\n                totalFiles += 1;\n                totalEdits += edits.length;\n            }\n            return {\n                ariaSummary: strings.format(StandaloneServicesNLS.bulkEditServiceSummary, totalEdits, totalFiles),\n                isApplied: totalEdits > 0\n            };\n        });\n    }\n};\nStandaloneBulkEditService = __decorate([\n    __param(0, IModelService)\n], StandaloneBulkEditService);\nclass StandaloneUriLabelService {\n    getUriLabel(resource, options) {\n        if (resource.scheme === 'file') {\n            return resource.fsPath;\n        }\n        return resource.path;\n    }\n    getUriBasenameLabel(resource) {\n        return basename(resource);\n    }\n}\nlet StandaloneContextViewService = class StandaloneContextViewService extends ContextViewService {\n    constructor(layoutService, _codeEditorService) {\n        super(layoutService);\n        this._codeEditorService = _codeEditorService;\n    }\n    showContextView(delegate, container, shadowRoot) {\n        if (!container) {\n            const codeEditor = this._codeEditorService.getFocusedCodeEditor() || this._codeEditorService.getActiveCodeEditor();\n            if (codeEditor) {\n                container = codeEditor.getContainerDomNode();\n            }\n        }\n        return super.showContextView(delegate, container, shadowRoot);\n    }\n};\nStandaloneContextViewService = __decorate([\n    __param(0, ILayoutService),\n    __param(1, ICodeEditorService)\n], StandaloneContextViewService);\nclass StandaloneWorkspaceTrustManagementService {\n    constructor() {\n        this._neverEmitter = new Emitter();\n        this.onDidChangeTrust = this._neverEmitter.event;\n    }\n    isWorkspaceTrusted() {\n        return true;\n    }\n}\nclass StandaloneLanguageService extends LanguageService {\n    constructor() {\n        super();\n    }\n}\nclass StandaloneLogService extends LogService {\n    constructor() {\n        super(new ConsoleLogger());\n    }\n}\nlet StandaloneContextMenuService = class StandaloneContextMenuService extends ContextMenuService {\n    constructor(telemetryService, notificationService, contextViewService, keybindingService, menuService, contextKeyService) {\n        super(telemetryService, notificationService, contextViewService, keybindingService, menuService, contextKeyService);\n        this.configure({ blockMouse: false }); // we do not want that in the standalone editor\n    }\n};\nStandaloneContextMenuService = __decorate([\n    __param(0, ITelemetryService),\n    __param(1, INotificationService),\n    __param(2, IContextViewService),\n    __param(3, IKeybindingService),\n    __param(4, IMenuService),\n    __param(5, IContextKeyService)\n], StandaloneContextMenuService);\nclass StandaloneAudioService {\n    playAudioCue(cue, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n        });\n    }\n}\nregisterSingleton(IConfigurationService, StandaloneConfigurationService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITextResourceConfigurationService, StandaloneResourceConfigurationService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITextResourcePropertiesService, StandaloneResourcePropertiesService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IWorkspaceContextService, StandaloneWorkspaceContextService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ILabelService, StandaloneUriLabelService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITelemetryService, StandaloneTelemetryService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IDialogService, StandaloneDialogService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IEnvironmentService, StandaloneEnvironmentService, 0 /* InstantiationType.Eager */);\nregisterSingleton(INotificationService, StandaloneNotificationService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IMarkerService, MarkerService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ILanguageService, StandaloneLanguageService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IStandaloneThemeService, StandaloneThemeService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ILogService, StandaloneLogService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IModelService, ModelService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IMarkerDecorationsService, MarkerDecorationsService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IContextKeyService, ContextKeyService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IProgressService, StandaloneProgressService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IEditorProgressService, StandaloneEditorProgressService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IStorageService, InMemoryStorageService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IEditorWorkerService, EditorWorkerService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IBulkEditService, StandaloneBulkEditService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IWorkspaceTrustManagementService, StandaloneWorkspaceTrustManagementService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ITextModelService, StandaloneTextModelService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IAccessibilityService, AccessibilityService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IListService, ListService, 0 /* InstantiationType.Eager */);\nregisterSingleton(ICommandService, StandaloneCommandService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IKeybindingService, StandaloneKeybindingService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IQuickInputService, StandaloneQuickInputService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IContextViewService, StandaloneContextViewService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IOpenerService, OpenerService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IClipboardService, BrowserClipboardService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IContextMenuService, StandaloneContextMenuService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IMenuService, MenuService, 0 /* InstantiationType.Eager */);\nregisterSingleton(IAudioCueService, StandaloneAudioService, 0 /* InstantiationType.Eager */);\n/**\n * We don't want to eagerly instantiate services because embedders get a one time chance\n * to override services when they create the first editor.\n */\nexport var StandaloneServices;\n(function (StandaloneServices) {\n    const serviceCollection = new ServiceCollection();\n    for (const [id, descriptor] of getSingletonServiceDescriptors()) {\n        serviceCollection.set(id, descriptor);\n    }\n    const instantiationService = new InstantiationService(serviceCollection, true);\n    serviceCollection.set(IInstantiationService, instantiationService);\n    function get(serviceId) {\n        if (!initialized) {\n            initialize({});\n        }\n        const r = serviceCollection.get(serviceId);\n        if (!r) {\n            throw new Error('Missing service ' + serviceId);\n        }\n        if (r instanceof SyncDescriptor) {\n            return instantiationService.invokeFunction((accessor) => accessor.get(serviceId));\n        }\n        else {\n            return r;\n        }\n    }\n    StandaloneServices.get = get;\n    let initialized = false;\n    const onDidInitialize = new Emitter();\n    function initialize(overrides) {\n        if (initialized) {\n            return instantiationService;\n        }\n        initialized = true;\n        // Add singletons that were registered after this module loaded\n        for (const [id, descriptor] of getSingletonServiceDescriptors()) {\n            if (!serviceCollection.get(id)) {\n                serviceCollection.set(id, descriptor);\n            }\n        }\n        // Initialize the service collection with the overrides, but only if the\n        // service was not instantiated in the meantime.\n        for (const serviceId in overrides) {\n            if (overrides.hasOwnProperty(serviceId)) {\n                const serviceIdentifier = createDecorator(serviceId);\n                const r = serviceCollection.get(serviceIdentifier);\n                if (r instanceof SyncDescriptor) {\n                    serviceCollection.set(serviceIdentifier, overrides[serviceId]);\n                }\n            }\n        }\n        // Instantiate all editor features\n        const editorFeatures = getEditorFeatures();\n        for (const feature of editorFeatures) {\n            try {\n                instantiationService.createInstance(feature);\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n        }\n        onDidInitialize.fire();\n        return instantiationService;\n    }\n    StandaloneServices.initialize = initialize;\n    /**\n     * Executes callback once services are initialized.\n     */\n    function withServices(callback) {\n        if (initialized) {\n            return callback();\n        }\n        const disposable = new DisposableStore();\n        const listener = disposable.add(onDidInitialize.event(() => {\n            listener.dispose();\n            disposable.add(callback());\n        }));\n        return disposable;\n    }\n    StandaloneServices.withServices = withServices;\n})(StandaloneServices || (StandaloneServices = {}));\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}