id,tree
odoo-module-open,OR($OBJECT.open(...);open(...);send_file(...);from_path(...))
odoo-markup,AND(NOT(frommarkupsafeimport$O\n...\nMarkup(...)\n...\n))
odoo-false-sanitize-attributes,AND(OR(r:\bsanitizes*=\s*False;r:\bsanitize\_attributes\s*=\s*False;r:\bsanitize\_form\s*=\s*False))
odoo-external-control-of-file-name-or-path,"AND(NOT(open(^[a-zA-Z0-9_\-\.""]+$,...));open(...,...))"
odoo-database-secret,"AND($SECRET=$SUDO.get_param(""database.secret"")\n;NOT(def$FUNCTION(...):\n...\n$SECRET.encode(...)\n)"
odoo-safe_eval,"AND(NOT($OBJECT.safe_eval(...,self._get_eval_context(),...));NOT(safe_eval(...,self._get_eval_context(),...));OR(eval(...);safe_eval(...);$OBJECT.safe_eval(...);def_get_eval_context(...):\n...\n);NOT(NOT(OR(NOT($VAL=self.env[...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...,{...,'...':$VAL,...},...\n$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n\n...)\n);NOT($VAL=self.env[...\n$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n\n...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...,{...,'...':$VAL,...},...)\n);NOT($VAL=self.env[...].$ANYTHING(...,$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n,...)\n...\n$OBJECT.safe_eval(...,{...,'...':$VAL,...},...)\n);NOT($VAL=self.env[...].$ANYTHING(...)\n...\n$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n\n...\n$OBJECT.safe_eval(...,{...,'...':$VAL,...},...)\n);NOT($VAL=self.env[...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...\n$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n\n...,{...,'...':$VAL,...},...)\n);NOT($VAL=self.env[...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...,{...\n$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n\n...,'...':$VAL,...},...)\n);NOT($VAL=self.env[...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...,{...,'...\n$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n\n...':$VAL,...},...)\n);NOT($VAL=self.env[...].$ANYTHING(...)\n...\n$OBJECT.safe_eval(...,{...,'...':$VAL,...\n$VAL=self.env[...].$ANYTHING(...)\n...\nsafe_eval(...,{...,'...':$VAL,...},...)\n\n...},...)\n)))))"
odoo-unescape,(r:unescape\b)
odoo-risky-module,"AND(OR(r:\bos\.;r:\bsys\.;r:\bzipfile\.;r:\btempfile\.;r:\btarfile\.;r:\bpathlib\.;r:\bctypes\.;r:\burllib\.);NOT(r:zipfile\.is\_zipfile);NOT(r:zipfile\.BadZipfile);NOT(r:zipfile\.ZIP\_DEFLATED);NOT(r:os\.path\.realpath\([^\)]+\));NOT(r:os\.path\.exists\([^\)]+\));NOT(r:os\.path\.isdir\([^\)]+\));NOT(r:os\.urandom);NOT(r:os\.path\.splitext);NOT(r:os\.sep);NOT(r:os\.path\.sep);NOT(r:os\.path\.altsep);NOT(r:os\.altsep);NOT(r:os\.walk);NOT(r:os\.path\.normpath);NOT(r:os\.path\.relpath);NOT(r:os\.path\.dirname);NOT(r:os\.path\.join);NOT(r:os\.path\.abspath);NOT(r:os\.access);NOT(r:os\.path\.isfile);NOT(r:os\.path\.basename);NOT(r:os\.path\.abspath);NOT(r:os\.path\.expanduser);NOT(r:os\.path\.expandvars);NOT(r:os\.close);NOT(r:from\s*os\.);NOT(r:os\.listdir);NOT(r:import\s*os\.);NOT(r:sys\.exit);NOT(r:import\s*sys\.);NOT(r:sys\.modules\['[^']+'\]);NOT(r:from\s*sys\.);NOT(r:sys\.arg\[0\]);NOT(r:sys\.stderr\();NOT(r:sys\.stderr\.write\(""[^']+""\));NOT(r:\.join\(pathlib\.Path\([^\)]+\)\.suffixes\));NOT(pathlib.$OBJECT.suffixes);NOT(r:\(?pathlib\.Path\([^\)]+\)\.suffixes\)?);NOT(r:urllib\.parse\.quote\(request\.httprequest\.full\_path\));NOT(r:import\s*urllib\.);NOT(r:tempfile\.mkstemp);NOT(r:tempfile\.NamedTemporaryFile);NOT(r:tempfile\.TemporaryFile))"
odoo-unsafe-connection,"AND(OR(http.route(...,csrf=False,...);$APP.config['WTF_CSRF_ENABLED']=False);NOT(http.route(...,csrf=False,...,auth='public';...));NOT(http.route(...,csrf=False,...,auth='none';...)))"
odoo-cr_execute,"AND(OR($CONNECTION.execute($SQL+$VAL,...)\n;$CONNECTION.execute($SQL%$VAL,...)\n;$CONNECTION.execute($SQL.format($VAL),...)\n;cr.execute($SQL.format($VAL),...)\n;AND($QUERY=$SQL+$VAL\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);AND($QUERY=$SQL%$VAL\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);AND($QUERY=$SQL.format($VAL)\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);AND(OR($QUERY=f""...{...}...""\n...\n$CONNECTION.execute($QUERY,...)\n\n...\n;$QUERY=f""...\n$CONNECTION.execute($QUERY,...)\n\n...{...}...""\n...\n;$QUERY=f""...{...\n$CONNECTION.execute($QUERY,...)\n\n...}...""\n...\n;$QUERY=f""...{...}...\n$CONNECTION.execute($QUERY,...)\n\n...""\n...\n)))"
odoo-huge_tree,(huge_tree)
odoo-avoid_hardcoded_config_DEBUG,AND($M.update(DEBUG=True);$M.update(DEBUG=False);$M.config['DEBUG']=True;$M.config['DEBUG']=False)
odoo-t-raw,"AND(r:t-raw\=?"")"
odoo-sensitive-data-in-logs,"(try:\n...\nexceptpsycopg2.$ERRORMSGas$ERROR:\n...\nprint(...,$ERROR)\n)"
odoo-disabling-sqli-linter,(r:pylint\s*:\s*disable.*=sql-injection)
odoo-detected-hardcoded-key,AND(OR(AND(-----BEGIN(?i)([dr]sa|ec|openssh|encrypted)?PRIVATEKEY-----$KEY);;AND(-----BEGINPRIVATEKEY-----\n$KEY\n)))
odoo-copy,(request.params.copy(...))
odoo-crypto,OR(md5;sha1;hmac;hashlib;cryptography;OpenSSL;des;arc4;DES;ARC4)
odoo-sqlalchemy-execute-raw-query,"AND(OR(NOT($CONNECTION.execute($SQL+self._tables,...)\n);$CONNECTION.execute($SQL+...,...)\n;NOT($CONNECTION.execute($SQL%self._tables,...)\n);$CONNECTION.execute($SQL%...,...)\n;NOT($CONNECTION.execute($SQL.format(self._tables),...)\n);$CONNECTION.execute($SQL.format(...),...)\n;AND(NOT($QUERY=$SQL+self._tables\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);$QUERY=$SQL+...\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);NOT(;AND($QUERY=$SQL%self._tables\n...\n$CONNECTION.execute($QUERY,...)\n\n...\));;AND($QUERY=$SQL%...\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);AND(NOT($QUERY=$SQL.format(self._tables)\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);$QUERY=$SQL.format(...)\n...\n$CONNECTION.execute($QUERY,...)\n\n...\);;AND(OR($QUERY=f""...{...}...""\n...\n$CONNECTION.execute($QUERY,...)\n\n...\n;$QUERY=f""...\n$CONNECTION.execute($QUERY,...)\n\n...{...}...""\n...\n;$QUERY=f""...{...\n$CONNECTION.execute($QUERY,...)\n\n...}...""\n...\n;$QUERY=f""...{...}...\n$CONNECTION.execute($QUERY,...)\n\n...""\n...\n))))"
odoo-handle-requests-separately-from-other-risky-modules,AND(r:\bfrom\s+requests\b.*\bimport\b|\brequests\.\s*[a-z]+;NOT(r:\brequests\.exceptions))
odoo-qweb-eval,AND(OR(r:_?qcontext;r:_?eval_context);NOT(r:def\s[a-zA-Z0-9\_]*_qcontext);NOT(r:def\s[a-zA-Z0-9\_]*_eval_context);NOT(r:\bminimal_qcontext);NOT(r:\bminimal_eval_context))
odoo-avoid_hardcoded_config_TESTING,"OR($M.config['TESTING']=True;$M.config['TESTING']=False;$M.update(TESTING=True,...);$M.update(TESTING=False,...))"
odoo-jwt-hardcoded,"AND(OR(importjwt;fromjwtimport$ANYTHING;def$FUNC(...,password=""..."",...):\n...\n;def$FUNC(...,pwd=""..."",...):\n...\n;def$FUNC(...,passwd=""..."",...):\n...\n;def$FUNC(...,pswd=""..."",...):\n...\n;def$FUNC(...,passwrd=""..."",...):\n...\n;def$FUNC(...,passkey=""..."",...):\n...\n;def$FUNC(...,secret=""..."",...):\n...\n;AND(jwt.encode($X,$SECRET,...)\n;""...""\n)))"
odoo-sensitive-information-post,"AND(OR($REQUEST.post(...,data=password|passwd|key|pass,...)\n))"
odoo-detected-aws-access-key-id-value,AND(r:\b(A3T[A-Z0-9]|AKIA|AGPA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}\b;NOT(r:(?i)example|sample|test|fake))
odoo-unstrusted-console-output,"AND(OR(AND(OR($CONNECTION.error|log|debug|warn|warning(""...""+$VALUE);$CONNECTION.error|log|debug|warn|warning(""...""%$VALUE)));OR(;AND(OR($CONNECTION.error(error);;AND(OR($CONNECTION.error(\blog\b);;AND(OR($CONNECTION.error(\bdebug\b);;AND(OR($CONNECTION.error(\bwarn\b);;AND(OR($CONNECTION.error(\bwarning\b);;AND(OR($CONNECTION.error(\be\b);;AND(OR($CONNECTION.error(\berr\b);;AND(OR($CONNECTION.error(\bcontent\b));OR($CONNECTION.log(error);$CONNECTION.log(\blog\b);$CONNECTION.log(\bdebug\b);$CONNECTION.log(\bwarn\b);$CONNECTION.log(\bwarning\b);$CONNECTION.log(\be\b);$CONNECTION.log(\berr\b);$CONNECTION.log(\bcontent\b));OR($CONNECTION.debug(error);$CONNECTION.debug(\blog\b);$CONNECTION.debug(\bdebug\b);$CONNECTION.debug(\bwarn\b);$CONNECTION.debug(\bwarning\b);$CONNECTION.debug(\be\b);$CONNECTION.debug(\berr\b);$CONNECTION.debug(\bcontent\b));OR($CONNECTION.warn(error);$CONNECTION.warn(\blog\b);$CONNECTION.warn(\bdebug\b);$CONNECTION.warn(\bwarn\b);$CONNECTION.warn(\bwarning\b);$CONNECTION.warn(\be\b);$CONNECTION.warn(\berr\b);$CONNECTION.warn(\bcontent\b));OR($CONNECTION.warning(error)));$CONNECTION.warning(\blog\b)));$CONNECTION.warning(\bdebug\b)));$CONNECTION.warning(\bwarn\b)));$CONNECTION.warning(\bwarning\b)));$CONNECTION.warning(\be\b)));$CONNECTION.warning(\berr\b)));$CONNECTION.warning(\bcontent\b))))))"
odoo-avoid_hardcoded_config_ENV,"OR($M.update(ENV=""=~/^development|production$/"");$M.config['ENV']=""=~/^development|production$/"";AND($M.update(ENV=""=~/^development|production$/"");$M.config['ENV']=""=~/^development|production$/""))"
odoo-avoid_hardcoded_config_SECRET_KEY,"OR($M.update(SECRET_KEY=""=~/.*/"");$M.config['SECRET_KEY']=""=~/.*/"")"
